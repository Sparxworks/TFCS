<?xml version="1.0" encoding="windows-1252"?>
<RefData version="1.0" exporter="EA.25">
	<DataSet name="Automation Scripts" table="t_script" filter="ScriptName='#ScriptName#' and ScriptCategory='#ScriptCategory#'" stoplist=";ScriptID;">
		<DataRow>
			<Column name="ScriptID" value="232"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{C1E97F55-F518-47bc-A766-6CE3EE012AC6}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_ActionCommand&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Handles doubleclicked on en element of stereotype TFCS_Script by executing the content of the notes&#xA;' field as (VB)Script&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;Function EA_OnContextItemDoubleClicked(GUID,ot)&#xA;	EA_OnContextItemDoubleClicked = false&#xA;	if ot = 4 then&#xA;		dim elt as EA.Element&#xA;		set elt = GetElementByGuid(GUID)&#xA;		if elt.Stereotype = &quot;SCRIPT&quot; then&#xA;			EAST.RunScript &quot;VBSCRIPT&quot;,GetFormatFromField(&quot;TXT&quot;,elt.Notes)&#xA;			EA_OnContextItemDoubleClicked = true&#xA;		end if&#xA;	end if&#xA;end function&#xA;&#xA;' Prevent any action elements with stereotype SCRIPT to be removed from a diagram&#xA;Function EA_OnPreDeleteDiagramObject( Info ) &#xA;	EA_OnPreDeleteDiagramObject = true&#xA;&#xA;	dim elt: set elt = GetElementByID(Info.get(&quot;ID&quot;).Value)&#xA;	if elt.Stereotype = &quot;SCRIPT&quot; and elt.Type = &quot;Action&quot; then&#xA;		EA_OnPreDeleteDiagramObject = false&#xA;	end if&#xA;end Function&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="233"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{135903A0-61E3-4b0a-B7AF-B60D41EB3C26}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_Guidance&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC TFCS_Core.TFCS_Constants&#xA;&#xA;' Open TFCS guidance video in IE, attach to running video if possible&#xA;sub ShowHelp(fileName)&#xA;	&#xA;	' Find a running instance for TFCS guidance, if not found, create one&#xA;	dim objIE:	set objIE = nothing&#xA;	dim wsh: set wsh = createObject(&quot;Shell.Application&quot;)&#xA;	Dim guidanceDir: guidanceDir = ucase(TFCSBASEDIR+&quot;/instructions/&quot; )&#xA;	dim ie&#xA;    For Each ie In wsh.Windows&#xA;		if InStr(ucase(ie.LocationURL),&quot;FILE:///&quot;+guidanceDir)&gt;0 then&#xA;			' How to make windows but the running IE instance to the foreground, on -all- platforms???&#xA;			set objIE = ie&#xA;			dim title: title = Replace(Replace(Mid(ie.LocationURL,9),&quot;/&quot;,&quot;\&quot;),&quot;%20&quot;,&quot; &quot;)&#xA;			dim ssh: set ssh = CreateObject(&quot;Wscript.Shell&quot;)&#xA;			ssh.AppActivate(title+&quot; - Windows Internet Explorer&quot;)&#xA;			ssh.AppActivate(title+&quot; - Microsoft Internet Explorer&quot;)&#xA;		end if&#xA;	next&#xA;&#xA;	if objIE is nothing then&#xA;		set objIE =CreateObject(&quot;InternetExplorer.Application&quot;)&#xA;		objIE.toolbar = 0&#xA;		objIE.StatusBar = 0&#xA;		objIE.Top = 5&#xA;		objIE.Height = 950&#xA;		objIE.Width = 1470&#xA;	end if&#xA; 	objIE.Navigate guidanceDir+fileName&#xA;	do while objIE.Busy or objIE.ReadyState &lt;&gt; 4&#xA;		EAST.sleep 100 &#xA;	loop&#xA;	objIE.Visible = 1&#xA;end sub&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="192"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{6C3FA329-356A-449b-963B-0DBD033D5230}"/>
			<Column name="ScriptAuthor" value="{95899319-791B-46bc-A6E6-A4122451DB62}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;EAST_UnitTests&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;const sql = &quot;Select * from t_diagram&quot;&#xA;const sql_args1 = &quot;Select * from t_diagram where name like '{0}'&quot;&#xA;const sql_args2 = &quot;Select * from t_diagram where name like '{0}' and author = '{1}'&quot;&#xA;&#xA;'-----------------------------------------------------------------------------------&#xA;' Generic diagram &amp; element &#xA;'-----------------------------------------------------------------------------------&#xA;&#xA;&#xA;sub EAST_RunUnitTests&#xA;	Dim objIE: set objIE =CreateObject(&quot;InternetExplorer.Application&quot;)&#xA;    objIE.Visible = 1&#xA;    objIE.Height = 1024&#xA;    objIE.Width = 1600&#xA;    objIE.Navigate &quot;file:///e:/TFCS/beheer/dialogs/TFCS - Create actor.htm&quot;&#xA;end sub&#xA;&#xA;sub AddToelichting()&#xA;&#xA;	dim SQL: SQL = &quot; select do.rectTop,do.rectleft,do.rectright,do.rectbottom,p.object_id&quot; + _&#xA;	&quot; from t_object o, t_diagramobjects do,t_diagram d, t_object p&quot; + _&#xA;	&quot; where ucase(o.note) like '*BASIC PATH*'   and o.object_id = do.object_id&quot; + _&#xA;	&quot; and do.diagram_id = d.diagram_id and d.parentid = p.object_id and p.Stereotype = 'TFCS_Workflow' and d.name like 'UCR-*'&quot; &#xA;&#xA;	dim dict: set dict = EAST.ExecuteSQL(SQL,empty)&#xA;	if not dict is nothing then&#xA;		EAST.logError(&quot;Count: &quot;&amp;dict.count)&#xA;		dim row&#xA;		dim uc as EA.Element&#xA;		for each row in dict.items&#xA;			set uc = GetElementByID(row.item(&quot;OBJECT_ID&quot;))&#xA;EAST.LogError(uc.name)&#xA;			dim ucReal as EA.Diagram&#xA;			set ucReal = uc.CompositeDiagram&#xA;			dim styleEx: styleEx = ucReal.StyleEx&#xA;			if InStr(styleEx,&quot;ShowDiagramInPages&quot;) = 0 then&#xA;				ucReal.StyleEx = styleEx + &quot;ShowDiagramInPages=1;&quot;&#xA;				ucReal.update()&#xA;			end if&#xA;			' Add toelichting boundary&#xA;			dim dgmLabel : set dgmLabel = uc.Elements.AddNew(&quot;&quot;,&quot;Boundary&quot;)&#xA;			dgmLabel.Name = &quot;Toelichting&quot;&#xA;			dgmLabel.Update()&#xA;			dim top: top = -Cint(row.item(&quot;RECTTOP&quot;))-5&#xA;			dim left: left = 1&#xA;			dim right: right = Cint(row.item(&quot;RECTRIGHT&quot;))+5&#xA;			dim bottom: bottom = -Cint(row.item(&quot;RECTBOTTOM&quot;))+5&#xA;			dim dgmObject : set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=&quot;&amp;left&amp;&quot;;t=&quot;&amp;top&amp;&quot;;r=&quot;&amp;right&amp;&quot;;b=&quot;&amp;bottom&amp;&quot;;&quot;, &quot;&quot; )&#xA;			dgmObject.ElementID( dgmLabel.ElementID )&#xA;			dgmObject.Update()&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;sub DressUpWFRs()&#xA;	dim dict: set dict = EAST.ExecuteSQL(&quot;select object_id from t_object o  where o.Stereotype = 'TFCS_Workflow' &quot;,empty)&#xA;	if not dict is nothing then&#xA;		EAST.logError(&quot;Count: &quot;&amp;dict.count)&#xA;		dim row&#xA;		dim uc as EA.Element&#xA;		for each row in dict.items&#xA;			set uc = GetElementByID(row.item(&quot;OBJECT_ID&quot;))&#xA;			if(uc.name &lt;&gt; &quot;UC-0250 - Beheren feestdagen&quot;) then&#xA;			EAST.LogError(uc.name)&#xA;				dim ucReal : set ucReal = uc.CompositeDiagram&#xA;				' Diagram notes&#xA;				dim dgmLabel : set dgmLabel = uc.Elements.AddNew(&quot;&quot;,&quot;Text&quot;)&#xA;				dgmLabel.Subtype = 18&#xA;				dgmLabel.Update()&#xA;				dim dgmObject : set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=5;t=5;r=10;b=10;&quot;, &quot;&quot; )&#xA;				dgmObject.ElementID( dgmLabel.ElementID )&#xA;				dgmObject.Style = &quot;NSL=1&quot;&#xA;				dgmObject.Update()&#xA;				&#xA;				set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=559;t=27;r=701;b=85;&quot;, &quot;&quot; )&#xA;				dgmObject.ElementID( uc.ParentID )&#xA;				dgmObject.Style = &quot;NSL=1&quot;&#xA;				dgmObject.Update()&#xA;			end if&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;sub UnitTest&#xA;	dim dlgGUID: dlgGUID = SelectDiagramFromTree(&quot;Selecteer een diagram&quot;,&quot;TFCS_FlowDiagram&quot;,&quot;Flow realisatie diagram&quot;,&quot;Onderhanden&quot;,false)&#xA;	dim dict: set dict = EAST.ExecuteSQL(RTFGEN_SQL_DGM_REMARKSFORDGM,dlgGUID)&#xA;	if not dict is nothing then&#xA;		EAST.logError(&quot;Count: &quot;&amp;dict.count)&#xA;		dim row&#xA;		for each row in dict.items&#xA;			EAST.LogError(row.item(&quot;REMARK&quot;))&#xA;		next&#xA;	end if&#xA;	&#xA;' SelectElementTagFromTree &quot;Let's try this!&quot;,&quot;TFCS_Workflow&quot;,&quot;WorkflowType&quot;,&quot;BedrijfsProces,WerkInstructie,UseCase&quot;,&quot;TFCS&quot;,&quot;UseCase&quot;,True&#xA;'	'' Run tests&#xA;'	Dim dict, res&#xA;'	EAST.LogClear()&#xA;'&#xA;'	' Run each method in sequence&#xA;'	dim now: now = timer()&#xA;'	EAST.LogInfo(&quot;Seconds passed since 12:00 AM: &quot;&amp;now)&#xA;'	EAST.sleep(3000)&#xA;'	dim andNow: andNow = timer()&#xA;'	EAST.LogInfo(&quot;This was a wait of &quot;&amp;(andNow-now)&amp;&quot; seconds&quot;)&#xA;'	EAST.Assert (Int(andnow-now) = 3),&quot;Assert.Sleep should have waited 3 seconds but instead &quot;&amp;Int(andnow-now)&#xA;'&#xA;'	' Execute query without args&#xA;'	set dict = EAST.ExecuteSQL(sql,&quot;&quot;)&#xA;'	if dict.count &lt; 5 then&#xA;'		EAST.MsgBox &quot;This test requires that at least 5 diagrams are present in your model&quot;,_&#xA;'			vbCritical,&quot;Unable to continue unittest!&quot;&#xA;'			exit sub&#xA;'	end if&#xA;'	&#xA;'	' Multiselect listbox dialog &#xA;'	' Returning several rows&#xA;'	set dict = EAST.ExecuteSQL(sql,&quot;&quot;)&#xA;'	dict.add &quot;multiselect&quot;,1&#xA;'	'dict.add &quot;preselect&quot;,&quot;2 4 5&quot;&#xA;'	'dict.add &quot;timer&quot;,1000&#xA;'	res = EAST.OpenDialog(&quot;tfcsSelectRows.html&quot;,&quot;Please select rows 2,4 and 5 and press OK&quot;,dict)&#xA;'	EAST.Assert (not dict.Exists(&quot;ERROR&quot;)),&quot;Query failed&quot;&#xA;''	session.output(dict.item(&quot;RESULT&quot;))&#xA;'	dim args: args = Split(dict.item(&quot;RESULT&quot;),&quot;|&quot;)&#xA;'	EAST.LogInfo(&quot;User selected &quot;&amp;dict.item(&quot;RESULT&quot;))&#xA;'	EAST.LogInfo(&quot;User selected &quot;&amp;UBound(args)+1&amp;&quot; rows&quot;)&#xA;'	EAST.Assert UBound(args)=2,&quot;Not 3 rows selected&quot;&#xA;'	EAST.Assert args(0)=&quot;2&quot;,&quot;First row should have been 2 and not &quot;&amp;args(0)&#xA;'	EAST.Assert args(1)=&quot;4&quot;,&quot;Second row should have been 4 and not &quot;&amp;args(1)&#xA;'	EAST.Assert args(2)=&quot;5&quot;,&quot;Third row should have been 5 and not &quot;&amp;args(2)&#xA;'	EAST.sleep(1000)&#xA;'	&#xA;'	dim dict : set dict = CreateObject(&quot;Scripting.Dictionary&quot;)			&#xA;'	dict.add 0,&quot;Use case&quot;&#xA;'	dict.add 1,&quot;Werkinstructie&quot;&#xA;'	dict.add 2,&quot;BedrijfsProces&quot;&#xA;'	selected = EAST.OpenDialog(&quot;tfcsSelectRadio.html&quot;,&quot;Selecteer het type workflow&quot;,dict)&#xA;'	selected = dict.item(&quot;RESULT&quot;)&#xA;'&#xA;'	' Uitvoeren van een query met EEN argument en enkelvoludig selectie dialoog&#xA;'	set dict = EAST.ExecuteSQL(sql_args1,&quot;UC*&quot;) ' LET OP SQL voor Oracle is de wildcard niet * maar %&#xA;'	dict.add &quot;multiselect&quot;,0&#xA;'	res = EAST.OpenDialog(&quot;e:/edda/dialogs/tfcsSelectRows.html&quot;,&quot;Selecteer een item&quot;,dict)&#xA;'	EAST.sleep(1000)&#xA;'	session.output(dict.item(&quot;RESULT&quot;))&#xA;'	&#xA;'	' Uitvoeren van een query met TWEE argumenten en enkelvoludig selectie dialoog&#xA;'	set dict = EAST.ExecuteSQL(sql_args2,&quot;UC*|maessenp&quot;) ' LET OP SQL voor Oracle is de wildcard niet * maar %&#xA;'	dict.add &quot;multiselect&quot;,0&#xA;'	res = EAST.OpenDialog(&quot;e:/edda/dialogs/tfcsSelectRows.html&quot;,&quot;Selecteer een item&quot;,dict)&#xA;'	EAST.sleep(1000)&#xA;'	session.output(dict.item(&quot;RESULT&quot;))&#xA;	&#xA;end sub&#xA;&#xA;'main"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="193"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{D32B49D7-40BF-4eb1-840E-47BA632EEB44}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_GenerateDocWFSpec&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Component for creating usecase specification documents&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;!INC TFCS_Support.TFCS_DocumentGeneration&#xA;&#xA;' Generating WF spec&#xA;const ELTX_WFSPEC_MASTER = &quot;TFCS_WFSpecMaster&quot;&#xA;const ELTX_WFSPEC_FLOWDGM = &quot;TFCS_WFSpecFlowDiagram&quot;&#xA;const ELTX_WFSPEC_FLOWREMARKS = &quot;TFCS_WFSpecFlowRemarks&quot;&#xA;const ELTX_WFSPEC_COMPDGM = &quot;TFCS_WFSpecCompFlowDiagram&quot;&#xA;&#xA;' Add a menuitem to the project browser context menu&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	if MenuLocation = &quot;TreeView&quot; and MenuName = MNU_TFCSMAIN then&#xA;		dim result(1)&#xA;		result(0) = &quot;-&quot;&#xA;		result(1) = MNU_GENERATE_WFSPEC&#xA;		dim item: set item = GetTreeSelectedObject()&#xA;		Select Case item.ObjectType&#xA;			Case 4&#xA;				if(item.Stereotype = &quot;TFCS_Activity&quot; or item.Stereotype = &quot;TFCS_Workflow&quot;) then&#xA;					EA_GetMenuItems = result&#xA;				end if&#xA;			Case 5 &#xA;				EA_GetMenuItems = result&#xA;			Case Else&#xA;				' No context-specific items&#xA;		end select&#xA;	end if&#xA;end Function&#xA;&#xA;' Handle click event&#xA;'dim oWord,oFSO&#xA;Sub EA_MenuClick( MenuName , ItemName )&#xA;	if Menuname = MNU_TFCSMAIN and itemName = MNU_GENERATE_WFSPEC then&#xA;		dim path: path = EAST.FolderBrowserDialog(DOCGEN_OUTPUT_LOCATION)&#xA;		if path &lt;&gt; &quot;&quot; then&#xA;			dim item: set item = GetTreeSelectedObject()&#xA;			if item.ObjectType = 4 then&#xA;				if item.Stereotype = &quot;TFCS_Workflow&quot; then&#xA;					' The generator expects an element of type TFCS_Activity&#xA;					item = GetElementByID(item.ParentID) &#xA;				end if&#xA;			end if&#xA;'			Set oWord = CreateObject(&quot;Word.Application&quot;)&#xA;'			Set oFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xA;'			oWord.Visible = True&#xA;			GenerateWFSpecificationRTF item,path&#xA;'			oWord.Quit&#xA;'			set oWord = nothing&#xA;'			set oFSO = nothing&#xA;			EAST.MsgBox &quot;Specificaties zijn opgenomen onder &quot;+ _&#xA;				vbCRLF+path+vbCRLF+vbCRLF+&quot;LET OP de documenten zijn in RTF formaat.&quot;+vbCRLF+ _&#xA;				&quot;Gebruik MSWord om elk document om te zetten in Word formaat.&quot;,0,&quot;Genereren documentatie&quot;&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;&#xA;' Generate a workflow specification document for the element/elements within a package&#xA;' IN: item = an EA.Element of type TFCS_Activity, or a package&#xA;'     path = location for generated files&#xA;' NOTES:&#xA;'	- Uses templates ELTX_WFSpecPreface for general document layout and ELT_WFSpecDiagram for each diagram found&#xA;'	- Pakages are searched recursively for elements of type 'TFC_Activity'&#xA;function GenerateWFSpecificationRTF(item,rootPath)&#xA;	EAST.LogStart &quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;&#xA;	GenerateWFSpecificationRTF = false&#xA;	&#xA;	dim pck&#xA;	Select Case item.ObjectType&#xA;		case 5&#xA;			' Recursively handle packages&#xA;			dim elt&#xA;			for each elt in item.Elements&#xA;				if elt.Stereotype = &quot;TFCS_Activity&quot; then&#xA;					GenerateWFSpecificationRTF elt,rootPath&#xA;				end if&#xA;			next&#xA;			for each pck in item.Packages&#xA;				GenerateWFSpecificationRTF pck,rootPath&#xA;			next&#xA;			EAST.LogEnd(&quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;)&#xA;			exit function&#xA;	end select&#xA;	&#xA;	dim ucAct as EA.Element&#xA;	set ucAct = item ' ... just so we can use inellisense support of the EA script editor (item is not typed)&#xA;&#xA;	' Handle a single element&#xA;	dim fileName: fileName = Replace(ucAct.Name,&quot;/&quot;,&quot;&amp;&quot;)&#xA;	fileName = Replace(fileName,&quot;\&quot;,&quot;_&quot;)&#xA;	dim path: path = rootPath+&quot;/Spec_&quot;+fileName&#xA;	&#xA;	' Prepare: get all involved model elements&#xA;	dim dgmSpec as EA.Diagram&#xA;	set dgmSpec = ucAct.CompositeDiagram&#xA;&#xA;	dim uc as EA.Element&#xA;	dim dgmFlow as EA.Diagram&#xA;	set uc = ucAct.Elements.GetByName(ucAct.Name)&#xA;	set dgmFlow = uc.CompositeDiagram&#xA;&#xA;	dim gen as EA.DocumentGenerator&#xA;	set gen = Repository.CreateDocumentGenerator()&#xA; &#xA;	if not gen.NewDocument(&quot;&quot;) then&#xA;		EAST.LogError &quot;Unable to create a new document: &quot; + gen.GetLastError()&#xA;		EAST.LogEnd &quot;GenerateWFSpecificationRTF&quot;&#xA;		exit function&#xA;	end if&#xA;&#xA;	if not gen.DocumentElement(ucAct.ElementID,0,ELTX_WFSPEC_MASTER) then&#xA;		EAST.LogError &quot;Unable to generate document from template '&quot;+ELTX_WFSPEC_MASTER+&quot;': &quot; + gen.GetLastError()&#xA;	end if&#xA;&#xA;	EAST.LogInfo(&quot;Adding UC flow diagram: &quot;&amp;dgmFlow.DiagramGUID)&#xA;	DocumentFlowDetails gen, dgmFlow&#xA;&#xA;	if not gen.ReplaceField(SYSTEM,EAST.GetModelForPackage(uc.packageID).name) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+SYSTEM+&quot;' with value '&quot;+EAST.GetModelForPackage(uc.packageID).name+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	if not gen.ReplaceField(AUTEUR,EAST.UserName()) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+AUTEUR+&quot;' with value '&quot;+EAST.UserName()+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	if not gen.SaveDocument(path+&quot;.rtf&quot;,0) then&#xA;		EAST.LogError &quot;Unable to save document to '&quot;+path+&quot;.rtf': &quot; + gen.GetLastError()&#xA;	else&#xA;		EAST.LogInfo &quot;Generated '&quot;+path+&quot;.rtf' for element '&quot; + item.Name+&quot;'&quot;&#xA;	end if&#xA;&#xA;'	dim oDoc : set oDoc = oWord.Documents.Open(path+&quot;.rtf&quot;)&#xA;'	oDoc.SaveAs(path+&quot;.doc&quot;)&#xA;'	oFSO.DeleteFile(path+&quot;.rtf&quot;)&#xA;	&#xA;	EAST.LogEnd &quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;&#xA;end function&#xA;&#xA;sub DocumentFlowDetails(gen,dgm)&#xA;	If not gen.DocumentDiagram(dgm.DiagramID,0,ELTX_WFSPEC_FLOWDGM) then&#xA;		gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_FLOWDGM+&quot;' for diagram GUID='&quot;+dgm.DiagramGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_FLOWDGM+&quot;' for diagram GUID='&quot;+dgm.DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;	end if&#xA;	&#xA;	DocumentRemarks gen,dgm.DiagramGUID,ELTX_WFSPEC_FLOWREMARKS&#xA;	&#xA;	EAST.LogInfo(&quot;Recursively adding component &amp; screen diagrams... &quot;)&#xA;	dim comps: Set comps =  EAST.ExecuteSQL(DOCGEN_SQL_DGM_COMPLEXSTEPS,dgm.DiagramGUID)&#xA;	if not comps is nothing then&#xA;		if comps.count &gt; 0 then&#xA;			gen.InsertText &quot;Componenten en schermen&quot;+vbCRLF,&quot;Heading 2&quot;&#xA;		end if&#xA;		dim comp&#xA;		for each comp in comps.Items&#xA;			DocumentComponent gen,comp,3&#xA;		next&#xA;	end if&#xA;&#xA;end sub&#xA;&#xA;sub DocumentComponent(gen,comp,level)&#xA;	dim compDgmGUID: compDgmGUID = comp.item(&quot;EA_GUID&quot;)&#xA;	dim compDgmID: compDgmID = comp.item(&quot;DIAGRAM_ID&quot;)&#xA;	dim name: name = comp.item(&quot;NAME&quot;)&#xA;	if name = &quot;&quot; then name = &quot;&lt;omschrijving ontbreekt&gt;&quot; end if&#xA;	&#xA;	gen.InsertText name&amp;vbCRLF,&quot;Heading &quot;&amp;level&#xA;	&#xA;	If not gen.DocumentDiagram(compDgmID,0,ELTX_WFSPEC_COMPDGM) then&#xA;		gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_COMPDGM+&quot;' for diagram GUID='&quot;+compDgmGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_COMPDGM+&quot;' for diagram GUID='&quot;+compDgmGUID+&quot;': &quot; + gen.GetLastError()&#xA;	end if&#xA;	DocumentRemarks gen,compDgmGUID,ELTX_WFSPEC_FLOWREMARKS&#xA;&#xA;	EAST.LogInfo(&quot;Recursively adding component &amp; screen diagrams... &quot;)&#xA;	dim subComps: Set subComps =  EAST.ExecuteSQL(DOCGEN_SQL_DGM_COMPLEXSTEPS,compDgmGUID)&#xA;	if not subComps is nothing then&#xA;		if subComps.count&gt;0 then&#xA;			gen.InsertText &quot;Subcomponenten&quot;&amp;vbCRLF,&quot;Heading &quot;&amp;level+1&#xA;		end if&#xA;		dim subComp&#xA;		for each subComp in subComps.Items&#xA;			DocumentComponent gen,subComp,level+2&#xA;		next&#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="194"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{95899319-791B-46bc-A6E6-A4122451DB62}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="EAST"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="195"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="TFCS_Components"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="196"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{0B185963-B80B-43f2-B74D-2D02E36112AB}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_RulesForAOB&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' This component contains additional rules that allow/disallow certain user actions&#xA;'&#xA;' TODO:&#xA;' - it should not be possible to create a WF definition or -realisation diagram using &#xA;'   add diagram options&#xA;' - Tag WorkflowType must never be removed&#xA;' - Prevent creation of non-TFCS elements in TFCS packages&#xA;' - Prevent creation of TFCS elements on non-TFCS diagrams&#xA;' - naming convention UCactivity - UC - &amp; diagrams&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' - when double-clicking on a workflow 'Usecase' element on a WF overview dialog,&#xA;'   open WF definition dgm iso realisation dgm&#xA;' - when double-clicking on a workflow 'Action' element on a WF realisation dialog,&#xA;'   open WF realisation dgm iso definition dgm&#xA;Function EA_OnContextItemDoubleClicked(GUID, ot)&#xA;	EA_OnContextItemDoubleClicked = false ' continue processing unless...&#xA;	&#xA;	dim dgmStereo&#xA;	dim dgm as EA.Diagram&#xA;	dim elt as EA.Element&#xA;	set elt = GetElementByGuid(GUID)&#xA;	if not elt is Nothing then  ' eg doubleclicked on diagram...&#xA;		if elt.Stereotype = &quot;TFCS_Workflow&quot; then&#xA;			set dgm = GetCurrentDiagram()&#xA;			if not dgm is Nothing then&#xA;				dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;				if dgmStereo = &quot;TFCS::TFCS_FlowsDiagram&quot; then&#xA;					' Redirect to WF - definition diagram- iso realisation diagram &#xA;					' (this makes more sense in workflow overview dgms)&#xA;					dim ucActivity as EA.Element&#xA;					set ucActivity = GetElementByID(elt.ParentID)&#xA;					OpenDiagram(ucActivity.Diagrams.GetAt(0).diagramid)&#xA;					EA_OnContextItemDoubleClicked = True ' stop processing&#xA;				end if&#xA;			end if&#xA;		elseif elt.Stereotype = &quot;TFCS_Action&quot; and elt.ClassfierID &lt;&gt; 0 then&#xA;			dim classifier as EA.Element&#xA;			set classifier = GetElementByID(elt.ClassfierID)&#xA;			if not classifier is nothing  then&#xA;				set dgm = GetCurrentDiagram()&#xA;				if not dgm is Nothing then&#xA;					dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;					if dgmStereo = &quot;TFCS::TFCS_FlowDiagram&quot; then&#xA;						' Redirect to WF - realisation diagram- iso definition diagram &#xA;						' (this makes more sense in workflow realisation dgms)&#xA;						dim uc : set uc = classifier.Elements.GetByName(classifier.name)&#xA;						OpenDiagram(uc.Diagrams.GetAt(0).diagramid)&#xA;						EA_OnContextItemDoubleClicked = True ' stop processing&#xA;					end if&#xA;				end if&#xA;			end if&#xA;		end if&#xA;	end if&#xA;end Function&#xA;&#xA;' - disallow modification of type of workflow: currently type conversion not implemented&#xA;Sub EA_OnElementTagEdit(ObjectID , TagName, TagValue, TagNotes)&#xA;	if TagName = &quot;WorkflowType&quot; then&#xA;		' Prevent changes to this tag&#xA;		EAST.MsgBox &quot;Dit is niet toegestaan.&quot;+vbCrlf+ _&#xA;			&quot;Maak een nieuwe workflow aan van het juiste type &quot;+vbCRLF+ _&#xA;			&quot;en verplaats de informatie daarheen.&quot;,64,&quot;Wijzigen type workflow&quot;&#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="197"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{E1DD7473-7EF0-4099-89A2-9356550BC17C}"/>
			<Column name="ScriptAuthor" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;CustomDialogs&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC Local Scripts.EAConstants-VBScript&#xA;!INC TFCS.TFCS Commons&#xA;!INC TFCS.TFCS Dialogs&#xA;&#xA;sub main&#xA;	dim ids, id&#xA;	id = selectFromList(&quot;select diagram_ID as ID, t_diagram.Name as Name FROM  t_diagram order by Name asc&quot;,&quot;Selecteer een diagram&quot;,0)&#xA;	if isEmpty(id) then&#xA;		Session.output(&quot;Nothing selected!&quot;)&#xA;	else&#xA;		Session.output(&quot;You selected diagram &quot;&amp;id&amp;_&#xA;			&quot;: &quot;&amp;ExecuteSQL(&quot;select Name FROM  t_diagram where diagram_id=&quot;&amp;id).item(0).item(&quot;NAME&quot;))&#xA;'		Repository.OpenDiagram(id)&#xA;	end if&#xA;&#xA;	' Same query, now using multiselect&#xA;	ids = selectFromList(&quot;select diagram_ID as ID, t_diagram.Name as Name FROM  t_diagram order by Name asc&quot;,&quot;Selecteer een diagram&quot;,1)&#xA;	if isEmpty(ids(0)) then&#xA;		Session.output(&quot;Nothing selected!&quot;)&#xA;	else&#xA;		for each id in ids&#xA;			Session.output(&quot;You selected diagram &quot;&amp;id&amp;_&#xA;				&quot;: &quot;&amp;ExecuteSQL(&quot;select Name FROM  t_diagram where diagram_id=&quot;&amp;id).item(0).item(&quot;NAME&quot;))&#xA;		next&#xA;'		Repository.OpenDiagram(id)&#xA;	end if&#xA;end sub&#xA;&#xA;main"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="198"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{812694AC-09E6-4c8a-BE09-EB1E54E19654}"/>
			<Column name="ScriptAuthor" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS Dialogs&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC Local Scripts.EAConstants-VBScript&#xA;&#xA;' location of dialog HTML files&#xA;dim DIALOG_LOCATION: DIALOG_LOCATION = &quot;e:/EDDA/dialogs/&quot; &#xA;dim DIALOG_OPENER: DIALOG_OPENER = &quot;file:///&quot;&amp;DIALOG_LOCATION&amp;&quot;openDialog.html&quot;	&#xA;&#xA;' ================================================================================================&#xA;' Displays the result of a query in a selection list and returns the user selection. T&#xA;' &#xA;' SQL 			- valid SQL returning two columns: ID and NAME (both as string values, furthermore&#xA;'				  NAME value may not include '|' characters)&#xA;' title			- title of the dialog&#xA;' multiSelect	- if 1 the user can select multiple rows &#xA;'				  if 0 the user can select only one row&#xA;' returns		- (multiSelect = 1) an array of selected ID's or an emtpy array if none selected/cancelled/error&#xA;' 				- (multiSelect = 0) the ID of the selected row, or empty if none selected/cancelled/error&#xA;' ================================================================================================&#xA;Function selectFromList(SQL,title,multiSelect)&#xA;	Dim dict, rowDict, args(2), i, index,  selected()&#xA;	&#xA;    Set dict = ExecuteSQL(SQL)&#xA;    &#xA;	' Create list of display items&#xA;	args(0) = dict.item(0).item(&quot;NAME&quot;)&#xA;	for i = 1 to dict.count-1&#xA;		args(0) = args(0)&amp;&quot;|&quot;&amp;dict.item(i).item(&quot;NAME&quot;)&#xA;	next&#xA;    args(1) = multiSelect&#xA;	&#xA;	' Show dialog&#xA;	index = openDialog(&quot;tfcsSelectItems.html&quot;,title,args)&#xA;	if(index = &quot;&quot; or index = &quot;Error&quot;)then&#xA;		' Cancel, error or nothing selected&#xA;		Redim preserve selected(1)&#xA;		selected(0) = empty&#xA;	else&#xA;		dim selIDs, selID&#xA;		selIDs = Split(index,&quot;|&quot;)&#xA;		Redim preserve selected(UBound(selIDs))&#xA;		i=0&#xA;		for each selID in selIDs&#xA;			selected(i) = dict.item(CInt(selID)).item(&quot;ID&quot;)&#xA;			i=i+1&#xA;		next&#xA;	end if&#xA;	&#xA;	if multiSelect = 1 then&#xA;		selectFromList = selected&#xA;	else&#xA;		selectFromList = selected(0)&#xA;	end if&#xA;End Function&#xA;&#xA;' ================================================================================================&#xA;' Generic method to open a dialog and return user input&#xA;'&#xA;' dlgName 		- name of the HTML file to use as dialog, must be located in DIALOG_LOCATION&#xA;' dlgTitle		- tekst to display in the title bar&#xA;' args			- string array of arguments, maximum size is 5 elements&#xA;' returns		- string with user input (format depends on the specific dialog)&#xA;'				  'Error' if a dialog was already in progress (EA will already have killed the script &#xA;'				  behind that dialog but not the dialog itself.&#xA;' ================================================================================================&#xA;Function openDialog(dlgName,dlgTitle,args)&#xA;	dim objIE,nArgs&#xA;&#xA;	' Prevent running  &#xA;	if dialogInProgress(DIALOG_OPENER) then&#xA;		' A (possibly different) dialog is already open&#xA;		openDialog = &quot;Error&quot;&#xA;		exit function&#xA;	end if&#xA;		&#xA;	Set objIE = CreateObject(&quot;InternetExplorer.Application&quot;)&#xA;	objIE.TheaterMode = False&#xA;	objIE.Visible = 1&#xA;	objIE.Left = 0&#xA;	objIE.Top = 0&#xA;	objIE.Navigate DIALOG_OPENER&#xA;&#xA;	' Pass arguments&#xA;	nArgs = UBound(args)+1&#xA;	objIE.Document.All.arg1.value = args(0)&#xA;	if nArgs&gt;1 then objIE.Document.All.arg2.value = args(1)&#xA;	if nArgs&gt;2 then objIE.Document.All.arg3.value = args(2)&#xA;	if nArgs&gt;3 then objIE.Document.All.arg4.value = args(3)&#xA;	if nArgs&gt;4 then objIE.Document.All.arg5.value = args(4)&#xA;	objIE.Document.All.dlgName.value = &quot;file:///&quot;&amp;DIALOG_LOCATION&amp;dlgName &#xA;	objIE.Document.All.dlgTitle.value = dlgTitle &#xA;&#xA;	' Open modal dialog and wait for it to close&#xA;	objIE.Document.All.ShowModal.click&#xA;	Do While (objIE.Document.All.ReturnValue.Value = &quot;...&quot;)&#xA;		sleep(1)&#xA;	Loop&#xA;&#xA;	openDialog = objIE.Document.All.ReturnValue.Value&#xA;	objIE.Quit&#xA;	set objIE = nothing&#xA;&#xA;End Function&#xA;'&#xA;' Can't prevent user from starting the same script a second time, causing the previous one to halt&#xA;' Can't determine if a specific dialog is open or which script opened it either&#xA;' So just close an OPEN_DIALOG html window and if unable we know a dialog was in progress =&gt; inform the user&#xA;' it must be closed by hand.&#xA;'&#xA;' Note that if the same script was run a 2nd time it can now no longer be continued.&#xA;'&#xA;Function dialogInProgress(dlgURL)&#xA;	dim objShell, objShellWindows, i&#xA;	set objShell = createObject(&quot;Shell.Application&quot;)&#xA;	set objShellWindows = objShell.Windows&#xA;&#xA;	dialogInProgress = false&#xA;	if (not objShellWindows is nothing) then&#xA;	  for i = 0 to objShellWindows.count - 1&#xA;		if (not objShellWindows.Item(i) is nothing) then&#xA;			if strcomp(UCase(objShellWindows.Item(i).locationurl),UCase(dlgURL)) = 0 then&#xA;				if strcomp(dlgURL,DIALOG_OPENER) = 0 then&#xA;					objShellWindows.Item(i).Quit&#xA;				end if&#xA;				if not (objShellWindows.Item(i) is nothing) then&#xA;					' Couldn't force-close open_dialog so modal dialog still open!&#xA;					MsgBox &quot;A previous script was already running a dialog.&quot;&amp;_&#xA;						vbCRLF&amp;vbCRLF&amp;&quot;Please close this dialog and try again&quot;,0,&quot;Error opening dialog&quot;&#xA;					dialogInProgress = true&#xA;				end if&#xA;			end if&#xA;		end if&#xA;	  next&#xA;	end if&#xA;&#xA;	set objShellWindows = nothing&#xA;	set objShell = nothing&#xA;End Function&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="199"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{E9D17F94-56A7-4718-B23F-2DD31EB48221}"/>
			<Column name="ScriptAuthor" value="{8AEAB418-600A-48bb-9A45-15C360C4006E}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;Remove colorisation&quot; Type=&quot;Internal&quot; Language=&quot;JScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC Local Scripts.EAConstants-JScript&#xA;&#xA;//&#xA;// Strip blue highlight from text, remove red strikeout text and set diagram elements&#xA;// to default background color.&#xA;// &#xA;// NOTE: Requires a package or element to be selected in the Project Browser&#xA;//&#xA;&#xA;// Location of html files&#xA;var DIALOGS = &quot;T:/Projecten/Project CDD/Beheer werkdocumenten/Systeemdocumentatie/100 EA Repository/Beheer/Configuratie/&quot;;&#xA;// EA Constants&#xA;var ELEMENT_OBJECT_TYPE = 4;&#xA;var PACKAGE_OBJECT_TYPE = 5;&#xA;var DIAGRAM_OBJECT_TYPE = 8;&#xA;&#xA;var otDiagramObject = 19;&#xA;&#xA;// Microsoft Word Constants&#xA;var wdFindContinue = 1;&#xA;var wdFindStop = 0;&#xA;var wdReplaceAll = 2;&#xA;var wdOriginalDocumentFormat = 1;&#xA;var wdColorBlack = 0;&#xA;var wdColorRed = 255;&#xA;var wdColorBlue = 16711680;&#xA;var wdUnderlineNone = 0;&#xA;&#xA;// BitWise variables for user selections&#xA;var ACTION_BLUE = 1;&#xA;var ACTION_RED = 2;&#xA;var ACTION_DIAGRAM = 4;&#xA;&#xA;var APPLY_NOTES = 1;&#xA;var APPLY_SCENARIOS = 2;&#xA;var APPLY_DOCUMENTS = 4;&#xA;var APPLY_CONSTRAINTS = 8;&#xA;var APPLY_DIAGRAMNOTES = 16;&#xA;&#xA;// Word application object&#xA;var objWord = null;&#xA;		&#xA;// Session.Output(Repository.Datatypes.GetByName(&quot;ObjectType&quot;).GetByName(&quot;otElement&quot;));&#xA;// var ELEMENT_OBJECT_TYPE = otElement;&#xA;var blueRE = /&lt;font color=\&quot;#0000ff\&quot;&gt;/ig;&#xA;var blueREComplete = /&lt;font color=\&quot;\#0000ff\&quot;&gt;([\s\S]*?)&lt;\/font&gt;/ig;&#xA;var redRE = /&lt;font color=\&quot;#ff0000\&quot;&gt;&amp;lt;strike&amp;gt;/ig;&#xA;var packagesCount = 0;&#xA;var elementsCount = 0;&#xA;var notesCount = 0;&#xA;var scenarioCount = 0;&#xA;var constraintCount = 0;&#xA;var docsCount = 0;&#xA;var backgroundCount = 0;&#xA;var diagramCount = 0;&#xA;var diagramObjectCount = 0;&#xA;var diagramNotesCount = 0;&#xA;&#xA;// --------------------------------------- Internet Explorer ------------------------------------- //&#xA;&#xA;// IE Application Object&#xA;var objIE = null;&#xA;&#xA;// Super kludgey sleep routine&#xA;function Sleep(seconds) {&#xA;	var WshShell = new ActiveXObject(&quot;WScript.Shell&quot;);&#xA;	var cmd = &quot;%COMSPEC% /c ping -n &quot; + (1 + seconds) + &quot; 127.0.0.1&gt;nul&quot;;&#xA;	WshShell.Run(cmd, 0, 1);&#xA;}&#xA;&#xA;function InitIE() {&#xA;    // Create an IE object&#xA;    objIE = new ActiveXObject(&quot;InternetExplorer.Application&quot;);&#xA;	&#xA;    // Specify some of the IE window's settings&#xA;    objIE.navigate(DIALOGS+&quot;EA Template.html&quot;);&#xA;    objIE.Document.Title = &quot;MMS - Remove Change Highlighting&quot;;&#xA;    objIE.ToolBar        = false;&#xA;    objIE.Resizable      = true;&#xA;    objIE.StatusBar      = false;&#xA;    objIE.Width          = 540;&#xA;    objIE.Height         = 540;&#xA;&#xA;    // Center the dialog window on the screen&#xA;    objIE.Left = (objIE.document.parentWindow.screen.availWidth  - objIE.Width ) / 2;&#xA;    objIE.Top  = (objIE.document.parentWindow.screen.availHeight - objIE.Height) / 2;&#xA;&#xA;    // Wait till IE is ready&#xA;    while (objIE.Busy) {&#xA;        Sleep(1);&#xA;    }&#xA;	&#xA;	// Make the window visible&#xA;	objIE.Visible = true;&#xA;}&#xA;&#xA;// --------------------------------------- Text Color Match/Replace ------------------------------------- //&#xA;&#xA;// Remove blue font highlighting from text, while maintaining text and other formatting&#xA;// This leaves any underlined blue text as these may be links.&#xA;// --- The color used to highlight changes should NOT be the same as the link color!!!! ---&#xA;function stripBlueFont(blueText) {&#xA;	// Sample: &lt;font color=&quot;#0000ff&quot;&gt;The date you entered is after the recurring transfer's ending date.&lt;/font&gt;&#xA;	// Another: &lt;/b&gt;&lt;/font&gt;&lt;font color=&quot;#0000ff&quot;&gt;&lt;b&gt;&lt;u&gt;Please enter an earlier date.&lt;/u&gt;&lt;/b&gt;&lt;b&gt; Non-underline Text&lt;/b&gt;&lt;/font&gt;&#xA;	if (blueRE.test(blueText)) {&#xA;		// Original, basic replacement. Removed blue color of links.&#xA;		// blueText = blueText.replace(/&lt;font color=\&quot;\#0000ff\&quot;&gt;([\s\S]*?)&lt;\/font&gt;/ig, &quot;$1&quot;);&#xA;&#xA;		// This complex type of replace doesn't work. Limitation of JScript.&#xA;		// blueText = blueText.replace(/&lt;font color=\&quot;\#0000ff\&quot;&gt;([\s\S]*?)&lt;\/font&gt;/ig, &quot;$1&quot;.replace(/&lt;u&gt;([\s\S]*?)&lt;\/u&gt;/ig, &quot;&lt;font color=\&quot;#0000ff\&quot;&gt;&lt;u&gt;$1&lt;/u&gt;&lt;/font&gt;&quot;));&#xA;&#xA;		// This replacement method keeps blue color of underlined text, assumed to be links.&#xA;		var resultArray;&#xA;		var match;&#xA;		var lastIndex = 0;&#xA;		var resultString = &quot;&quot;;&#xA;		while ((resultArray = blueREComplete.exec(blueText)) != null) {&#xA;			match = resultArray[1];&#xA;			match = match.replace(/&lt;u&gt;([\s\S]*?)&lt;\/u&gt;/ig, &quot;&lt;font color=\&quot;#0000ff\&quot;&gt;&lt;u&gt;$1&lt;/u&gt;&lt;/font&gt;&quot;);&#xA;			&#xA;			resultString += blueText.substring(lastIndex, resultArray.index) + match;&#xA;			&#xA;			lastIndex = resultArray.lastIndex;&#xA;		}&#xA;		resultString += blueText.substr(lastIndex);&#xA;		&#xA;		blueText = resultString;&#xA;	}&#xA;	return(blueText);&#xA;}&#xA;&#xA;// Remove text in red and surrounded by &lt;strike&gt;&lt;/strike&gt; tags&#xA;function stripRedStrikeText(redText) {&#xA;	// Sample: &lt;font color=&quot;#ff0000&quot;&gt;&amp;lt;strike&amp;gt;The transfer date you choose must be before the end date.&amp;lt;/strike&amp;gt;&lt;/font&gt;&#xA;	if (redRE.test(redText)) {&#xA;		// Strip out red strikethrough text. Also remove any trailing spaces at the end to eliminate extra whitespace&#xA;		redText = redText.replace(/&lt;font color=\&quot;#ff0000\&quot;&gt;&amp;lt;strike&amp;gt;([\s\S]*?)&amp;lt;\/*strike&amp;gt;&lt;\/font&gt;\s*/ig, &quot;&quot;);&#xA;	}&#xA;	return(redText);&#xA;}&#xA;&#xA;// -------------------------------------- Notes and Scenarios ----------------------------------------- //&#xA;&#xA;// Update &quot;Notes&quot; for an element&#xA;function ElementNotes(theElement, actions) {&#xA;	if ( theElement != null &amp;&amp; theElement.ObjectType == ELEMENT_OBJECT_TYPE ) {&#xA;		var notesOrig = theElement.Notes;&#xA;		var notesNew = notesOrig;&#xA;&#xA;		// Strip Blue Font&#xA;		if (actions &amp; ACTION_BLUE) {&#xA;			notesNew = stripBlueFont(notesNew);&#xA;		}&#xA;		&#xA;		// Strip Red Text&#xA;		if (actions &amp; ACTION_RED) {&#xA;			notesNew = stripRedStrikeText(notesNew);&#xA;		}&#xA;		&#xA;		// Update the value only if something has actually changed&#xA;		if (notesNew != notesOrig) {&#xA;			theElement.Notes = notesNew;&#xA;			notesCount++;&#xA;		}&#xA;	}&#xA;}&#xA;&#xA;// Update &quot;Scenarios&quot; for an element&#xA;function ElementScenarios(theElement, actions) {&#xA;	var scenarios as EA.Collection;&#xA;	var scenario as EA.Scenario;&#xA;	&#xA;	scenarios = theElement.Scenarios;&#xA;&#xA;	var count = scenarios.Count;&#xA;	&#xA;	for (var i=0; i &lt; count; i++) {&#xA;		scenario = scenarios.GetAt(i);&#xA;		&#xA;		var notesOrig = scenario.Notes;&#xA;		var notesNew = notesOrig;&#xA;		&#xA;		// Strip Blue Font&#xA;		if (actions &amp; ACTION_BLUE) {&#xA;			notesNew = stripBlueFont(notesNew);&#xA;		}&#xA;		&#xA;		// Strip Red Text&#xA;		if (actions &amp; ACTION_BLUE) {&#xA;			notesNew = stripRedStrikeText(notesNew);&#xA;		}&#xA;		&#xA;		// Update the value only if something has actually changed&#xA;		if (notesNew != notesOrig) {&#xA;			scenario.Notes = notesNew;&#xA;			scenario.Update();&#xA;			scenarioCount++;&#xA;		}&#xA;	}&#xA;}&#xA;&#xA;// Update &quot;Constraints&quot; for an element&#xA;function ElementConstraints(theElement, actions) {&#xA;	var constraints as EA.Collection;&#xA;	var constraint as EA.Constraint;&#xA;	&#xA;	constraints = theElement.Constraints;&#xA;&#xA;	var count = constraints.Count;&#xA;	&#xA;	for (var i=0; i &lt; count; i++) {&#xA;		constraint = constraints.GetAt(i);&#xA;		&#xA;		var notesOrig = constraint.Notes;&#xA;		var notesNew = notesOrig;&#xA;		&#xA;		// Strip Blue Font&#xA;		if (actions &amp; ACTION_BLUE) {&#xA;			notesNew = stripBlueFont(notesNew);&#xA;		}&#xA;		&#xA;		// Strip Red Text&#xA;		if (actions &amp; ACTION_BLUE) {&#xA;			notesNew = stripRedStrikeText(notesNew);&#xA;		}&#xA;		&#xA;		// Update the value only if something has actually changed&#xA;		if (notesNew != notesOrig) {&#xA;			constraint.Notes = notesNew;&#xA;			constraint.Update();&#xA;			constraintCount++;&#xA;		}&#xA;	}&#xA;}&#xA;&#xA;// ------------------------------------- Linked Documents ---------------------------------------- //&#xA;&#xA;// http://word.mvps.org/FAQs/MacrosVBA/FlushFR.htm&#xA;function clearWordSearchBug(objWord) {&#xA;	objWord.Selection.Find.ClearFormatting();&#xA;	objWord.Selection.Find.Replacement.ClearFormatting();&#xA;	objWord.Selection.Find.Text = &quot;&quot;;&#xA;    objWord.Selection.Find.Replacement.Text = &quot;&quot;;&#xA;	objWord.Selection.Find.Forward = true;&#xA;	objWord.Selection.Find.Wrap = wdFindStop;&#xA;	objWord.Selection.Find.Format = false;&#xA;	objWord.Selection.Find.MatchCase = false;&#xA;	objWord.Selection.Find.MatchWholeWord = false;&#xA;	objWord.Selection.Find.MatchAllWordForms = false;&#xA;	objWord.Selection.Find.MatchSoundsLike = false;&#xA;	objWord.Selection.Find.MatchWildcards = false;&#xA;	&#xA;	// execute a dummy search&#xA;	objWord.Selection.Find.Execute(&quot;^p&quot;);&#xA;}&#xA;&#xA;// Update &quot;Linked Documents&quot; for an element&#xA;function ElementLinkedDocument(theElement, actions) {&#xA;	var notesOrig = theElement.GetLinkedDocument();&#xA;	var localSuccess = true;&#xA;	&#xA;	if (notesOrig != &quot;&quot;) {&#xA;		// Launch Microsoft Word - only if it's not already open&#xA;		if (objWord == null) {&#xA;			objWord = new ActiveXObject(&quot;Word.Application&quot;);&#xA;		}&#xA;		&#xA;		if (objWord == null) {&#xA;			localSuccess = false;&#xA;			return(localSuccess);&#xA;		}&#xA;			&#xA;		&#xA;		// Save the original RTF to a temporary file&#xA;		var objFSO = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);&#xA;		var TemporaryFolder = 2;&#xA;		var tfolder = objFSO.GetSpecialFolder(TemporaryFolder);&#xA;		var tname = objFSO.GetTempName() + &quot;.rtf&quot;;&#xA;		var tfile = tfolder.CreateTextFile(tname);&#xA;		tfile.WriteLine(notesOrig);&#xA;		tfile.Close();&#xA;		&#xA;		// The path the the temporary file&#xA;		var path = tfolder + &quot;\\&quot; + tname;&#xA;			&#xA;		// True: make Word visible; False: invisible&#xA;		objWord.Visible = false;&#xA;&#xA;		// Open the Word document&#xA;		var objDoc = objWord.Documents.Open(path);&#xA;&#xA;		// Make the opened file the active document&#xA;		// var objDoc = objWord.ActiveDocument;&#xA;		if (objDoc == null) {&#xA;			localSuccess = false;&#xA;		}&#xA;&#xA;		// objWord.Selection.Find.Execute(Replace:=wdReplaceAll);&#xA;		// http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.find.execute%28office.11%29.aspx&#xA;		/*&#xA;		function Execute(&#xA;				FindText : Object, &#xA;				MatchCase : Object, &#xA;				MatchWholeWord : Object, &#xA;				MatchWildcards : Object, &#xA;				MatchSoundsLike : Object, &#xA;				MatchAllWordForms : Object, &#xA;				Forward : Object, &#xA;				Wrap : Object, &#xA;				Format : Object, &#xA;				ReplaceWith : Object, &#xA;				Replace : Object, &#xA;				MatchKashida : Object, &#xA;				MatchDiacritics : Object, &#xA;				MatchAlefHamza : Object, &#xA;				MatchControl : Object&#xA;		) : Boolean;&#xA;		*/&#xA;&#xA;		if (actions &amp; ACTION_RED) {&#xA;			// Strip any red text that is formatted with strikethrough&#xA;			if (localSuccess) {&#xA;				clearWordSearchBug(objWord);&#xA;			&#xA;				objWord.Selection.Find.ClearFormatting();&#xA;				objWord.Selection.Find.Replacement.ClearFormatting();&#xA;				objWord.Selection.Find.Font.Color = wdColorRed;&#xA;				objWord.Selection.Find.Font.StrikeThrough = true;&#xA;				objWord.Selection.Find.IgnoreSpace = true;&#xA;				try {&#xA;					objWord.Selection.Find.Execute(&quot;*&quot;,&#xA;													false,&#xA;													false,&#xA;													true,&#xA;													false,&#xA;													false,&#xA;													true,&#xA;													wdFindContinue,&#xA;													true,&#xA;													&quot;&quot;,&#xA;													wdReplaceAll);&#xA;				} catch (e) {&#xA;					Session.Output(&quot;Find.Execute (Red Strike): Caught Exception: &quot; + e);&#xA;					localSuccess = false;&#xA;				}&#xA;			}&#xA;			&#xA;			// Make the red strike replacement for proper HTML tags: &lt;strike&gt; ... &lt;/strike&gt;&#xA;			// Note that JScript requires double \\ while VBA does not&#xA;			if (localSuccess) {&#xA;				clearWordSearchBug(objWord);&#xA;			&#xA;				objWord.Selection.Find.ClearFormatting();&#xA;				objWord.Selection.Find.Replacement.ClearFormatting();&#xA;				// Ignore color, as this may not work with multi-line matching.&#xA;				// objWord.Selection.Find.Font.Color = wdColorRed;&#xA;				objWord.Selection.Find.IgnoreSpace = true;&#xA;				try {&#xA;					objWord.Selection.Find.Execute(&quot;\\&lt;strike\\&gt;([!\\&lt;]@)\\&lt;\\/strike\\&gt;&quot;,&#xA;													false,&#xA;													false,&#xA;													true,&#xA;													false,&#xA;													false,&#xA;													true,&#xA;													wdFindContinue,&#xA;													true,&#xA;													&quot;&quot;,&#xA;													wdReplaceAll);&#xA;				} catch (e) {&#xA;					Session.Output(&quot;Find.Execute (Red Strike): Caught Exception: &quot; + e);&#xA;					localSuccess = false;&#xA;				}&#xA;			}&#xA;		&#xA;			// Make the red strike replacement for IMproper HTML tags: &lt;strike&gt; ... &lt;strike&gt;&#xA;			// Note that JScript requires double \\ while VBA does not&#xA;			if (localSuccess) {&#xA;				clearWordSearchBug(objWord);&#xA;			&#xA;				objWord.Selection.Find.ClearFormatting();&#xA;				objWord.Selection.Find.Replacement.ClearFormatting();&#xA;				// CAN'T Ignore color or we may match the wrong thing. &#xA;				//   e.g. &lt;strike&gt;some red text&lt;strike&gt; Some not red text &lt;strike&gt;red&lt;strike&gt;&#xA;				//     may actually match &quot; Some not red text &quot; if we don't enforce this!&#xA;				// Therefore this may not work with multi-line matching.&#xA;				objWord.Selection.Find.Font.Color = wdColorRed;&#xA;				objWord.Selection.Find.IgnoreSpace = true;&#xA;				try {&#xA;					objWord.Selection.Find.Execute(&quot;\\&lt;strike\\&gt;([!\\&lt;]@)\\&lt;strike\\&gt;&quot;,&#xA;													false,&#xA;													false,&#xA;													true,&#xA;													false,&#xA;													false,&#xA;													true,&#xA;													wdFindContinue,&#xA;													true,&#xA;													&quot;&quot;,&#xA;													wdReplaceAll);&#xA;				} catch (e) {&#xA;					Session.Output(&quot;Find.Execute (Red Strike): Caught Exception: &quot; + e);&#xA;					localSuccess = false;&#xA;				}&#xA;			}&#xA;		}&#xA;		&#xA;		// Remove Blue Highlight&#xA;		if (actions &amp; ACTION_BLUE) {&#xA;			// Note that JScript requires double \\ while VBA does not&#xA;			if (localSuccess) {&#xA;				clearWordSearchBug(objWord);&#xA;			&#xA;				objWord.Selection.Find.ClearFormatting();&#xA;				objWord.Selection.Find.Replacement.ClearFormatting();&#xA;				objWord.Selection.Find.Font.Color = wdColorBlue;&#xA;				// Only search for blue text with no underline, or links will have color removed&#xA;				objWord.Selection.Find.Font.Underline = wdUnderlineNone;&#xA;				objWord.Selection.Find.Replacement.Font.Color = wdColorBlack;&#xA;				objWord.Selection.Find.IgnoreSpace = true;&#xA;				try {&#xA;					// Note - this is incredibly inneficient. Word does not have a way to&#xA;					// do greedy searches, so this matches single characters!!!&#xA;					objWord.Selection.Find.Execute(&quot;(*{1,})&quot;,&#xA;													false,&#xA;													false,&#xA;													true,&#xA;													false,&#xA;													false,&#xA;													true,&#xA;													wdFindContinue,&#xA;													true,&#xA;													&quot;\\1&quot;,&#xA;													wdReplaceAll);&#xA;				} catch (e) {&#xA;					Session.Output(&quot;Find.Execute (Blue Text): Caught Exception: &quot; + e);&#xA;					localSuccess = false;&#xA;				}&#xA;			}&#xA;		}&#xA;			&#xA;		// Save changes&#xA;		// expression.Save(NoPrompt, OriginalFormat)&#xA;		if (localSuccess) {&#xA;			try {&#xA;				objDoc.Save();&#xA;			} catch (e) {&#xA;				Session.Output(&quot;Save: Caught Exception: &quot; + e);&#xA;				localSuccess = false;&#xA;			}&#xA;		}&#xA;			&#xA;		// Close the active document&#xA;		objDoc.Close();&#xA;			&#xA;		// Replace linked document with the contents of the file&#xA;		// if (theElement.LoadLinkedDocument (string Filename)) {&#xA;		if (localSuccess) {&#xA;			if (theElement.LoadLinkedDocument(path)) {&#xA;			&#xA;			} else {&#xA;				Session.Output(&quot;Error loading linked document from file&quot;);&#xA;				localSuccess = false;&#xA;			}&#xA;		}&#xA;&#xA;		objFSO.DeleteFile(path);&#xA;&#xA;		theElement.Update();&#xA;		theElement.Refresh();&#xA;		&#xA;		docsCount++;&#xA;		&#xA;		return(localSuccess);&#xA;	}&#xA;	&#xA;	return(localSuccess);&#xA;}&#xA;&#xA;// ----------------------------------------- Background Colors ----------------------------------------- //&#xA;&#xA;// Update &quot;Background Color&quot; for an element&#xA;function ElementColor(theElement) {&#xA;	/* SetAppearance (long Scope, long Item, long Value)&#xA;		Sets the visual appearance of the element.&#xA;&#xA;		Parameter:&#xA;&#xA;		Scope: Long - Scope of appearance set to modify&#xA; &#xA;		0  Local (Diagram-local appearance)&#xA;		1  Base (Default appearance across entire model) &#xA;		Item: Long - Appearance item to modify&#xA; &#xA;		0  Background color&#xA;		1  Font Color&#xA;		2  Border Color&#xA;		3  Border Width &#xA;		Value: Long - Value to set appearance to. &#xA;		                   R   G   B&#xA;		Default BG Color = 252 242 227 = #FCF2E3 = 16,577,251&#xA;		It seems that EA translates this BGR???? =&gt; 14,938,876&#xA;	*/&#xA;	// Don't do this for Screen Elements or it may lose the alternate image.&#xA;	if (theElement.Type != &quot;Screen&quot;) {&#xA;		theElement.SetAppearance(0, 0, 14938876);&#xA;		theElement.SetAppearance(1, 0, 14938876);&#xA;	&#xA;		backgroundCount++;&#xA;	}&#xA;}&#xA;&#xA;// Update &quot;Fill Color&quot; for all objects on a diagram&#xA;function DiagramObjectColor(theDiagram, actions, applyto) {&#xA;	var localSuccess = true;&#xA;	// Also need to change the &quot;Style&quot; in case someone set a fill color&#xA;	// This only works on diagram objects, so must find all diagrams with&#xA;	// instances of this element.&#xA;	// BCol = Background Color &#xA;	// BFol = Font Color &#xA;	// LCol = Line Color &#xA;	// LWth = Line Width &#xA;&#xA;	// Iterate through all diagram objects and update style&#xA;	var elementEnumerator = new Enumerator(theDiagram.DiagramObjects);&#xA;	&#xA;	while (!elementEnumerator.atEnd()) {&#xA;		var currentObject as EA.DiagramObject;&#xA;		currentObject = elementEnumerator.item();&#xA;		&#xA;		// Get a handle on the actual Element, and update that too&#xA;		var currentElement as EA.Element;&#xA;		currentElement = GetElementByID(currentObject.ElementID);&#xA;		&#xA;		// Don't do this for Screen Elements or it may lose the alternate image.&#xA;		if (currentElement.Type != &quot;Screen&quot;) {&#xA;			if (actions &amp; ACTION_DIAGRAM) {&#xA;				// Don't set the style here, or it will override the default color. &#xA;				// Just delete any applied styles.&#xA;				// currentObject.Style = &quot;BCol=14938876;BFol=0;LCol=0;LWth=1;&quot;;&#xA;				currentObject.Style = &quot;&quot;;&#xA;				currentObject.Update();&#xA;				diagramObjectCount++;&#xA;&#xA;				// Update the actual element&#xA;				ElementColor(currentElement);&#xA;			}&#xA;		}&#xA;		&#xA;		// For Diagram Notes, need to strip text colors, since they don't appear in the element lists&#xA;		// Session.Output(currentElement.Name + &quot; = &quot; + currentElement.Type + &quot; applyto=&quot; + applyto);&#xA;		if (currentElement.Name == &quot;&quot; &amp;&amp; currentElement.Type == &quot;Note&quot; &amp;&amp; (applyto &amp; APPLY_DIAGRAMNOTES)) {&#xA;			var notesOrig = currentElement.Notes;&#xA;			var notesNew = notesOrig;&#xA;&#xA;			// Strip Blue Font&#xA;			if (actions &amp; ACTION_BLUE) {&#xA;				notesNew = stripBlueFont(notesNew);&#xA;			}&#xA;		&#xA;			// Strip Red Text&#xA;			if (actions &amp; ACTION_BLUE) {&#xA;				notesNew = stripRedStrikeText(notesNew);&#xA;			}&#xA;		&#xA;			// Update the value only if something has actually changed&#xA;			if (notesNew != notesOrig) {&#xA;				currentElement.Notes = notesNew;&#xA;				currentElement.Update();&#xA;				diagramNotesCount++;&#xA;			}&#xA;		}&#xA;		&#xA;		// Refresh Element&#xA;		currentElement.Update();&#xA;		Repository.AdviseElementChange(currentElement.ElementID);&#xA;		currentElement.Refresh();	&#xA;		&#xA;		elementEnumerator.moveNext();&#xA;	}&#xA;	&#xA;	if (theDiagram.Update()) {&#xA;		Repository.ReloadDiagram(theDiagram.DiagramID);&#xA;&#xA;		// Diagram objects do not have a refresh method&#xA;		// theDiagram.Refresh();&#xA;	} else {&#xA;		Session.Output(&quot;--- ERROR --- An error ocurred when updating the diagram: &quot; + theDiagram.GetLastError());&#xA;		localSuccess = false;&#xA;	}&#xA;	&#xA;	diagramCount++;&#xA;}&#xA;&#xA;// ------------------------------------------- Update Element ------------------------------------------- //&#xA;&#xA;function UpdateElement(theElement, actions, applyto) {&#xA;	var localSuccess = true;&#xA;&#xA;	// Notes and Scenarios&#xA;	if (actions &amp; ACTION_BLUE || actions &amp; ACTION_RED) {&#xA;		if (applyto &amp; APPLY_NOTES) {&#xA;			ElementNotes(theElement, actions);&#xA;		}&#xA;		if (applyto &amp; APPLY_SCENARIOS) {&#xA;			ElementScenarios(theElement, actions);&#xA;		}&#xA;		if (applyto &amp; APPLY_CONSTRAINTS) {&#xA;			ElementConstraints(theElement, actions);&#xA;		}&#xA;	}&#xA;	&#xA;	// Linked Documents&#xA;	if (applyto &amp; APPLY_DOCUMENTS &amp;&amp; (actions &amp; ACTION_BLUE || actions &amp; ACTION_RED)) {&#xA;		if (!ElementLinkedDocument(theElement, actions)) {&#xA;			localSuccess = false;&#xA;		}&#xA;	}&#xA;	&#xA;	// Diagram element colors&#xA;	if (actions &amp; ACTION_DIAGRAM) {&#xA;		ElementColor(theElement);&#xA;	}&#xA;	&#xA;	if (theElement.Update()) {&#xA;		Repository.AdviseElementChange(theElement.ElementID);&#xA;		theElement.Refresh();	&#xA;	} else {&#xA;		Session.Output(&quot;--- ERROR --- An error ocurred when updating the element: &quot; + theElement.GetLastError());&#xA;		localSuccess = false;&#xA;	}&#xA;	&#xA;	elementsCount++;&#xA;	&#xA;	return(localSuccess);&#xA;}&#xA;&#xA;// --------------------------------------- Object Traversal -------------------------------------------- //&#xA;&#xA;// Process all elements in a package&#xA;function TraverseElements(thePackage, actions, applyto) {&#xA;	// Cast thePackage to EA.Package so we get intellisense&#xA;	var currentPackage as EA.Package;&#xA;	currentPackage = thePackage;&#xA;	&#xA;	// Iterate through all elements and add them to the list&#xA;	var elementEnumerator = new Enumerator(currentPackage.Elements);&#xA;	&#xA;	while (!elementEnumerator.atEnd()) {&#xA;		var currentElement as EA.Element;&#xA;		currentElement = elementEnumerator.item();&#xA;		&#xA;		UpdateElement(currentElement, actions, applyto);&#xA;		&#xA;		elementEnumerator.moveNext();&#xA;	}&#xA;	&#xA;	// Also have to traverse diagrams&#xA;	var diagramEnumerator = new Enumerator(currentPackage.Diagrams);&#xA;	&#xA;	while (!diagramEnumerator.atEnd()) {&#xA;		var currentDiagram as EA.Diagram;&#xA;		currentDiagram = diagramEnumerator.item();&#xA;		&#xA;		DiagramObjectColor(currentDiagram, actions, applyto);&#xA;		&#xA;		diagramEnumerator.moveNext();&#xA;	}&#xA;}&#xA;&#xA;// Recurse through all packages and update all elements in each pacakge&#xA;function TraversePackages(thePackage, actions, applyto) {&#xA;	// Cast thePackage to EA.Package so we get intellisense&#xA;	var currentPackage as EA.Package;&#xA;	currentPackage = thePackage;&#xA;	&#xA;	// Traverse the elements this package contains&#xA;	TraverseElements(currentPackage, actions, applyto);&#xA;	packagesCount++;&#xA;	&#xA;	// Recursively process any child packages&#xA;	var childPackageEnumerator = new Enumerator(currentPackage.Packages);&#xA;	&#xA;	while (!childPackageEnumerator.atEnd())	{&#xA;		var childPackage as EA.Package;&#xA;		childPackage = childPackageEnumerator.item();&#xA;		&#xA;		TraversePackages(childPackage, actions, applyto);&#xA;		&#xA;		childPackageEnumerator.moveNext();&#xA;	}&#xA;}&#xA;&#xA;// ------------------------------------------------- Main ------------------------------------------------- //&#xA;&#xA;function main() {&#xA;	var type = Repository.GetTreeSelectedItemType();&#xA;	var hasError = false;&#xA;	var myHTML = &quot;&quot;;&#xA;	var resultsHTML = &quot;&quot;;&#xA;	var actions = 0;&#xA;	var applyto = 0;&#xA;	&#xA;	if (type != ELEMENT_OBJECT_TYPE &amp;&amp; type != PACKAGE_OBJECT_TYPE &amp;&amp; type != DIAGRAM_OBJECT_TYPE) {&#xA;		Session.Prompt( &quot;This script requires a package, diagram or an element to be selected in the Project Browser.\n&quot; +&#xA;			&quot;Please select a package or an element in the Project Browser and try again.&quot;, 0 );&#xA;		return;&#xA;	}&#xA;&#xA;	// Create an IE Window&#xA;	InitIE();&#xA;	if (objIE == null) {&#xA;		Session.Prompt(&quot;There was an error launching Internet Explorer. Please try again.&quot;, 0);&#xA;		return;&#xA;	}&#xA;    &#xA;	// Create HTML to display in window&#xA;	myHTML += &quot;&lt;form onSubmit=\&quot;javascript: return(false)\&quot;&gt;\n&quot;;&#xA;	myHTML += &quot;  &lt;div id=\&quot;formDiv\&quot;&gt;\n&quot;;&#xA;	myHTML += &quot;    &lt;p&gt;This script will remove &lt;font color=#0000FF&gt;blue highlighting&lt;/font&gt; (except for &lt;font color=#0000FF&gt;&lt;u&gt;underlined blue text&lt;/u&gt;&lt;/font&gt;, which represents links), &quot;;&#xA;	myHTML += &quot;       remove text in &lt;font color=#FF0000&gt;red surrounded by &amp;lt;strike&amp;gt; tags&lt;/font&gt; and remove non-default colors from all diagram elements.&lt;/p&gt;\n&quot;;&#xA;	myHTML += &quot;    &lt;p&gt;Actions:&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;      &lt;input type=checkbox name=\&quot;Actions\&quot; value=\&quot;&quot; + ACTION_BLUE + &quot;\&quot; checked&gt;Remove Blue Highlight&lt;/input&gt;&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;      &lt;input type=checkbox name=\&quot;Actions\&quot; value=\&quot;&quot; + ACTION_RED + &quot;\&quot; checked&gt;Delete Red Strike Text&lt;/input&gt;&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;      &lt;input type=checkbox name=\&quot;Actions\&quot; value=\&quot;&quot; + ACTION_DIAGRAM + &quot;\&quot; checked&gt;Reset Colors on Diagram Elements&lt;/input&gt;&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;    &lt;/p&gt;\n&quot;;&#xA;	myHTML += &quot;    &lt;p&gt;Apply To:&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;      &lt;input type=checkbox name=\&quot;ApplyTo\&quot; value=\&quot;&quot; + APPLY_NOTES + &quot;\&quot; checked&gt;Element Notes&lt;/input&gt;&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;      &lt;input type=checkbox name=\&quot;ApplyTo\&quot; value=\&quot;&quot; + APPLY_DIAGRAMNOTES + &quot;\&quot; checked&gt;Diagram Notes&lt;/input&gt;&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;      &lt;input type=checkbox name=\&quot;ApplyTo\&quot; value=\&quot;&quot; + APPLY_SCENARIOS + &quot;\&quot; checked&gt;Scenarios&lt;/input&gt;&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;      &lt;input type=checkbox name=\&quot;ApplyTo\&quot; value=\&quot;&quot; + APPLY_CONSTRAINTS + &quot;\&quot; checked&gt;Constraints&lt;/input&gt;&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;      &lt;input type=checkbox name=\&quot;ApplyTo\&quot; value=\&quot;&quot; + APPLY_DOCUMENTS + &quot;\&quot; checked&gt;Linked Documents&lt;/input&gt;&lt;br/&gt;\n&quot;;&#xA;	myHTML += &quot;    &lt;/p&gt;\n&quot;;&#xA;	myHTML += &quot;    &lt;p&gt;&lt;input type=\&quot;button\&quot; value=\&quot; OK \&quot; onClick=\&quot;this.form.OK.value=1\&quot; name=\&quot;OKButton\&quot;&gt;\n&quot;;&#xA;	myHTML += &quot;       &lt;input type=\&quot;button\&quot; value=\&quot; Cancel \&quot; onClick=\&quot;this.form.OK.value=-1\&quot; name=\&quot;CancelButton\&quot;&gt;&lt;/p&gt;\n&quot;;&#xA;	myHTML += &quot;    &lt;input type=\&quot;hidden\&quot; id=\&quot;OK\&quot; name=\&quot;OK\&quot; value=\&quot;0\&quot;&gt;\n&quot;;&#xA;	myHTML += &quot;  &lt;/div&gt;\n&quot;;&#xA;	myHTML += &quot;  &lt;div id=\&quot;resultsDiv\&quot; name=\&quot;resultsDiv\&quot;&gt;\n&quot;;&#xA;	myHTML += &quot;  &lt;/div&gt;\n&quot;;&#xA;	myHTML += &quot;&lt;/form&gt;\n&quot;;&#xA;  &#xA;	// Insert the HTML code to prompt for user input&#xA;	if (objIE.document.getElementById(&quot;bodyContent&quot;) != null) {&#xA;		objIE.document.getElementById(&quot;header&quot;).innerHTML = objIE.Document.Title;&#xA;		objIE.document.getElementById(&quot;bodyContent&quot;).innerHTML = myHTML;&#xA;	} else {&#xA;		objIE.document.body.innerHTML = myHTML;&#xA;	}&#xA;  &#xA;	// Wait till the OK button has been clicked&#xA;	try {&#xA;		while (objIE.document.forms[0].OK.value == 0) {&#xA;			Sleep(1);&#xA;		}&#xA;	} catch(e) {&#xA;		// user clicked red X (or alt-F4) to close IE window&#xA;		// Session.Prompt(&quot;Caught error: &quot; + e + &quot;\n&quot; + e.description, 0);&#xA;		return;&#xA;	}&#xA;	&#xA;	// Close the window if they clicked cancel&#xA;	if (objIE.document.forms[0].OK.value == -1) {&#xA;		// Close and release the IE object&#xA;		objIE.Quit();&#xA;		objIE = null;&#xA;		&#xA;		return;&#xA;	}&#xA;&#xA;    // Read the user input from the dialog window&#xA;	for (var i=0; i &lt; objIE.document.forms[0].Actions.length; i++) {&#xA;		if (objIE.document.forms[0].Actions[i].checked) {&#xA;			actions += parseInt(objIE.document.forms[0].Actions[i].value);&#xA;			// Session.Output(actions);&#xA;		}&#xA;	}&#xA;	for (var i=0; i &lt; objIE.document.forms[0].ApplyTo.length; i++) {&#xA;		if (objIE.document.forms[0].ApplyTo[i].checked) {&#xA;			applyto += parseInt(objIE.document.forms[0].ApplyTo[i].value);&#xA;		}&#xA;	}&#xA;	&#xA;	if (actions == 0 || (applyto == 0 &amp;&amp; !(actions &amp; ACTION_DIAGRAM))) {&#xA;		// Close and release the IE object&#xA;		objIE.Quit();&#xA;		objIE = null;&#xA;		&#xA;		Session.Prompt(&quot;You must select an action to perform. Please try again.&quot;, 0);&#xA;		&#xA;		return;&#xA;	}&#xA;&#xA;	// Hide and disable form elements&#xA;	objIE.document.forms[0].Actions.disabled = true;&#xA;	objIE.document.forms[0].ApplyTo.disabled = true;&#xA;    objIE.document.forms[0].OKButton.disabled = true;&#xA;	objIE.document.forms[0].CancelButton.disabled = true;&#xA;	&#xA;	// Show a wait icon&#xA;	objIE.document.getElementById(&quot;resultsDiv&quot;).innerHTML = &quot;&lt;br/&gt;&lt;br/&gt;&lt;div align=center&gt;&lt;img src=\&quot;images/wait.gif\&quot;&gt;&lt;/div&gt;&quot;;&#xA;	&#xA;	// Process the elements&#xA;	if (type == ELEMENT_OBJECT_TYPE) {&#xA;		// Get the currently selected element in the tree to work on&#xA;		var theElement as EA.Element;&#xA;	&#xA;		theElement = Repository.GetTreeSelectedObject();&#xA;		if (theElement != null &amp;&amp; theElement.ObjectType == ELEMENT_OBJECT_TYPE) {&#xA;			UpdateElement(theElement, actions, applyto);&#xA;		}&#xA;	} else if (type == PACKAGE_OBJECT_TYPE) {&#xA;		// Get the currently selected package in the tree to work on&#xA;		var thePackage as EA.Package;&#xA;		&#xA;		thePackage = Repository.GetTreeSelectedPackage();&#xA;		&#xA;		TraversePackages(thePackage, actions, applyto);&#xA;		&#xA;		Repository.Models.Refresh();&#xA;	} else if (type == DIAGRAM_OBJECT_TYPE) {&#xA;		// Replace colors of elements on diagram&#xA;		var theDiagram as EA.Diagram;&#xA;	&#xA;		theDiagram = Repository.GetTreeSelectedObject();&#xA;	&#xA;		DiagramObjectColor(theDiagram, actions, applyto);&#xA;	} else {&#xA;		hasError = true;&#xA;	}&#xA;	&#xA;	resultsHTML = &quot;&lt;h3&gt;Results&lt;/h3&gt;\n&quot;;&#xA;	resultsHTML += &quot;&lt;table cellspacing=\&quot;0\&quot; cellpadding=\&quot;0\&quot; border=\&quot;0\&quot;&gt;\n&quot;;&#xA;	resultsHTML += &quot;&lt;tr&gt;&lt;th&gt;Action&lt;/th&gt;&lt;th&gt;#&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;/tr&gt;\n&quot;;&#xA;	if (hasError) {&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td colspan=3&gt;&lt;em&gt;No Results&lt;/em&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;	} else {&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Examined&lt;/td&gt;&lt;td&gt;&quot; + packagesCount + &quot;&lt;/td&gt;&lt;td&gt;Packages&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Examined&lt;/td&gt;&lt;td&gt;&quot; + elementsCount + &quot;&lt;/td&gt;&lt;td&gt;Elements&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Modified&lt;/td&gt;&lt;td&gt;&quot; + notesCount + &quot;&lt;/td&gt;&lt;td&gt;Notes&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Modified&lt;/td&gt;&lt;td&gt;&quot; + scenarioCount + &quot;&lt;/td&gt;&lt;td&gt;Scenarios&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Modified&lt;/td&gt;&lt;td&gt;&quot; + constraintCount + &quot;&lt;/td&gt;&lt;td&gt;Constraints&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Modified&lt;/td&gt;&lt;td&gt;&quot; + docsCount + &quot;&lt;/td&gt;&lt;td&gt;Linked Documents&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Modified&lt;/td&gt;&lt;td&gt;&quot; + diagramCount + &quot;&lt;/td&gt;&lt;td&gt;Diagrams&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Modified&lt;/td&gt;&lt;td&gt;&quot; + diagramNotesCount + &quot;&lt;/td&gt;&lt;td&gt;Diagram Notes&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Reset&lt;/td&gt;&lt;td&gt;&quot; + backgroundCount + &quot;&lt;/td&gt;&lt;td&gt;Element Backgrounds&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;		resultsHTML += &quot;  &lt;tr&gt;&lt;td&gt;Reset&lt;/td&gt;&lt;td&gt;&quot; + diagramObjectCount + &quot;&lt;/td&gt;&lt;td&gt;Diagram Object Backgrounds&lt;/td&gt;&lt;/tr&gt;\n&quot;;&#xA;	}&#xA;	resultsHTML += &quot;&lt;/table&gt;\n&quot;;&#xA;&#xA;	resultsHTML += &quot;&lt;p&gt;&lt;input type=\&quot;button\&quot; value=\&quot;Close Window\&quot; onClick=\&quot;window.close()\&quot;&gt;&lt;/p&gt;\n&quot;;&#xA;	&#xA;    // Insert the HTML code to show the results&#xA;    objIE.document.getElementById(&quot;resultsDiv&quot;).innerHTML = resultsHTML;&#xA;&#xA;	// Close Word if it was launched to modify a linked document.&#xA;	if (objWord != null) {&#xA;		// Close Word&#xA;		objWord.Quit();&#xA;	}&#xA;}&#xA;&#xA;main();"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="200"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{DB6CF9DC-6267-46b4-88DF-1ABD1B5CA213}"/>
			<Column name="ScriptAuthor" value="{8AEAB418-600A-48bb-9A45-15C360C4006E}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;xxx&quot; Type=&quot;Internal&quot; Language=&quot;JavaScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC Local Scripts.EAConstants-JScript&#xA;&#xA;/*&#xA; * Script Name: &#xA; * Author: &#xA; * Purpose: &#xA; * Date: &#xA; */&#xA; &#xA;function main()&#xA;{&#xA;@&quot;&#xA;    var obj= CreateActiveXObject(&quot;Scripting.FileSystemObject&quot;);&#xA;    var objTextFile = obj.CreateTextFile(&quot;c:/xxx.txt&quot;, True);&#xA;    objTextFile.Write(&quot;YO&quot;);&#xA;    objTextFile.Close();&#xA;	&#xA;&#xA;var methods = [];&#xA;for (var m in obj) {&#xA;    if (typeof obj[m] == &quot;function&quot;) {&#xA;        methods.push(m);&#xA;    }&#xA;}&#xA;return methods.join(&quot;,&quot;);&#xA;&#xA;&quot;&#xA;}&#xA;&#xA;main();"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="201"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{F3C33642-0FBC-445a-A2A7-7933991FF7C0}"/>
			<Column name="ScriptAuthor" value="{8AEAB418-600A-48bb-9A45-15C360C4006E}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;javas&quot; Type=&quot;Internal&quot; Language=&quot;JavaScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC Local Scripts.EAConstants-JScript&#xA;&#xA;/*&#xA; * Script Name: &#xA; * Author: &#xA; * Purpose: &#xA; * Date: &#xA; */&#xA; &#xA;function main()&#xA;{&#xA;@&quot;&#xA;&#xA;    var objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;);&#xA;  //  var objTextFile = objFSO.CreateTextFile(&quot;c:/xxx.txt&quot;, True);&#xA;  //  objTextFile.Write(&quot;YO&quot;);&#xA;  //  objTextFile.Close();&#xA;&#xA;  if(objFSO.DriveExists(&quot;C&quot;)){&#xA;   return &quot;C exists!!&quot;;&#xA;  }&#xA;/*&#xA;  if(!objFSO.driveExists(&quot;X&quot;)){&#xA;    alert(&quot;X not!!&quot;);&#xA;  }&#xA;*/&#xA;return &quot;&quot;;&#xA;&quot;&#xA;}&#xA;&#xA;main();"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="202"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="TFCS backup"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="203"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{06A08C46-5738-4271-B40F-647074A310D2}"/>
			<Column name="ScriptAuthor" value="{8AEAB418-600A-48bb-9A45-15C360C4006E}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;baselines&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC Local Scripts.EAConstants-VBScript&#xA;&#xA;'&#xA;' Script Name: &#xA;' Author: &#xA;' Purpose: &#xA;' Date: &#xA;'&#xA;sub makeBaseline&#xA;	if Repository.GetProjectInterface().CreateBaseline(&quot;{B68A9895-1151-4b31-9EAE-32440BFFF8FA}&quot;,&quot;0.02&quot;,&quot;Testje&quot;) then&#xA;		Session.Output &quot;Done!&quot;&#xA;	else&#xA;		Session.Output &quot;woops!&quot;&#xA;	end if&#xA;&#xA;end sub&#xA;&#xA;sub main&#xA;	dim result &#xA;''	baseLines = GetProjectInterface().GetBaselines(&quot;{B68A9895-1151-4b31-9EAE-32440BFFF8FA}&quot;,&quot;&quot;)&#xA;''	Session.output(&quot;Count: &quot;&amp;baseLines)&#xA;&#xA;	result = GetProjectInterface().DoBaselineCompare(&quot;{B68A9895-1151-4b31-9EAE-32440BFFF8FA}&quot;, _&#xA;		&quot;{97867C8A-C3E2-4758-9EB3-059B053E9A34}&quot;,&quot;&quot;)&#xA;	Session.output(result)&#xA;&#xA;&#xA;end sub&#xA;&#xA;main"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="204"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{38AD6227-8623-45d4-9126-5575FB5EA28F}"/>
			<Column name="ScriptAuthor" value="{8AEAB418-600A-48bb-9A45-15C360C4006E}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;HTML2RTF&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC Local Scripts.EAConstants-VBScript&#xA;&#xA;'&#xA;' Script Name: &#xA;' Author: &#xA;' Purpose: &#xA;' Date: &#xA;'&#xA;sub main&#xA;dim objFSO,objFile&#xA;	Dim h,r,s&#xA;&#xA;	Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xA;	Set objFile = objFSO.OpenTextFile(&quot;c:\cdd\BF-0130.txt&quot;, 1)&#xA;&#xA;	h= objFile.ReadAll&#xA;	session.output objFile.line&#xA;	objFile.Close&#xA;	&#xA;	session.output &quot;Contents: &quot;&amp;h&#xA;&#xA;	s = Repository.GetFieldFromFormat(&quot;HTML&quot;,h)&#xA;	r = Repository.GetFormatFromField(&quot;RTF&quot;,s)&#xA;&#xA;end sub&#xA;&#xA;main"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="205"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{149AC9B8-C2DF-46d6-B103-B013CFA025F5}"/>
			<Column name="ScriptAuthor" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_UpdateLearningcenter&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_COMMONS&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;'&#xA;' Display a main menu 'TFCS' for treeview and diagram&#xA;'&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	set EA_GetMenuItems = nothing&#xA;	if(MenuLocation = &quot;MainMenu&quot; and MenuName = &quot;-EA EventDelegator&quot;) then&#xA;		EA_GetMenuItems = &quot;Refresh TFCS Learning Center&quot;&#xA;	end if&#xA;end Function&#xA;&#xA;Sub EA_MenuClick(MenuLocation, MenuName, ItemName)&#xA;&#xA;	if (MenuLocation = &quot;MainMenu&quot; and MenuName = &quot;Refresh TFCS Learning Center&quot;) then&#xA;		' Copy Learning center files to the local installation dir of EA&#xA;		dim pck as EA.Package&#xA;		set pck = EAST.GetPackageByFQN(&quot;Systeemdocumentatie EDDA.Documentation.Learning Center&quot;)&#xA;		dim elt as EA.Element&#xA;		for each elt in pck.Elements&#xA;			EAST.WriteFileText &quot;D:/Data/EnterpriseArchitect/TFCS/Workstation/Instructies/&quot;+elt.Name+&quot;.rtf&quot;,elt.GetLinkedDocument()&#xA;			EAST.LogInfo(&quot;Exported &quot;+elt.name)&#xA;		next&#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="206"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{028AB4F2-1657-4cd8-8C47-127E758C19D3}"/>
			<Column name="ScriptAuthor" value="{F84E00CC-793B-4eca-B313-69DC30FAA19A}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_CreateFromToolbox&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Reacts to drop on diagram from toolbox.&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;option explicit&#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;!INC TFCS_Support.TFCS_WorkflowCreation&#xA;&#xA;Function EA_OnPostNewElement( Info ) &#xA;	EAST.LogStart(&quot;EA_OnPostNewElement&quot;)&#xA;	EA_OnPostNewElement = OnDropElement(GetElementByID(Info.get(&quot;ElementID&quot;).value))&#xA;	EAST.LogEnd(&quot;EA_OnPostNewElement&quot;)&#xA;end function&#xA;&#xA;dim replaceDroppedBy&#xA;Function OnDropElement( eltDropped ) &#xA;	EAST.LogStart(&quot;OnDropElement&quot;)&#xA;	OnDropElement = false&#xA;	&#xA;	dim dgm: set dgm = GetCurrentDiagram()&#xA;	if(dgm is nothing) then exit function end if&#xA;	dim dgmStereo : dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;	if Left(dgmStereo,4) &lt;&gt; &quot;TFCS&quot; then	&#xA;		EAST.LogWarning(&quot;Diagram is non-TFCS =&gt; standard EA handling&quot;)&#xA;		EAST.LogEnd(&quot;OnDropElement&quot;)&#xA;		exit function &#xA;	end if&#xA;&#xA;	set replaceDroppedBy = eltDropped&#xA;&#xA;	HandleDropElement dgm,dgmStereo,eltDropped&#xA;	&#xA;	if replaceDroppedBy is nothing then&#xA;		EAST.LogInfo(&quot;Dropped element removed...&quot;)&#xA;		DeleteElementFromModel(eltDropped)&#xA;	elseif replaceDroppedBy.ElementID &lt;&gt; eltDropped.ElementID then&#xA;		if ObjectIsOnDiagram(replaceDroppedBy.ElementID,dgm) then&#xA;			EAST.LogError(&quot;Object already on diagram =&gt; not allowed&quot;)&#xA;			DeleteElementFromModel(eltDropped)&#xA;			EAST.MsgBox DDH_PROMPT_ELTONDGM,16,DDH_TITLE_ELTONDGM&#xA;		else&#xA;			EAST.LogInfo(&quot;Replacing dropped element with '&quot;+replaceDroppedBy.name+&quot;' type &quot;+replaceDroppedBy.Type+&quot;{&quot;++replaceDroppedBy.Stereotype+&quot;)&quot;)&#xA;			dim posX, posY&#xA;			GetCoordinates dgm,eltDropped,posX,posY&#xA;			DeleteElementFromModel(eltDropped)&#xA;			addEltToDiagram replaceDroppedBy, dgm, posX, posY&#xA;			ReloadDiagram(dgm.DiagramID)&#xA;		end if&#xA;	end if&#xA;&#xA;	OnDropElement = true &#xA;	EAST.LogEnd(&quot;OnDropElement&quot;)&#xA;end function&#xA;&#xA;&#xA;' Get coordinates of the dropped element: this should be the element currently selected&#xA;sub GetCoordinates(dgm,eltDropped,posX,posY)&#xA;	dim result: set result = EAST.ExecuteSQL(SQL_GET_DIAGRAMOBJECT_RECT,dgm.diagramID&amp;&quot;|&quot;&amp;eltdropped.elementid)&#xA;	posX = 200&#xA;	posY = 200&#xA;	if not result is nothing and result.count &gt;= 1 then&#xA;		posX = result.item(0).item(&quot;RECTLEFT&quot;)&#xA;		PosY = -result.item(0).item(&quot;RECTTOP&quot;)&#xA;	end if&#xA;end sub&#xA;&#xA;sub HandleDropElement(dgm,dgmStereo,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropElement&quot;)&#xA;&#xA;	dim eltStereo : eltStereo = eltDropped.Stereotype&#xA;	if eltStereo = &quot;&quot; or Left(eltStereo,4) &lt;&gt; &quot;TFCS&quot; then&#xA;		' Handle drop of non-TFCS elements&#xA;		dim eltType : eltType = eltDropped.Type&#xA;		if eltType = &quot;Artifact&quot; _&#xA;			or eltType = &quot;Note&quot; _&#xA;			or eltType = &quot;Text&quot; _&#xA;			or eltType = &quot;Constraint&quot; _&#xA;			or eltType = &quot;Boundary&quot; _&#xA;			or eltType = &quot;Package&quot; _&#xA;			or eltType = &quot;UMLDiagram&quot; Then&#xA;			' Allowed, standard EA handling&#xA;			EAST.LogInfo(&quot;Drop of artifact,note,text,constraint,boundaries on TFCS dgm =&gt; OK&quot;)&#xA;		elseif eltType = &quot;&quot; then&#xA;			EAST.LogWarning(&quot;Inserting new element: elementtype missing (maybe copy-paste?) =&gt; silently ignored&quot;)&#xA;		else&#xA;			EAST.LogError(&quot;Non-TFCS element '&quot;+eltType+&quot;' drop on TFCS diagram '&quot;+dgmStereo+&quot;' =&gt; not allowed &quot;)&#xA;			set replaceDroppedBy = nothing&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;		end if&#xA;	else&#xA;		' Handle drop of TFCS elements/stereotypes on TFCS diagrams&#xA;		SuppressEADialogs = true &#xA;		if (dgmStereo = &quot;TFCS::TFCS_FlowsDiagram&quot;) then&#xA;			HandleDropOnFlowsDgm dgm,eltDropped &#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_FlowDefnDiagram&quot;) then&#xA;			HandleDropOnFlowDefnDgm dgm,eltDropped &#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_FlowDiagram&quot;) then&#xA;			HandleDropOnFlowDgm dgm,eltDropped &#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_DomainDiagram&quot;) then&#xA;			HandleDropOnDomainDgm dgm,eltDropped &#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_RequirementsDiagram&quot;) then&#xA;			HandleDropOnReqDgm dgm,eltDropped &#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_MaintenanceDiagram&quot;) then&#xA;			HandleDropOnMntDgm dgm,eltDropped &#xA;		else&#xA;			EAST.LogError(&quot;Drops on TFCS diagram type '&quot;+dgmStereo+&quot;' not yet defined =&gt; not allowed&quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;			EAST.LogEnd(&quot;HandleDropElement&quot;)&#xA;			exit sub&#xA;		end if&#xA;&#xA;'		if(removeDropped) then&#xA;'			dim dropX, dropY&#xA;'			GetElementPositionOnDiagram dgm,eltDropped,dropX,dropY&#xA;'			dim obj: set obj=addEltToDiagram(elt,dgm,dropX,dropY)&#xA;'			dgm.SelectedObjects.addnew obj.ElementID,obj.ElementID &#xA;'		end if&#xA;	end if&#xA;	EAST.LogEnd(&quot;HandleDropElement&quot;)&#xA;end sub&#xA;&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Handlers for specific TFCS diagrams&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;sub HandleDropOnFlowsDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnFlowsDgm&quot;)&#xA;	&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Actor&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Actor&quot;,GEN__PCK_ACTORS)&#xA;		case &quot;TFCS_Workflow&quot; &#xA;			set replaceDroppedBy = SelectWorkflow (dgm,&quot;UseCase,WerkInstructie,BedrijfsProces&quot;,&quot;&quot;)&#xA;		case &quot;TFCS_Requirement&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case else&#xA;			EAST.LogWarning(&quot;not allowed &quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWSDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnFlowsDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnFlowDefnDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnFlowDefnDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Actor&quot;&#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Actor&quot;,GEN__PCK_ACTORS)&#xA;		case &quot;TFCS_Workflow&quot; &#xA;			dim wfAct : set wfAct = Repository.GetElementByID(dgm.ParentID)&#xA;			dim wfUC : Set wfUC = wfAct.Elements.GetByName(wfAct.Name)&#xA;			dim defaultType : defaultType = GetTagValByName(wfUC.TaggedValues,&quot;WorkflowType&quot;)&#xA;			set replaceDroppedBy = SelectWorkflow (dgm,defaultType,defaultType)&#xA;		case &quot;TFCS_DomainInstance&quot; &#xA;			CreateDomainInstance dgm,eltDropped &#xA;		case &quot;TFCS_Requirement&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case else&#xA;			EAST.LogError(&quot;not allowed &quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDEFDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnFlowDefnDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnFlowDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnFlowDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Action&quot; &#xA;			CreateWorkflowInstance dgm,eltDropped&#xA;		case &quot;TFCS_AuthorisationEffect&quot; &#xA;			CreateAuthorisationEffect dgm,eltDropped &#xA;		case &quot;TFCS_DomainInstance&quot; &#xA;			CreateDomainInstance dgm,eltDropped &#xA;	'	case &quot;TFCS_DomainRule&quot; &#xA;	'		SelectElementForDropOnDiagram  dgm,eltDropped,&quot;Domeinregel&quot;,GEN__PCK_DOMAIN)&#xA;	'	case &quot;TFCS_Sketch&quot; &#xA;	'		CreateCompActionInstance( dgm,elt,&quot;Schermvoorbeeld&quot;)&#xA;		case &quot;TFCS_CompositeAction&quot; &#xA;			dim compType: compType = GetTagValByName(eltDropped.TaggedValues,&quot;CompositeActionType&quot;)&#xA;			if compType = &quot;Scherm&quot; then&#xA;				CreateCompActionInstance dgm,eltDropped,&quot;Scherm&quot; &#xA;			else&#xA;				CreateCompActionInstance dgm,eltDropped,&quot;Component&quot; &#xA;			end if&#xA;		case &quot;TFCS_Requirement&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ActivityInitial&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_ActivityFinal&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_AtomicAction&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_IntermediateResult&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_Decision&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_MergeNode&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_Event&quot;&#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case else &#xA;			EAST.LogError(&quot;not allowed &quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnFlowDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnDomainDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnDomainDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_DomainObject&quot;&#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram  (dgm,eltDropped,eltStereo,&quot;Domeinobject&quot;,GEN__PCK_DOMAIN)&#xA;		case &quot;TFCS_DomainRule&quot; &#xA;			SelectElementForDropOnDiagram  dgm,eltDropped,eltStereo,&quot;Domeinregel&quot;,GEN__PCK_DOMAIN&#xA;		case &quot;TFCS_Requirement&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case else&#xA;			EAST.LogError(&quot;not allowed &quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_DOMAINDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnDomainDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnReqDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnReqDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Requirement&quot;&#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Authorisation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Autorisatie&quot;,GEN__PCK_AUTHORISATIONS )&#xA;		case else&#xA;			EAST.LogError(&quot;not allowed &quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_REQDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnReqDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnMntDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnMntDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.Stereotype&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case else&#xA;			EAST.LogError(&quot;not allowed &quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_MNTDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnMntDgm&quot;)&#xA;end sub&#xA;&#xA;' Create a composite action instance in the model to be placed on a diagram&#xA;sub CreateCompActionInstance(dgm,eltDropped,compositeActionType)&#xA;	EAST.LogStart(&quot;CreateCompActionInstance&quot;)&#xA;	dim classifier&#xA;	if (compositeActionType = &quot;Scherm&quot;) then&#xA;		set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_GUI&quot;,&quot;Scherm&quot;,GEN__PCK_SCREENS)&#xA;	elseif (compositeActionType = &quot;Schermvoorbeeld&quot;) then&#xA;		set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_GUI&quot;,&quot;Schermvoorbeeld&quot;,GEN__PCK_SCREENS )&#xA;	elseif (compositeActionType = &quot;Component&quot;) then&#xA;		set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_CompositeActivity&quot;,&quot;Component&quot;,GEN__PCK_COMPONENTS)&#xA;	else&#xA;		EAST.LogError(&quot;Unsupported composite action type: &quot;+compositeActionType)&#xA;		EAST.MsgBox &quot;Unsupported composite action type: &quot;+compositeActionType,16,&quot;Creating composite activity&quot;&#xA;		set replaceDroppedBy = nothing&#xA;		EAST.LogEnd(&quot;CreateCompActionInstance&quot;)&#xA;		exit sub&#xA;	end if&#xA;&#xA;	if classifier is nothing then &#xA;		EAST.LogEnd(&quot;CreateCompActionInstance&quot;)&#xA;		exit sub &#xA;	end if&#xA;	&#xA;	' Get the name for the new element&#xA;	dim Name: Name = EAST.InputBox(&quot;Naam: &quot;,&quot;Toevoegen &quot;+compositeActionType,&quot;Mijn &quot;+compositeActionType)&#xA;	if Name = &quot;&quot; then &#xA;		EAST.LogInfo(&quot;User cancelled creation of new &quot;+compositeActionType)&#xA;		EAST.LogEnd(&quot;CreateCompActionInstance&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit sub &#xA;	end if&#xA;	&#xA;	' Link the classifier to the dropped element&#xA;	eltDropped.ClassifierID = classifier.ElementID&#xA;	eltDropped.ClassifierName = classifier.Name&#xA;	eltDropped.Name = Name&#xA;	SetTagValByName eltDropped.TaggedValues,&quot;CompositeActionType&quot;,compositeActionType,&quot;&quot;&#xA;	eltDropped.Update()&#xA;&#xA;	' Set the behaviour (not supported by 9.3 automation API)&#xA;	AddProperty eltDropped.ElementGUID,&quot;kind&quot;,&quot;ActionKind&quot;,&quot;CallBehavior&quot;,&quot;&quot;&#xA;	&#xA;	EAST.LogEnd(&quot;CreateCompActionInstance&quot;)&#xA;end sub&#xA;&#xA;' Create a domainobject instance in the model to be placed on a diagram&#xA;sub CreateDomainInstance(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;CreateDomainInstance&quot;)&#xA;	dim classifier&#xA;	set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_DomainObject&quot;,&quot;Domeinobject&quot;,GEN__PCK_DOMAIN)&#xA;	if classifier is nothing then &#xA;		EAST.LogInfo(&quot;User cancelled (no domainobject selected)&quot;)&#xA;		EAST.LogEnd(&quot;CreateDomainInstance&quot;)&#xA;		exit sub &#xA;	end if&#xA;	&#xA;	' Most of the time the domaininstance is not given a name so don't ask for it&#xA;	' User can always add one later&#xA;	eltDropped.ClassifierID = classifier.ElementID&#xA;	eltDropped.ClassifierName = classifier.Name&#xA;	eltDropped.Name = &quot;&quot;&#xA;	eltDropped.Update()&#xA;	EAST.LogInfo(&quot;Updated dropped element with selected classifier ('&quot;+classifier.Name+&quot;')&quot;)&#xA;	EAST.LogEnd(&quot;CreateDomainInstance&quot;)&#xA;end sub&#xA;&#xA;' Create an authorisation effect in the model to be placed on a diagram&#xA;sub CreateAuthorisationEffect(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;CreateAuthorisationEffect&quot;)&#xA;	dim classifier&#xA;	set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_Authorisation&quot;,&quot;Authorisatie&quot;,GEN__PCK_AUTHORISATIONS)&#xA;	if classifier is nothing then &#xA;		EAST.LogInfo(&quot;User cancelled (no authorisation selected)&quot;)&#xA;		EAST.LogEnd(&quot;CreateAuthorisationEffect&quot;)&#xA;		exit sub &#xA;	end if&#xA;&#xA;	' The effect of an AI from a user perspective: eg, data become visible, additional action can be performed, ...&#xA;	dim effect: effect = EAST.InputBox(&quot;Het effect van autorisatie '&quot;+classifier.Name+&quot;'&quot;+vbCRLF+ _&#xA;		&quot;op deze plaats is dat: &quot;,&quot;Nieuw autorisatie effect&quot;,&quot;&quot;)&#xA;	if effect = &quot;&quot; then &#xA;		EAST.LogInfo(&quot;User cancelled creation of autorisationitem effect&quot;)&#xA;		EAST.LogEnd(&quot;CreateAuthorisationEffect&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit sub &#xA;	end if&#xA;&#xA;	eltDropped.Notes = effect&#xA;	eltDropped.ClassifierID = classifier.ElementID&#xA;	eltDropped.ClassifierName = classifier.Name&#xA;	eltDropped.Update()&#xA;	EAST.LogInfo(&quot;Updated dropped element with selected classifier ('&quot;+classifier.Name+&quot;')&quot;)&#xA;	EAST.LogEnd(&quot;CreateAuthorisationEffect&quot;)&#xA;end sub&#xA;&#xA;' Create an workflow instance in the model to be placed on a diagram&#xA;sub CreateWorkflowInstance(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;CreateWorkflowInstance&quot;)&#xA;&#xA;	' New subflows must obey the rule: only same or lower level&#xA;	dim wfUC : set wfUC = Repository.GetElementByID(dgm.ParentID)&#xA;	dim defaultType : defaultType = GetTagValByName(wfUC.TaggedValues,&quot;WorkflowType&quot;)&#xA;	dim allowedTypes : allowedTypes = defaultType&#xA;	if defaultType = &quot;BedrijfsProces&quot; then&#xA;		allowedTypes = &quot;UseCase,WerkInstructie,BedrijfsProces&quot;&#xA;	elseif defaultType = &quot;WerkInstructie&quot; then&#xA;		allowedTypes = &quot;UseCase,WerkInstructie&quot;&#xA;	end if&#xA;	&#xA;	' Additional complexity: flowtype tag, and &#xA;	' classifier for the action is not the workflow (usecase) but its parent (activity)&#xA;	dim wf : set wf = SelectWorkflow(dgm,allowedTypes,defaultType)&#xA;	if wf is nothing then &#xA;		EAST.LogInfo(&quot;User cancelled (no workflow selected)&quot;)&#xA;		EAST.LogEnd(&quot;CreateWorkflowInstance&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit sub &#xA;	end if&#xA;&#xA;	dim classifier: set classifier = GetElementByID(wf.ParentID)&#xA;	dim flowType : flowType = GetTagValByName(wf.TaggedValues,&quot;WorkflowType&quot;)&#xA;	&#xA;	dim name: name = EAST.InputBox(&quot;Uit te voeren handeling:&quot;,&quot;Nieuwe stap (subflow)&quot;,eltDropped.name)&#xA;	eltDropped.Name = name&#xA;&#xA;	eltDropped.ClassifierID = classifier.ElementID&#xA;	eltDropped.ClassifierName = classifier.Name&#xA;	SetTagValByName eltDropped.TaggedValues,&quot;WorkflowType&quot;,flowtype,&quot;&quot;&#xA;	eltDropped.Update()&#xA;&#xA;	' Set the behaviour (not supported directly by 9.3 API)&#xA;	Repository.Execute(EAST.StrRep(&quot;insert into t_xref &quot;&amp;_&#xA;		&quot; (XRefID,name,type,visibility,partition,description,client,supplier)&quot; &amp;_&#xA;		&quot; values ('{0}','CustomProperties', 'element property', 'Public', 0, &quot; &amp;_&#xA;		&quot; '@PROP=@NAME=kind@ENDNAME;@TYPE=ActionKind@ENDTYPE;@VALU=CallBehavior@ENDVALU;@PRMT=@ENDPRMT;@ENDPROP;', &quot;&amp;_&#xA;		&quot; '{1}','&lt;none&gt;')&quot;,EAST.GenerateGUID()+&quot;|&quot;+eltDropped.ElementGUID))&#xA;&#xA;	EAST.LogInfo(&quot;Updated dropped element with selected workflow ('&quot;+classifier.Name+&quot;')&quot;)&#xA;	EAST.LogEnd(&quot;CreateWorkflowInstance&quot;)&#xA;end sub&#xA;&#xA;' Create a workflow in the model to be placed on a diagram&#xA;function SelectWorkflow(dgm,tagValues,dfltTagValue)&#xA;	EAST.LogStart(&quot;SelectWorkflow&quot;)&#xA;	set SelectWorkflow = nothing&#xA;&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;&#xA;	' Let the user select one of the existing UC-es or create a new one.&#xA;	dim userSelection : userSelection = SelectElementTagFromTree( _&#xA;		&quot;Selecteer een workflow&quot;,&quot;TFCS_Workflow&quot;, _&#xA;		&quot;WorkflowType&quot;,tagValues,model.Name,dfltTagValue,True)&#xA;	if userSelection = &quot;&quot;  then &#xA;		EAST.LogInfo(&quot;User cancelled selection&quot;)&#xA;		EAST.LogEnd(&quot;SelectWorkflow&quot;)&#xA;		exit function &#xA;	end if&#xA;	&#xA;	dim uc, ucActivity&#xA;	if left(userSelection,3) = &quot;NEW&quot; then&#xA;		' User opted to create a new workflow =&gt; userselection is in format: NEW&lt;model&gt;.&lt;workflowtype&gt;)&#xA;		dim pos : pos=InStrRev(userSelection,&quot;.&quot;)&#xA;		dim dropFlowType : dropFlowType = Mid(userSelection,pos+1)&#xA;		dim modelName : modelName= Mid(userSelection,4,pos-4)&#xA;		Set ucActivity = CreateWorkFlowForModel(dgm,dropFlowType,getWorkflowPrefix(dropFlowType),modelName)&#xA;		if ucActivity is nothing then &#xA;			EAST.LogInfo(&quot;User cancelled creation of new workflow&quot;)&#xA;			EAST.LogEnd(&quot;SelectWorkflow&quot;)&#xA;			exit function &#xA;		end if&#xA;		EAST.LogInfo(&quot;Created new workflow ('&quot;+ucActivity.Name+&quot;')&quot;)&#xA;		Set SelectWorkflow = ucActivity.Elements.GetByName(ucActivity.Name)&#xA;	else					&#xA;		' User selected existing workflow&#xA;		EAST.LogInfo(&quot;User selected existing workflow&quot;)&#xA;		set SelectWorkflow = GetElementByGUID(userSelection)&#xA;	end if&#xA;	EAST.LogEnd(&quot;SelectWorkflow&quot;)&#xA;end function&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Let the user select/create an element to drop on the diagram&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;function SelectElementForDropOnDiagram (dgm,eltDropped,stereoType,stereotypeName,packageName)&#xA;	EAST.LogStart(&quot;SelectElementForDropOnDiagram&quot;)&#xA;	set SelectElementForDropOnDiagram = nothing&#xA;&#xA;	' In the selectiontree dialog, open the model the diagram belongs to &#xA;	' (this is most likely the model the user wishes to select/create elements in)&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;	&#xA;	' Let the use make his choice&#xA;	dim userSelection : userSelection = SelectElementFromTree( _&#xA;		&quot;Selecteer een &quot;+stereotypeName,stereotype,stereotypeName, _&#xA;		model.Name,True,eltDropped)&#xA;	if userSelection = &quot;&quot;  then &#xA;		EAST.LogInfo(&quot;User cancelled selection&quot;)&#xA;		EAST.LogEnd(&quot;SelectElementForDropOnDiagram&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit function &#xA;	end if&#xA;	&#xA;	if left(userSelection,3) = &quot;NEW&quot; then&#xA;		' User opted to create a new element&#xA;		' userselection is in format: NEW&lt;model&gt;.&lt;element type&gt;)&#xA;		dim pos : pos=InStrRev(userSelection,&quot;.&quot;)&#xA;		dim modelName : modelName= Mid(userSelection,4,pos-4)&#xA;		&#xA;		' Iso creating a new element move the dropped one&#xA;		dim thePackage as EA.Package&#xA;		set thePackage = GetPrivatePackage(modelName,packageName)&#xA;&#xA;		' Get the name for the new element&#xA;		dim Name: Name = EAST.InputBox(&quot;Omschrijving &quot;+stereotypeName+&quot; : &quot;,&quot;Toevoegen &quot;+stereotypeName,&quot;Mijn &quot;+stereotypeName)&#xA;		if Name = &quot;&quot; then &#xA;			EAST.LogInfo(&quot;User cancelled creation of new &quot;+stereotypeName)&#xA;			EAST.LogEnd(&quot;SelectElementForDropOnDiagram&quot;)&#xA;			set replaceDroppedBy = nothing&#xA;			exit function &#xA;		end if&#xA;		&#xA;		eltDropped.Name = Name&#xA;		eltDropped.PackageID = thePackage.PackageID&#xA;		eltDropped.ParentID = 0&#xA;		thePackage.Elements.Refresh()&#xA;		eltDropped.Update()&#xA;		EAST.LogInfo(&quot;Created new &quot;+stereotypeName)&#xA;		set SelectElementForDropOnDiagram = eltDropped&#xA;	else					&#xA;		' User selected existing &#xA;		EAST.LogInfo(&quot;User selected existing &quot;+stereotypeName)&#xA;		set SelectElementForDropOnDiagram = GetElementByGUID(userSelection)&#xA;		EAST.LogInfo(&quot;Need to replace dropped element with new one&quot;)&#xA;	end if&#xA;	EAST.LogEnd(&quot;SelectElementForDropOnDiagram&quot;)&#xA;end function&#xA;&#xA;function AddClassifierToDropOnDiagram (dgm,eltDropped,stereoType,stereotypeName,packageName)&#xA;	EAST.LogStart(&quot;AddClassifierToDropOnDiagram&quot;)&#xA;	set AddClassifierToDropOnDiagram = nothing&#xA;&#xA;	' In the selectiontree dialog, open the model the diagram belongs to &#xA;	' (this is most likely the model the user wishes to select/create elements in)&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;	&#xA;	' Let the use make his choice&#xA;	dim userSelection : userSelection = SelectElementFromTree( _&#xA;		&quot;Selecteer een &quot;+stereotypeName,stereotype,stereotypeName, _&#xA;		model.Name,True,nothing)&#xA;	if userSelection = &quot;&quot;  then &#xA;		EAST.LogInfo(&quot;User cancelled selection&quot;)&#xA;		EAST.LogEnd(&quot;AddClassifierToDropOnDiagram&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit function &#xA;	end if&#xA;	&#xA;	if left(userSelection,3) = &quot;NEW&quot; then&#xA;		' User opted to create a new element&#xA;		' userselection is in format: NEW&lt;model&gt;.&lt;element type&gt;)&#xA;		dim pos : pos=InStrRev(userSelection,&quot;.&quot;)&#xA;		dim modelName : modelName= Mid(userSelection,4,pos-4)&#xA;		&#xA;		' Iso creating a new element move the dropped one&#xA;		dim thePackage as EA.Package&#xA;		set thePackage = GetPrivatePackage(modelName,packageName)&#xA;&#xA;		' Get the name for the new element&#xA;		dim Name: Name = EAST.InputBox(&quot;Omschrijving &quot;+stereotypeName+&quot; : &quot;,&quot;Toevoegen &quot;+stereotypeName,&quot;Mijn &quot;+stereotypeName)&#xA;		if Name = &quot;&quot; then &#xA;			EAST.LogInfo(&quot;User cancelled creation of new &quot;+stereotypeName)&#xA;			EAST.LogEnd(&quot;AddClassifierToDropOnDiagram&quot;)&#xA;			exit function &#xA;		end if&#xA;		&#xA;		dim classifier as EA.Element&#xA;		set classifier = thePackage.elements.AddNew(&quot;&quot;, &quot;TFCS::&quot;+stereotype ) &#xA;		classifier.Name = Name&#xA;		thePackage.Elements.Refresh()&#xA;		if classifier.isComposite then&#xA;			dim compDgm as EA.Diagram&#xA;			set compDgm = classifier.CompositeDiagram&#xA;			compDgm.Name = Name&#xA;			compDgm.update()&#xA;		end if&#xA;		classifier.Update()&#xA;		&#xA;		EAST.LogInfo(&quot;Created new &quot;+stereotypeName)&#xA;		set AddClassifierToDropOnDiagram = classifier&#xA;	else					&#xA;		' User selected existing &#xA;		EAST.LogInfo(&quot;User selected existing &quot;+stereotypeName)&#xA;		set AddClassifierToDropOnDiagram = GetElementByGUID(userSelection)&#xA;		EAST.LogInfo(&quot;Need to replace dropped element with new one&quot;)&#xA;	end if&#xA;	EAST.LogEnd(&quot;AddClassifierToDropOnDiagram&quot;)&#xA;end function&#xA;&#xA;function UpdateDroppedElement(dgm, eltDropped)&#xA;	EAST.LogStart(&quot;UpdateDroppedElement&quot;)&#xA;	set UpdateDroppedElement = nothing&#xA;	&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;	dim answer&#xA;	dim parent: set parent = GetElementByID(dgm.ParentID)&#xA;	select case eltDropped.StereoType &#xA;		case &quot;TFCS_ActivityInitial&quot;&#xA;			eltDropped.Name = &quot;&quot;&#xA;			EAST.LogInfo(&quot;TFCS_ActivityInitial =&gt; cleared text&quot;)&#xA;		case &quot;TFCS_ActivityFinal&quot; &#xA;			eltDropped.Name = &quot;&quot;&#xA;			EAST.LogInfo(&quot;TFCS_ActivityFinal =&gt; cleared text&quot;)&#xA;		case &quot;TFCS_Event&quot; &#xA;			answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuw event&quot;,eltDropped.name)&#xA;			if answer = empty or answer = &quot;&quot; then &#xA;				EAST.LogInfo(&quot;user cancelled&quot;)&#xA;				EAST.LogEnd(&quot;UpdateDroppedElement&quot;)&#xA;				set replaceDroppedBy = nothing&#xA;				exit function &#xA;			end if&#xA;			eltDropped.Name = answer&#xA;			EAST.LogInfo(&quot;TFCS_Event =&gt; added text&quot;)&#xA;'		case &quot;TFCS_Actor&quot; &#xA;'			answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuwe actor&quot;,eltDropped.name)&#xA;'			if answer = empty or answer = &quot;&quot; then exit function end if&#xA;'			dim thePackage : set thePackage = GetPrivatePackage(model.Name,GEN__PCK_ACTORS)&#xA;'			eltDropped.ParentID = thePackage.PackageID&#xA;'			eltDropped.PackageID = thePackage.PackageID&#xA;'			eltDropped.Name = answer&#xA;'			thepackage.elements.refresh()&#xA;		case &quot;TFCS_IntermediateResult&quot; &#xA;			answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuw tussenresultaat&quot;,eltDropped.name)&#xA;			if answer = empty or answer = &quot;&quot; then &#xA;				EAST.LogInfo(&quot;user cancelled&quot;)&#xA;				EAST.LogEnd(&quot;UpdateDroppedElement&quot;)&#xA;				set replaceDroppedBy = nothing&#xA;				exit function &#xA;			end if&#xA;			eltDropped.Name = answer&#xA;			EAST.LogInfo(&quot;TFCS_IntermediateResult =&gt; added text&quot;)&#xA;		case &quot;TFCS_AtomicAction&quot; &#xA;			answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuwe stap&quot;,eltDropped.name)&#xA;			if answer = empty or answer = &quot;&quot; then &#xA;				EAST.LogInfo(&quot;user cancelled&quot;)&#xA;				EAST.LogEnd(&quot;UpdateDroppedElement&quot;)&#xA;				set replaceDroppedBy = nothing&#xA;				exit function &#xA;			end if&#xA;			eltDropped.Name = answer&#xA;			EAST.LogInfo(&quot;TFCS_AtomicAction =&gt; added text&quot;)&#xA;		case else&#xA;			EAST.LogInfo(eltDropped.StereoType+&quot; =&gt; unaltered&quot;)&#xA;	end select&#xA;&#xA;	eltDropped.Update()&#xA;		&#xA;	set UpdateDroppedElement = eltDropped&#xA;	EAST.LogEnd(&quot;UpdateDroppedElement&quot;)&#xA;end function&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="207"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="TFCS_Support"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="208"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{8A28179C-6AE4-4ea0-8E2D-3D67E152B24D}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_VALSQL&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="' =================================================================================================&#xA;' SQL statements used for model validation&#xA;' =================================================================================================&#xA;&#xA;' Check if a relation exists&#xA;dim VAL_SQL_ELT_REFERENCES_ELT : VAL_SQL_ELT_REFERENCES_ELT = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot; from (( t_object oFrom inner join t_connector conn on oFrom.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			inner  join t_object  oTo on oTo.object_id = conn.end_object_id)&quot; + _&#xA; &quot; where oFrom.object_id = {0} &quot; + _&#xA; &quot; 		and (conn.connector_type = {1} or {1}='')&quot; + _&#xA; &quot; 		and (conn.subtype = {2} or {2}='')&quot; + _&#xA; &quot;		and oTo.object_id = {3}&quot;&#xA; &#xA;' Get all references to objects of a specific type, by a specific relationtype&#xA;dim VAL_SQL_ELT_REFERENCES : VAL_SQL_ELT_REFERENCES = _&#xA; &quot; select oTo.object_id as ID&quot; + _&#xA; &quot; from (( t_object oFrom inner join t_connector conn on oFrom.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			inner  join t_object  oTo on oTo.object_id = conn.end_object_id)&quot; + _&#xA; &quot; where oFrom.object_id = {0} &quot; + _&#xA; &quot; 		and (ucase({1}) like '*'+ucase(conn.connector_type)+'*' or {1} = '')&quot; + _&#xA; &quot;		and (ucase({2}) like '*'+ucase(oTo.Stereotype)+'*' or {2} = '')&quot;&#xA; &#xA;' Get all objects of a specific type referencing this object, by a specific relationtype&#xA;dim VAL_SQL_ELT_REFERENCED_BY : VAL_SQL_ELT_REFERENCED_BY = _&#xA; &quot; select oFrom.object_id as ID&quot; + _&#xA; &quot; from (( t_object oFrom inner join t_connector conn on oFrom.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			inner  join t_object  oTo on oTo.object_id = conn.end_object_id)&quot; + _&#xA; &quot; where oTo.object_id = {0} &quot; + _&#xA; &quot; 		and (ucase({1}) like '*'+ucase(conn.connector_type)+'*' or {1} = '')&quot; + _&#xA; &quot;		and (ucase({2}) like '*'+ucase(oFrom.Stereotype)+'*' or {2} = '')&quot;&#xA;&#xA;' Counts all relations to/from an element&#xA; dim VAL_SQL_RELATIONS_FOR_ELT: VAL_SQL_RELATIONS_FOR_ELT = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot; from t_object o, t_connector conn where  o.object_id = {0} and (o.object_id = conn.start_object_id&quot; + _&#xA; &quot; 			or o.object_id = conn.end_object_id)&quot;  + _&#xA; &quot;          and (ucase({1}) like '*'+ucase(conn.connector_type)+'*' or {1} = '')&quot;&#xA;&#xA;' Counts the number of diagrams the element is on, -limitied to- a list of specific TFCS diagram stereotypes.&#xA;dim VAL_SQL_CNT_DGMS_WITH_ELT : VAL_SQL_CNT_DGMS_WITH_ELT = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot; from t_diagramobjects do&quot; + _&#xA; &quot; 	,t_diagram d&quot; + _&#xA; &quot; where do.diagram_id = d.diagram_id&quot; + _&#xA; &quot; 	and do.object_id = {0}&quot; + _&#xA; &quot;  and instr(d.StyleEx,'MDGDgm=TFCS::')&gt;0&quot; + _&#xA; &quot;  and ucase(mid(d.StyleEx,instr(d.StyleEx,'MDGDgm=TFCS::')+13,instr(instr(d.StyleEx,'MDGDgm=TFCS::'),d.StyleEx,';')-instr(d.StyleEx,'MDGDgm=TFCS::')-13)) in ({1})&quot;&#xA;&#xA;' Counts the number of diagrams the element is on, -excluding- a list of specific TFCS diagram stereotypes.&#xA;dim VAL_SQL_CNT_OTHER_DGMS_WITH_ELT: VAL_SQL_CNT_OTHER_DGMS_WITH_ELT = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot; from t_diagramobjects do&quot; + _&#xA; &quot; 	,t_diagram d&quot; + _&#xA; &quot; where do.diagram_id = d.diagram_id&quot; + _&#xA; &quot; 	and do.object_id = {0}&quot; + _&#xA; &quot;  and instr(d.StyleEx,'MDGDgm=TFCS::')&gt;0&quot; + _&#xA; &quot;  and ucase(mid(d.StyleEx,instr(d.StyleEx,'MDGDgm=TFCS::')+13,instr(instr(d.StyleEx,'MDGDgm=TFCS::'),d.StyleEx,';')-instr(d.StyleEx,'MDGDgm=TFCS::')-13)) not in ({1})&quot;&#xA; &#xA; ' Check if an element is included in any other diagram than the one below its parent&#xA;' (note: check if parent has only one diagram is done elsewhere)&#xA;dim VAL_SQL_CNT_OTHER_DIAGRAMS_FOR_ELT : VAL_SQL_CNT_OTHER_DIAGRAMS_FOR_ELT = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot; from t_object o, t_diagramobjects do&quot; + _&#xA; &quot; 	,t_diagram d&quot; + _&#xA; &quot; where o.object_id = do.object_id and do.diagram_id = d.diagram_id&quot; + _&#xA; &quot;  and d.parentid &lt;&gt; o.parentid &quot; + _&#xA; &quot; 	and o.object_id = {0}&quot; &#xA;&#xA; ' Does a composite element contain elements of a specific type in one of its composite diagrams?&#xA;dim VAL_SQL_COMPOSITE_CONTAINS : VAL_SQL_COMPOSITE_CONTAINS = _&#xA; &quot;  select count(*) as RESULT&quot; + _&#xA; &quot;  from t_diagram d&quot; + _&#xA; &quot; 		,t_diagramobjects do&quot; + _&#xA; &quot;  	,t_object o&quot; + _&#xA;  &quot;  where do.diagram_id = d.diagram_id&quot; + _&#xA; &quot; 		and do.object_id = o.object_id&quot; + _&#xA; &quot; 		and d.parentid = {0}&quot; + _&#xA; &quot; 		and (ucase({1}) like '*'+ucase(o.stereotype)+'*' or {1} = '')&quot;&#xA; &#xA; ' Element contained on a diagram for a GUI or component element&#xA; dim VAL_SQL_CONTAINED_IN_COMP : VAL_SQL_CONTAINED_IN_COMP = _&#xA; &quot;  select count(*) as RESULT&quot; + _&#xA; &quot;  from t_diagram d&quot; + _&#xA; &quot; 		,t_diagramobjects do&quot; + _&#xA; &quot;  	,t_object o&quot; + _&#xA; &quot; 		,t_object p&quot; + _&#xA; &quot;  where o.object_id = {0}&quot; + _&#xA; &quot; 		and do.object_id = o.object_id&quot; + _&#xA; &quot; 		and do.diagram_id = d.diagram_id&quot; + _&#xA; &quot; 		and d.parentid = p.object_id&quot; + _&#xA; &quot; 		and ucase(p.stereotype) in ('TFCS_GUI','TFCS_CompositeActivity')&quot;&#xA; &#xA; ' Get stereotype of the parent of a diagram ('Package' if not an element)&#xA; dim VAL_SQL_PARENT_STEREOTYPE : VAL_SQL_PARENT_STEREOTYPE = _&#xA; &quot;  select  count(*) as RESULT&quot; + _&#xA; &quot; from t_diagram d, t_object o&quot; + _&#xA; &quot; where d.parentID = o.object_id&quot; + _&#xA; &quot; and d.diagram_id = {0} and o.stereotype not in ({1})&quot;&#xA; &#xA;' Element has exactly one diagram, and this is of the specified type&#xA;const VAL_SQL_DGMSTEREO_FOR_ELT = &quot;select d.StyleEx from t_diagram d where d.parentid = {0}&quot; &#xA;&#xA;' Get the elements that have an element as classifier&#xA;const VAL_SQL_GET_AS_CLASSIFIER = &quot;select o.object_ID from t_object o where o.classifier = {0}&quot;&#xA;&#xA;' Returns the sublow actions for a workflow of a specific workflow type&#xA;' IN: object ID of the TFCS_Workflow element&#xA;' OUT: list of action ID's on the flowdiagram for the requested subflowtypees&#xA;dim VAL_SQL_SUBFLOWS_OFTYPE : VAL_SQL_SUBFLOWS_OFTYPE = _&#xA; &quot; select o.object_ID as ID&quot; + _&#xA; &quot;   from t_object p &quot; + _&#xA; &quot; 		,t_diagram d &quot; + _&#xA; &quot;  	,t_diagramobjects do &quot; + _&#xA; &quot; 		,t_object o &quot; + _&#xA; &quot; 		,t_objectproperties tv &quot; + _&#xA; &quot;   where  d.parentid = {0} &quot; + _&#xA; &quot; 		and ucase(d.StyleEx) like '*TFCS::TFCS_FLOWDIAGRAM*'  &quot; + _&#xA; &quot;   		and do.diagram_id = d.diagram_id  &quot; + _&#xA; &quot;  		and do.object_id = o.object_id &quot; + _&#xA; &quot; 		and tv.Object_ID = o.object_id &quot; + _&#xA; &quot; 		and tv.property = 'WorkflowType' &quot; + _&#xA; &quot; 		and tv.value in ({1})  &quot;&#xA; &#xA; ' Select all workflow defs (UC eltements) on a diagram&#xA; dim VAL_SQL_WFS_ON_UCDEF : VAL_SQL_WFS_ON_UCDEF = _&#xA; &quot;  select o.object_ID as ID&quot; + _&#xA; &quot;     from t_diagram d &quot; + _&#xA; &quot; 		,t_diagramobjects do &quot; + _&#xA; &quot;   		,t_object o &quot; + _&#xA; &quot;     where  d.diagram_id = {0}&quot; + _&#xA; &quot;    		and do.diagram_id = d.diagram_id  &quot; + _&#xA; &quot;   		and do.object_id = o.object_id &quot; + _&#xA; &quot; 		and o.stereotype = 'TFCS_Workflow'&quot;&#xA;		&#xA; ' All instances of a WF must have the same value for 'WorkflowType' as the WF itself&#xA; dim VAL_SQL_CHECK_INST_HASSAMETAG : VAL_SQL_CHECK_INST_HASSAMETAG = _&#xA; &quot; select tv.value&quot; + _&#xA; &quot;   from t_object o, t_objectproperties tv &quot; + _&#xA; &quot;   where  o.classifier = {0}&quot;  + _&#xA; &quot;   	and o.object_id = tv.object_id &quot;  + _&#xA; &quot; 		and ucase(tv.property) = ucase('{1}') &quot; + _&#xA; &quot; 		and tv.value in ({2})  &quot;&#xA;&#xA;dim VAL_SQL_CNT_WF_OFTYPE : VAL_SQL_CNT_WF_OFTYPE = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot;   from t_diagramobjects do, t_diagram d, t_objectproperties tv &quot; + _&#xA; &quot;   where  do.object_id = {0} and do.diagram_id = d.diagram_id &quot;  + _&#xA; &quot;   	and d.parentid = tv.object_id &quot;  + _&#xA; &quot; 		and tv.property = 'WorkflowType'&quot; + _&#xA; &quot; 		and tv.value in ({1})&quot;&#xA;&#xA;'Check if an element has valid tagvalue&#xA;dim VAL_SQL_HAS_TAGVALUE : VAL_SQL_HAS_TAGVALUE = _&#xA; &quot; select tv.value&quot; + _&#xA; &quot;   from t_objectproperties tv &quot; + _&#xA; &quot;   where tv.object_id = {0} &quot;  + _&#xA; &quot; 		and ucase(tv.property) = ucase('{1}') &quot; + _&#xA; &quot; 		and tv.value in ({2})  &quot;&#xA;&#xA;' Count the number of compnents that include this element as subflow&#xA;dim VAL_SQL_CNT_COMP : VAL_SQL_CNT_COMP = _&#xA;&quot; select count(*) as RESULT&quot; + _&#xA; &quot; from (t_diagramobjects do inner join t_diagram d on do.diagram_id = d.diagram_id)  &quot; + _&#xA; &quot; where  do.object_id = {0} &quot; + _&#xA; &quot; 	and not exists &quot; + _&#xA; &quot;     (select tv.property from t_objectproperties tv  &quot; + _&#xA; &quot;      where  d.parentid = tv.object_id and tv.property = 'WorkflowType' )&quot; &#xA;&#xA;&#xA;dim VAL_SQL_WF_EXTENDS_OTHERLEVEL : VAL_SQL_WF_EXTENDS_OTHERLEVEL = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot; from ((( t_object oFrom inner join t_connector conn on oFrom.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			inner  join t_object oTo on oTo.object_id = conn.end_object_id)&quot; + _&#xA; &quot; 			inner  join t_objectproperties tv on oTo.object_id = tv.object_id)&quot; + _&#xA; &quot; where oFrom.object_id = {0}&quot; + _&#xA; &quot; 		and conn.connector_type = 'UseCase'&quot; + _&#xA; &quot;		and conn.SubType = 'Extends'&quot; + _&#xA; &quot;		and tv.property = 'WorkflowType'&quot; + _&#xA; &quot;		and tv.value &lt;&gt; '{1}'&quot;&#xA;&#xA;' Get all elements that have been used as classifier on the flowrealisation but have not &#xA;' been included in the defn, for a given flowrealisation and stereotype of classifier&#xA;dim VAL_SQL_GET_MISSING_CLASSIFIERS_ON_WFDEFN : VAL_SQL_GET_MISSING_CLASSIFIERS_ON_WFDEFN = _&#xA; &quot;	select distinct dd.diagram_id, c.object_id &quot; + _&#xA; &quot;	from t_object uc&quot; + _&#xA; &quot;		,t_diagram dd&quot; + _&#xA; &quot;		,t_diagram fd&quot; + _&#xA; &quot;		,t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where fd.diagram_id = {0} &quot; +_&#xA; &quot;  	and dd.parentid = uc.parentid &quot; + _&#xA; &quot;		and uc.object_id = fd.parentID&quot; + _&#xA; &quot;		and fdo.diagram_id = fd.diagram_id&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = c.object_id&quot; + _&#xA; &quot;		and c.stereotype in ({1})&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and c.object_id = ddo.object_id) &quot;&#xA;&#xA;dim VAL_SQL_GET_MISSING_INST_ON_WFDEFN: VAL_SQL_GET_MISSING_INST_ON_WFDEFN = _&#xA; &quot;	select distinct dd.diagram_id, c.object_id &quot; + _&#xA; &quot;	from t_object uc&quot; + _&#xA; &quot;		,t_diagram dd&quot; + _&#xA; &quot;		,t_diagram fd&quot; + _&#xA; &quot;		,t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where fd.diagram_id = {0} &quot; +_&#xA; &quot;  	and dd.parentid = uc.parentid &quot; + _&#xA; &quot;		and uc.object_id = fd.parentID&quot; + _&#xA; &quot;		and fdo.diagram_id = fd.diagram_id&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = c.object_id&quot; + _&#xA; &quot;		and c.stereotype in ({1})&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo, t_object o &quot; + _&#xA; &quot;				where ddo.diagram_id = dd.diagram_id and ddo.object_id = o.object_id&quot; + _&#xA; &quot;					and c.object_id = o.classifier) &quot;&#xA;&#xA;' Get all subflows on a workflow realisation that are missing on its workflow definition&#xA;dim VAL_SQL_GET_MISSING_WORKFLOWS_ON_WFDEFN : VAL_SQL_GET_MISSING_WORKFLOWS_ON_WFDEFN = _&#xA; &quot;	select distinct dd.diagram_id, c.object_id,uc.object_id as wf_id &quot; + _&#xA; &quot;	from t_object uc&quot; + _&#xA; &quot;		,t_diagram dd&quot; + _&#xA; &quot;		,t_diagram fd&quot; + _&#xA; &quot;		,t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object ac&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where fd.diagram_id = {0} &quot; +_&#xA; &quot;  	and dd.parentid = uc.parentid &quot; + _&#xA; &quot;		and uc.object_id = fd.parentID&quot; + _&#xA; &quot;		and fdo.diagram_id = fd.diagram_id&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = ac.object_id&quot; + _&#xA; &quot;		and ac.stereotype = 'TFCS_Activity'&quot; + _&#xA; &quot;		and c.parentid = ac.object_id&quot; + _&#xA; &quot;		and c.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and c.object_id = ddo.object_id) &quot;&#xA;&#xA;' Get all elements on a workflow realisation that are missing on its workflow definition&#xA;dim VAL_SQL_GET_MISSING_ELTS_ON_WFDEFN : VAL_SQL_GET_MISSING_ELTS_ON_WFDEFN = _&#xA; &quot;	select distinct dd.diagram_id, fo.object_id&quot; + _&#xA; &quot;	from t_object uc&quot; + _&#xA; &quot;		,t_diagram dd&quot; + _&#xA; &quot;		,t_diagram fd&quot; + _&#xA; &quot;		,t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;	where fd.diagram_id = {0} &quot; +_&#xA; &quot;		and uc.object_id = fd.parentID&quot; + _&#xA; &quot;		and fdo.diagram_id = fd.diagram_id&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.stereotype in ({1})&quot; + _&#xA; &quot;  	and dd.parentid = uc.parentid &quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and fo.object_id = ddo.object_id) &quot;&#xA;&#xA;' Get all elements that have been used -as classifier- on the flowrealisation but have not &#xA;' been included in the defn&#xA;dim VAL_SQL_GET_MISSING_CLASSIFIERINST_ON_WFDEFN : VAL_SQL_GET_MISSING_CLASSIFIERINST_ON_WFDEFN = _&#xA; &quot;	select distinct dd.diagram_id, c.object_id &quot; + _&#xA; &quot;	from t_object uc&quot; + _&#xA; &quot;		,t_diagram dd&quot; + _&#xA; &quot;		,t_diagram fd&quot; + _&#xA; &quot;		,t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where fd.diagram_id = {0} &quot; +_&#xA; &quot;  	and dd.parentid = uc.parentid &quot; + _&#xA; &quot;		and uc.object_id = fd.parentID&quot; + _&#xA; &quot;		and fdo.diagram_id = fd.diagram_id&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = c.object_id&quot; + _&#xA; &quot;		and c.stereotype in ({1})&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo, t_object do &quot; + _&#xA; &quot;				where  ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and do.object_id = ddo.object_id&quot; + _&#xA; &quot;					and do.classifier = c.object_id) &quot;&#xA;&#xA;' Get missing includes, excludes &amp; actors on a workflow definition diagram&#xA;' TBD: performance enhancement&#xA;dim VAL_SQL_GET_MISSING_RELATIONS_ON_WFDEFN : VAL_SQL_GET_MISSING_RELATIONS_ON_WFDEFN = _&#xA; &quot;	select r.object_id &quot; + _&#xA; &quot;	from t_diagram dd&quot; + _&#xA; &quot;		,t_diagramobjects ddo&quot; + _&#xA; &quot;		,t_object uc&quot; + _&#xA; &quot;		,t_connector conn&quot; + _&#xA; &quot;		,t_object r&quot; + _&#xA; &quot;	where  ddo.diagram_id  = dd.diagram_id &quot; + _&#xA; &quot;		and ddo.object_id = uc.object_id&quot; + _&#xA; &quot;		and uc.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;		and ((uc.object_id = conn.start_object_id and r.object_id = conn.end_object_id)&quot; + _&#xA; &quot;			or (uc.object_id = conn.end_object_id and r.object_id = conn.start_object_id))&quot; + _&#xA; &quot;		and dd.diagram_ID = {0}&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where  ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and r.object_id = ddo.object_id)&quot;&#xA; &#xA;' Checks if for an instance of a classifier placed on a workflow -realisation- diagram -the&#xA;' classifier- existsts on the corresponding workflow -definition- as well&#xA;dim VAL_SQL_CNT_CLASSIFIER_MISSING_ON_DD : VAL_SQL_CNT_CLASSIFIER_MISSING_ON_DD = _&#xA; &quot;	select count(*) as RESULT&quot; + _&#xA; &quot;	from t_object uc&quot; + _&#xA; &quot;		,t_diagram fd&quot; + _&#xA; &quot;		,t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where uc.object_id = fd.parentID&quot; + _&#xA; &quot;		and fdo.diagram_id = fd.diagram_id&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = c.object_id&quot; + _&#xA; &quot;		and fo.object_id = {0}&quot; + _&#xA; &quot;  	and instr(fd.StyleEx,'MDGDgm=TFCS::')&gt;0&quot; + _&#xA; &quot;		and ucase(mid(fd.StyleEx,instr(fd.StyleEx,'MDGDgm=TFCS::')+13,instr(instr(fd.StyleEx,'MDGDgm=TFCS::'),fd.StyleEx,';')-instr(fd.StyleEx,'MDGDgm=TFCS::')-13)) = 'TFCS_FlowDiagram'&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagram dd&quot; + _&#xA; &quot;						,t_diagramobjects ddo &quot; + _&#xA; &quot;				where  dd.parentid = uc.parentid &quot; + _&#xA; &quot;					and ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and c.object_id = ddo.object_id) &quot;&#xA;&#xA;' Checks if for an instance of a classifier placed on a workflow -realisation- diagram an -instance of the&#xA;' classifier- existsts on the corresponding workflow -definition- as well&#xA;dim VAL_SQL_CNT_CLASSIFIERINST_MISSING_ON_DD : VAL_SQL_CNT_CLASSIFIERINST_MISSING_ON_DD = _&#xA; &quot;	select count(*) as RESULT&quot; + _&#xA; &quot;	from t_object uc&quot; + _&#xA; &quot;		,t_diagram fd&quot; + _&#xA; &quot;		,t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where uc.object_id = fd.parentID&quot; + _&#xA; &quot;		and fdo.diagram_id = fd.diagram_id&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = c.object_id&quot; + _&#xA; &quot;		and fo.object_id = {0}&quot; + _&#xA; &quot;  	and instr(fd.StyleEx,'MDGDgm=TFCS::')&gt;0&quot; + _&#xA; &quot;		and ucase(mid(fd.StyleEx,instr(fd.StyleEx,'MDGDgm=TFCS::')+13,instr(instr(fd.StyleEx,'MDGDgm=TFCS::'),fd.StyleEx,';')-instr(fd.StyleEx,'MDGDgm=TFCS::')-13)) = 'TFCS_FlowDiagram'&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagram dd&quot; + _&#xA; &quot;						,t_diagramobjects ddo &quot; + _&#xA; &quot;						,t_object do&quot; + _&#xA; &quot;				where  dd.parentid = uc.parentid &quot; + _&#xA; &quot;					and ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and do.object_id = ddo.object_id&quot; + _&#xA; &quot;					and do.classifier = c.object_id) &quot;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="209"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{24C0D6E9-51BC-47ed-9228-0BAE2E8AB014}"/>
			<Column name="ScriptAuthor" value="{95899319-791B-46bc-A6E6-A4122451DB62}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;EAST management&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;&#xA;'&#xA;' Register the scripts that contain handler methods for EA events&#xA;' Handler methods must have the name of the event they handle&#xA;' When several handler methods are registered for an event they will be&#xA;' called in sequence of registration&#xA;'&#xA;sub EAST_RegisterEventHandlers&#xA;	EAST.AddEventhandler(&quot;TFCS_MainMenu&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_ActionCommand&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_CreateUserWorkspace&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_CreateFromToolbox&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_CreateFromProjectBrowser&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_DeleteHandler&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_RulesForRelations&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_RulesForAOB&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_Modelvalidation&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_GenerateDocWFSpec&quot;)&#xA;	EAST.AddEventhandler(&quot;TFCS_GenerateDocContext&quot;)&#xA;&#xA;' Not very usefull: order of handlers&#xA;'	EAST.AddEventhandlerGroup(&quot;TFCS_EventHandlers&quot;)&#xA;end sub&#xA;&#xA;sub EAST_SetLocalPaths(DialogDir,DevDir)&#xA;	DialogDir = TFCSBASEDIR+&quot;/dialogs/&quot; 	' Location of custom dialogs for TFCS&#xA;	DevDir = TFCSBASEDIR+&quot;/dev&quot;				' Used by EAST in develop mode to dump files&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="210"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{84EA2356-F286-4018-B655-A59AF40E7244}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_RulesForRelations&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;' Prevent creation of relations between TFCS and non-TFCS elements&#xA;Function EA_OnPreNewConnector( Info ) &#xA;	EA_OnPreNewConnector = true&#xA;	&#xA;	dim client as EA.Element&#xA;	set client = Repository.GetElementByID(CInt(Info.Get(&quot;ClientID&quot;)))&#xA;	dim supplier as EA.Element&#xA;	set supplier = Repository.GetElementByID(CInt(Info.Get(&quot;SupplierID&quot;)))&#xA;	dim cltIsTFCS : cltIsTFCS = (Left(client.Stereotype,5) = &quot;TFCS_&quot;)&#xA;	dim suppIsTFCS : suppIsTFCS = (Left(supplier.Stereotype,5) = &quot;TFCS_&quot;)&#xA;&#xA;	if((cltIsTFCS and not suppIsTFCS) or (suppIsTFCS and not cltIsTFCS)) then&#xA;		dim cltType : cltType = client.Type&#xA;		dim suppType : suppType = supplier.Type&#xA;		if cltType = &quot;Artifact&quot; or cltType = &quot;Note&quot; _&#xA;				or cltType = &quot;Text&quot; or cltType = &quot;Constraint&quot; or cltType = &quot;Boundary&quot; _&#xA;			or suppType = &quot;Artifact&quot; or suppType = &quot;Note&quot; _&#xA;				or suppType = &quot;Text&quot; or suppType = &quot;Constraint&quot; or suppType = &quot;Boundary&quot; Then&#xA;			' all is well&#xA;		else&#xA;			EAST.MsgBox &quot;Relaties tussen '&quot;+client.Name+&quot;' en '&quot;+supplier.Name+&quot;' zijn niet toegestaan&quot;,16,&quot;Model validatiefout&quot;&#xA;			EA_OnPreNewConnector = false&#xA;		end if&#xA;	end if&#xA;end Function&#xA;&#xA;Function EA_OnPostNewConnector(Info) &#xA;	EA_OnPostNewConnector = false ' no update &#xA;	&#xA;	dim answer&#xA;	dim conn as EA.Connector&#xA;	set conn = GetConnectorByID(Info.Get(&quot;ConnectorID&quot;))&#xA;	if conn.Type = &quot;ControlFlow&quot; or conn.Type = &quot;ObjectFlow&quot; then&#xA;		answer = EAST.InputBox(&quot;Conditie: &quot;,&quot;Toevoegen nieuwe relatie&quot;)&#xA;		if answer = empty or answer = &quot;&quot; then&#xA;			exit function&#xA;		end if&#xA;		Repository.Execute(&quot;update t_connector set pdata2 = '&quot;&amp;answer&amp;&quot;' where connector_id = &quot;&amp;conn.ConnectorID)&#xA;		EA_OnPostNewConnector = true&#xA;	elseif conn.Type = &quot;Association&quot; or conn.Type = &quot;Generalization&quot;  or conn.Type = &quot;Aggregation&quot;  then&#xA;		answer = EAST.InputBox(&quot;Naam: &quot;,&quot;Toevoegen nieuwe relatie&quot;)&#xA;		if answer = empty or answer = &quot;&quot; then&#xA;			exit function&#xA;		end if&#xA;		conn.name = answer&#xA;		conn.Update()&#xA;		EA_OnPostNewConnector = true&#xA;	end if&#xA;end function"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="211"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{C9CFC9ED-7F79-445f-BF6D-F6461351A151}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_CreateUserWorkspace&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;&#xA;' Create the user workspace when it doesn't yet exist&#xA;Sub EA_FileOpen()&#xA;	if EAST.GetPackageByFQN(GEN__WORKSPACE+&quot;.&quot;+EAST.UserName()) is nothing then&#xA;		dim pck as EA.Package&#xA;		set pck = EAST.GetPackageByFQN(GEN__WORKSPACE+&quot;.&quot;+EAST.UserName(),true)&#xA;		dim dgm as EA.Diagram&#xA;		set dgm = pck.Diagrams.AddNew(&quot;&quot;,&quot;TFCS::TFCS_FlowsDiagram&quot;)&#xA;		dgm.Name = CUW_OVERVIEWDGMNAME&#xA;		dgm.update()&#xA;		set dgm = pck.Diagrams.AddNew(&quot;&quot;,&quot;TFCS::TFCS_DomainDiagram&quot;)&#xA;		dgm.Name = CUW_DOMAINDGMNAME&#xA;		dgm.update()&#xA;		set dgm = pck.Diagrams.AddNew (&quot;&quot;,&quot;TFCS::TFCS_RequirementsDiagram&quot;)&#xA;		dgm.Name = CUW_REQDGMNAME&#xA;		dgm.update()&#xA;		set dgm = pck.Diagrams.AddNew (&quot;&quot;,&quot;TFCS::TFCS_MaintenanceDiagram&quot;)&#xA;		dgm.Name = CUW_TBDDGMNAME&#xA;		dgm.update()&#xA;		pck.Diagrams.Refresh()&#xA;	end if&#xA;end sub"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="212"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{C5359E5F-41C6-4ea4-9FC6-A784F927D238}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_SQL&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Module containing all SQL statements used.&#xA;' SQL is grouped on referencing module and prefixed with part of the name of that module to prevent name clashes&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' =============================================================================&#xA;' TFCS_ModelValidation&#xA;' =============================================================================&#xA;' Since there are quite a few: left in (the head of) the script file&#xA;&#xA;' =============================================================================&#xA;' TFCS_DragDropHandler&#xA;' =============================================================================&#xA;dim SQL_GET_DIAGRAMOBJECT_RECT : SQL_GET_DIAGRAMOBJECT_RECT = _&#xA;	&quot;select rectleft,recttop,rectright,rectbottom from t_diagramobjects where diagram_id = {0} and object_id = {1}&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_DeleteHandler&#xA;' =============================================================================&#xA;const DELH_SQL_DGMOBJS = &quot;select count(*) as RESULT from t_diagramobjects where object_id = {0}&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_DocumentGeneration&#xA;' =============================================================================&#xA;&#xA;' Returns all diagrams behind composite steps&#xA;Dim DOCGEN_SQL_DGM_COMPLEXSTEPS: DOCGEN_SQL_DGM_COMPLEXSTEPS = _&#xA;&quot; select d.diagram_id, d.ea_guid,o.name &quot; &amp;_&#xA;&quot; from t_diagram p, t_diagramobjects do&quot; &amp;_&#xA;&quot;	 ,t_object o&quot; &amp;_&#xA;&quot;	 ,t_object c&quot; &amp;_&#xA;&quot;	 ,t_diagram d&quot; &amp;_&#xA;&quot; where p.ea_guid = '{0}' and p.diagram_id = do.diagram_id&quot; &amp;_&#xA;&quot;	 and do.object_id = o.object_id&quot; &amp;_&#xA;&quot;	 and o.classifier = c.object_id&quot; &amp;_&#xA;&quot;	 and o.stereotype = 'TFCS_CompositeAction'&quot; &amp;_&#xA;&quot;	 and d.parentid = c.object_id&quot;&#xA;&#xA;' Returns all diagrams that contain a specific object (element)&#xA;Dim DOCGEN_SQL_DIAGRAMSWITHELT: DOCGEN_SQL_DIAGRAMSWITHELT = _&#xA;&quot; select d.ea_guid as EA_GUID&quot; &amp;_&#xA;&quot;    ,d.diagram_id as ID&quot; &amp;_&#xA;&quot; from t_diagram d&quot; &amp;_&#xA;&quot;	 ,t_diagramobjects do&quot; &amp;_&#xA;&quot;	 ,t_object o&quot; &amp;_&#xA;&quot; where d.diagram_id = do.diagram_id&quot; &amp;_&#xA;&quot;	 and do.object_id = o.object_id&quot; &amp;_&#xA;&quot;	 and o.ea_guid = '{0}' order by d.name&quot;&#xA;&#xA;' Returns all diagrams that contain a specific object (element) -as classifier-&#xA;dim DOCGEN_SQL_DIAGRAMSWITHELTASCLASSIFIER: DOCGEN_SQL_DIAGRAMSWITHELTASCLASSIFIER = _&#xA;&quot; select d.ea_guid as EA_GUID&quot; &amp;_&#xA;&quot;    ,d.diagram_id as ID&quot; &amp;_&#xA;&quot; from t_diagram d&quot; &amp;_&#xA;&quot;	 ,t_diagramobjects do&quot; &amp;_&#xA;&quot;	 ,t_object o, t_object c&quot; &amp;_&#xA;&quot; where d.diagram_id = do.diagram_id&quot; &amp;_&#xA;&quot;	 and do.object_id = o.object_id and o.classifier = c.object_id&quot; &amp;_&#xA;&quot;	 and c.ea_guid = '{0}' order by  d.name&quot;&#xA;&#xA;' Returns all elements (either notes or plain text) that are contained in boundary with name 'Toelichting'&#xA;Dim DOCGEN_SQL_DGM_REMARKSFORDGM: DOCGEN_SQL_DGM_REMARKSFORDGM = _&#xA;&quot; select tlo.object_id &quot; &amp;_&#xA;&quot; from t_diagram d&quot; &amp;_&#xA;&quot;		,t_diagramobjects do&quot; &amp;_&#xA;&quot;		,t_object o&quot; &amp;_&#xA;&quot;		,t_diagramobjects tl&quot; &amp;_&#xA;&quot;		,t_object tlo&quot; &amp;_&#xA;&quot; where  tlo.object_id = tl.Object_ID&quot; &amp;_&#xA;&quot;		and tl.diagram_id = d.diagram_id&quot; &amp;_&#xA;&quot;		and o.object_id = do.object_id&quot; &amp;_&#xA;&quot;		and do.diagram_id = d.diagram_id&quot; &amp;_&#xA;&quot;		and ucase(o.Name) = 'TOELICHTING' and o.object_type = 'Boundary'&quot; &amp;_&#xA;&quot;		and tlo.object_type in ('Note','Text')&quot; &amp;_&#xA;&quot;		and tl.RectTop &lt;= do.RectTop &quot; &amp;_&#xA;&quot;		and tl.RectLeft &gt;= do.RectLeft&quot; &amp;_&#xA;&quot;		and tl.RectRight &lt;= do.RectRight&quot; &amp;_&#xA;&quot;		and tl.RectBottom &gt;= do.RectBottom&quot; &amp;_&#xA;&quot;		and d.ea_guid = '{0}'&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_Commons&#xA;' =============================================================================&#xA;const SQL_GET_OBJECTPROPERTIES = &quot;select XRefID,description as RESULT from t_xref where description like '@PROP*' and client='{0}'&quot;&#xA;const SQL_UPD_OBJECTPROPERTIES = &quot;update t_xref set description = '{1}' where XRefID = '{0}'&quot;&#xA;dim SQL_INS_OBJECTPROPERTIES: SQL_INS_OBJECTPROPERTIES = &quot;insert into t_xref &quot;&amp;_&#xA;		&quot; (XRefID,name,type,visibility,partition,description,client,supplier)&quot; &amp;_&#xA;		&quot; values ('{0}','CustomProperties', 'element property', 'Public', 0, &quot; &amp;_&#xA;		&quot; '@PROP=@NAME={2}@ENDNAME;@TYPE={3}@ENDTYPE;@VALU={4}@ENDVALU;@PRMT={5}@ENDPRMT;@ENDPROP;', &quot;&amp;_&#xA;		&quot; '{1}','&lt;none&gt;')&quot;&#xA;		&#xA;dim COMM_SQL_DGMSBYSTEREO : COMM_SQL_DGMSBYSTEREO = _&#xA;  &quot; select IIF(ISNULL(pck4.name),IIF(ISNULL(pck3.name),IIF(ISNULL(pck2.name),&quot; _&#xA;+ &quot;IIF(ISNULL(pck1.name),pck0.name,pck1.name) ,pck2.name) ,pck3.name),pck4.name) &quot;+&quot;as&quot;+&quot; model &quot; _&#xA;+ &quot; , d.name &quot; _&#xA;+ &quot; , d.ea_guid &quot; _&#xA;+ &quot; from ((((((t_diagram d  ) &quot; _&#xA;+ &quot; inner join t_package pck0 on d.package_id = pck0.package_id) &quot; _&#xA;+ &quot; left join t_package pck1 on pck1.package_id = pck0.parent_id) &quot; _&#xA;+ &quot; left join t_package pck2 on pck2.package_id = pck1.parent_id) &quot; _&#xA;+ &quot; left join t_package pck3 on pck3.package_id = pck2.parent_id) &quot; _&#xA;+ &quot; left join t_package pck4 on pck4.package_id = pck3.parent_id) &quot; _&#xA;+ &quot; where d.StyleEx like '*MDGDgm=TFCS::{0}*' &quot; _&#xA;+ &quot; order by IIF(ISNULL(pck4.name),IIF(ISNULL(pck3.name),IIF(ISNULL(pck2.name),&quot; _&#xA;+ &quot;IIF(ISNULL(pck1.name),pck0.name,pck1.name) ,pck2.name) ,pck3.name),pck4.name), d.name&quot;&#xA;dim COMM_SQL_ELTSBYSTEREO_AND_TAG : COMM_SQL_ELTSBYSTEREO_AND_TAG = _&#xA;  &quot; select IIF(ISNULL(pck4.name),IIF(ISNULL(pck3.name),IIF(ISNULL(pck2.name),&quot; _&#xA;+ &quot;IIF(ISNULL(pck1.name),pck0.name,pck1.name) ,pck2.name) ,pck3.name),pck4.name) &quot;+&quot;as model &quot; _&#xA;+ &quot; , tv.value &quot; _&#xA;+ &quot; , o.name &quot; _&#xA;+ &quot; , o.ea_guid &quot; _&#xA;+ &quot; from ((((((t_object o inner join t_objectproperties tv on tv.object_id = o.object_id  ) &quot; _&#xA;+ &quot; inner join t_package pck0 on o.package_id = pck0.package_id) &quot; _&#xA;+ &quot; left join t_package pck1 on pck1.package_id = pck0.parent_id) &quot; _&#xA;+ &quot; left join t_package pck2 on pck2.package_id = pck1.parent_id) &quot; _&#xA;+ &quot; left join t_package pck3 on pck3.package_id = pck2.parent_id) &quot; _&#xA;+ &quot; left join t_package pck4 on pck4.package_id = pck3.parent_id) &quot; _&#xA;+ &quot; where ucase(o.Stereotype) = ucase('{0}') &quot; _&#xA;+ &quot; 	and ucase(tv.property) = ucase('{1}') and ucase('{2}') like '*'+ucase(tv.value)+'*'&quot; _&#xA;+ &quot; order by IIF(ISNULL(pck4.name),IIF(ISNULL(pck3.name),IIF(ISNULL(pck2.name),&quot; _&#xA;+ &quot;IIF(ISNULL(pck1.name),pck0.name,pck1.name) ,pck2.name) ,pck3.name),pck4.name), tv.value, o.name&quot;&#xA;dim COMM_SQL_ELTSBYSTEREO : COMM_SQL_ELTSBYSTEREO = _&#xA;  &quot; select IIF(ISNULL(pck4.name),IIF(ISNULL(pck3.name),IIF(ISNULL(pck2.name),&quot; _&#xA;+ &quot;IIF(ISNULL(pck1.name),pck0.name,pck1.name) ,pck2.name) ,pck3.name),pck4.name) &quot;+&quot;as&quot;+&quot; model &quot; _&#xA;+ &quot; , o.name &quot; _&#xA;+ &quot; , o.ea_guid &quot; _&#xA;+ &quot; from ((((((t_object o  ) &quot; _&#xA;+ &quot; inner join t_package pck0 on o.package_id = pck0.package_id) &quot; _&#xA;+ &quot; left join t_package pck1 on pck1.package_id = pck0.parent_id) &quot; _&#xA;+ &quot; left join t_package pck2 on pck2.package_id = pck1.parent_id) &quot; _&#xA;+ &quot; left join t_package pck3 on pck3.package_id = pck2.parent_id) &quot; _&#xA;+ &quot; left join t_package pck4 on pck4.package_id = pck3.parent_id) &quot; _&#xA;+ &quot; where ucase('{0}') like '*'+ucase(o.Stereotype)+'*' and o.object_id &lt;&gt; {1}&quot; _&#xA;+ &quot; order by IIF(ISNULL(pck4.name),IIF(ISNULL(pck3.name),IIF(ISNULL(pck2.name),&quot; _&#xA;+ &quot;IIF(ISNULL(pck1.name),pck0.name,pck1.name) ,pck2.name) ,pck3.name),pck4.name), o.name&quot;&#xA;dim COMM_SQL_GETMODELS : COMM_SQL_GETMODELS = &quot;select name from t_package where parent_id = 0 and name &lt;&gt; 'TFCS' order by name&quot;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="213"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{51419FB0-CB16-481a-8494-B685DBFAB7A3}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_TEXTS&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Module containing all texts used throughout TFCS -that are visible to the enduser- &#xA;' Texts are grouped on the referencing module and prefixed with a module identifier to prevent name clashes.&#xA;'&#xA;' NOTE: some texts are/can be referenced by several modules (like eg workspace name), &#xA;' this is indicated by a the prefix GEN with double underscore&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' =============================================================================&#xA;' TFCS_ModelValidation&#xA;' =============================================================================&#xA;const VAL_NO_RELATIONS_ALLOWED = &quot;Dit element mag geen enkele relatie met andere elementen hebben. Leg de relatie op een andere manier.&quot;&#xA;const VAL_ACT_ON_DGM = &quot;Mag op geen enkel diagram voorkomen. Verwijder deze (als deze onderdeel vormt van een workflow: plaats deze vervolgens als stap (scherm/complex of subflow).&quot;&#xA;const VAL_ISSUE_NOT_REALISED = &quot;Issue is nergens aan gerelateerd. Koppel deze aan het(de) modelelement(en) waarop deze betrekking heeft.&quot;&#xA;const VAL_REQ_NOT_REALISED = &quot;Requirement is niet gerealiseerd. Koppel de model element(en) die in deze requirement voorzien.&quot; &#xA;const VAL_UNKNOWN_STEREOTYPE = &quot;Dit stereotype wordt nog niet gevalideerd: {0}. Neem contact op met de beheerder van TFCS.&quot;&#xA;const VAL_ACTOR_UNUSED = &quot;Actor is bij geen enkele workflow betrokken. Koppel de actor aan ten minste EEN workflow.&quot;&#xA;const VAL_ELT_NOT_USED = &quot;Domein instance wordt niet gebruikt. Neem deze op in een workflow of workflow definitie en koppel deze.&quot;&#xA;const VAL_ELT_NOT_ON_DIAGRAM = &quot;Het element is niet opgenomen in een diagram van type {0}.&quot;&#xA;const VAL_WF_NOT_ON_UCDEFDGM = &quot;Workflow is in geen enkele workflow specificatie opgenomen ({0}).&quot;&#xA;const VAL_WF_NOT_ON_UCDGM = &quot;Workflow is in geen enkel workflow overzicht opgenomen ({0}).&quot;&#xA;const VAL_ACTOR_NOT_ON_UCDEFDGM = &quot;Actor is in geen enkele workflow specificatie opgenomen.&quot;&#xA;const VAL_ACTOR_NOT_ON_UCDGM = &quot;Actor is in geen enkel workflow overzicht opgenomen.&quot;&#xA;const VAL_MULTIPLE_STEREOTYPES = &quot;Dit element heeft meerdere stereotypen ({0}), dit is niet toegestaan. Zorg ervoor dat het element een enkel stereotype heeft.&quot;&#xA;const VAL_ELT_NOT_PART_OF_FLOW = &quot;Element maakt geen deel uit van een workflow. Neem het element in een workflow op.&quot;&#xA;const VAL_COMP_IN_COMP = &quot;Opgenomen in een diagram van een ander scherm of component. Een component of scherm mag zelf geen verdere verdiepingen bevatten.&quot;&#xA;const VAL_WF_ISON_DIAGRAM = &quot;Dit element mag niet in een diagram worden opgenomen. Vervang deze door een bijbehorende stap (workflow).&quot;&#xA;const VAL_MISSING_WFDEFN_DIAGRAM = &quot;Dit element moet precies 1 diagram bevatten en dit moet een workflowdefinitie diagram zijn.&quot;&#xA;const VAL_MISSING_WF_DIAGRAM = &quot;Dit element moet precies 1 diagram bevatten en dit moet een workflowrealisatie diagram zijn.&quot;&#xA;const VAL_DOMRULE_NOT_REALISED = &quot;Domeinregel is aan geen enkel domeinobject gerelateerd.&quot;&#xA;const VAL_ELT_ON_INVALID_DGM = &quot;Element bevind zich op een diagram waar dit niet thuis hoort &quot;&#xA;const VAL_INVALID_SUBFLOW = &quot;Een workflow mag alleen subflows van eenzelfde of lager niveau bevatten, dus bv een werkinstructie mag geen bedrijfsproces als stap bevatten.&quot;&#xA;const VAL_WF_IS_NOT_USED = &quot;Deze workflow wordt niet gebruikt. Als deze workflow het hoogste niveau is dan zal dit kloppen, neem anders de workflow als subflow op binnen een andere workflow.&quot;&#xA;const VAL_COMP_IS_NOT_USED = &quot;Deze component wordt niet gebruikt. Neem  de component op als stap in een of meer workflows.&quot;&#xA;const VAL_AI_IS_NOT_USED = &quot;Dit autorisatieitem is nog niet gebruikt. Koppel deze aan de te autoriseren handelingen/gegevens.&quot;&#xA;const VAL_WFTYPETAG_MISSING = &quot;Tag 'WorkflowType' ontbreekt of heeft een ongeldige waarde (waarde moet zijn een van {0})&quot;&#xA;const VAL_WFTYPETAG_DIFFERS = &quot;Niveau van de stap wijkt af van dat van de subflow (WorkflowType is {0} ipv {1}). Verwijder de stap en plaats deze opnieuw.&quot;&#xA;const VAL_WF_MISSING_UCELT = &quot;De naam van dit element moet gelijk zijn aan de naam van de use case ({0})&quot;&#xA;const VAL_INVALID_WF_EXTENSION = &quot;De workflow mag alleen extenden van een workflow van hetzelfde niveau ({0})&quot;&#xA;const VAL_REVERSED_CONNECTOR = &quot;Een relatie van type 'Destination -&gt; Source' is niet toegestaan. Verwijder de relatie en leg deze opnieuw.&quot;&#xA;const VAL_PROGRAM_FAILURE = &quot;Er is een fout opgetreden in de validatie. Neem contact op met de beheerder van TFCS (fout in {0}).&quot;&#xA;const VAL_RELATION_NOT_VALID = &quot;Deze relatie is hier niet toegestaan ({0} van {1}({2}) -&gt; {3}({4})).&quot;&#xA;const VAL_RELATIONSTEREO_NOT_VALID = &quot;Stereotype van deze relatie is niet toegestaan {5}({0}) van {1}({2}) -&gt; {3}({4})). Verwijder de relatie en leg deze opnieuw.&quot;&#xA;const VAL_WF_ACT_NAMES_NOT_SAME = &quot;De naam van de workflow volgt niet de standaard. Controleer de naamgeving van de elementen in de projectbrowser bij deze workflow.&quot;&#xA;const VAL_UC_MISSING_FOR_WF = &quot;Het UC element ontbreekt of heeft niet dezelfde naam als de activity.&quot;&#xA;const VAL_SUBLOWS_NOT_ALLOWED = &quot;Een stap van type subflow is hier niet toegestaan.&quot;&#xA;const VAL_WFSTEP_INVALID_IN_WORKFLOW = &quot;Een stap van type '{0}' mag niet zijn opgenomen in een workflow van een type {1}.&quot;&#xA;const VAL_WFSTEP_INVALID_IN_COMPONENT = &quot;Een subflow mag alleen worden opgenomen in een andere workflow en niet in een scherm of component.&quot;&#xA;const VAL_NO_CLASSIFIERINST_ON_FLOWDEFDGM = &quot;Het domeinobject ontbreekt nog in de definitie van de workflow. Voeg deze daar nog toe.&quot;&#xA;const VAL_NO_CLASSIFIER_ON_FLOWDEFDGM = &quot;Het bijbehorende autorisatieitem ontbreekt nog in de definitie van de workflow. Voeg deze daar nog toe.&quot;&#xA;const VAL_INFO_ADDED_AI_TO_WFDEFN = &quot;Autorisatie is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_INFO_ADDED_REQ_TO_WFDEFN = &quot;Requirement is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_INFO_ADDED_ISSUE_TO_WFDEFN = &quot;Bevinding is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_INFO_ADDED_DO_TO_WFDEFN = &quot;Domeinobject is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_DGM_INVALID_PARENT = &quot;Plaats het diagram onder een element van een type '{0}'.&quot;&#xA;const VAL_INFO_ADDED_ELT_TO_WFDEFN = &quot;Gerelateerd element '{0}' toegevoegd aan dit diagram.&quot;&#xA;const VAL_INFO_ADDED_WF_TO_WFDEFN = &quot;Subflow '{0}' is ook toegevoegd aan de workflow definitie.&quot;&#xA;const VAL_ACTION_MISSING_CLASSIFIER = &quot;De workflow waarop deze stap is gebaseerd is verwijderd uit het model. Verwijder ook deze stap.&quot;&#xA;const VAL_COMP_MISSING_CLASSIFIER = &quot;De component of het scherm waarop deze stap is gebaseerd is verwijderd uit het model. Verwijder ook deze stap.&quot;&#xA;const VAL_AUT_MISSING_CLASSIFIER = &quot;De autorisatie wat dit effect heeft is verwijderd uit het model. Verwijder ook dit effect.&quot;&#xA;const VAL_DOMAIN_MISSING_CLASSIFIER = &quot;Het domeinobject is verwijderd uit het model. Verwijder deze ook hier.&quot;&#xA;const VAL_NON_TFCS_ELEMENT = &quot;Dit element mag niet gebruikt worden binnen TFCS. Als het niet gebruikt wordt verwijder het dan, anders vervang dit door een modelelement uit TFCS.&quot;&#xA;const VAL_NO_RELATIONS_ALLOWED_OFTYPE = &quot;Dit element mag geen relatie met andere elementen hebben van type {0}. Leg de relatie op een andere manier.&quot;&#xA;const VAL_ELT_ON_OTHER_DIAGRAM = &quot;Dit element is (ook) opgenomen op een ander diagram. Zorg ervoor dat dit element alleen is opgenomen in het diagram waarbij deze in de project browser is vastgelegd.&quot;&#xA;&#xA;' =============================================================================&#xA;' Menu items&#xA;' =============================================================================&#xA;const DOCGEN_OUTPUT_LOCATION = &quot;Selecteer de map voor de output bestanden.&quot;&#xA;const MNU_TFCSMAIN = &quot;-TFCS&quot; &#xA;const MNU_GENERATE_WFSPEC = &quot;Genereer workflow specificatie&quot;&#xA;const MNU_GENERATECONTEXTRTF = &quot;Genereer context document&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_Commons&#xA;' =============================================================================&#xA;const COMM_NEW_WORKFLOW = &quot;Nieuwe workflow&quot;&#xA;dim COMM_WORKSPACE_MISSING: COMM_WORKSPACE_MISSING = _&#xA;	&quot;Kon de workspace van de gebruiker niet vinden:&quot;+vbCRLF+vbCRLF+&quot;     {0}&quot;+vbCRLF+vbCRLF+&quot;Maak deze eerst aan&quot;+vbCRLF&#xA;&#xA;' =============================================================================&#xA;' TFCS_CreateUserWorkspace&#xA;' =============================================================================&#xA;const CUW_OVERVIEWDGMNAME = &quot;Workflow kladblok&quot;&#xA;const CUW_DOMAINDGMNAME = &quot;Domeinmodel kladblok&quot;&#xA;const CUW_REQDGMNAME = &quot;Requirements kladblok&quot;&#xA;const CUW_TBDDGMNAME = &quot;TODO lijst kladblok&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_CreateFromToolbox/TFCS_CreateFromProjectBrowser&#xA;' =============================================================================&#xA;' TFCS elementtype not allowed on TFCS diagram&#xA;const DDH_TITLE_NOTALL = &quot;TFCS Model validatie&quot;&#xA;dim DDH_PROMPT_USE_TOOLBOX : DDH_PROMPT_USE_TOOLBOX = &quot;Dit soort elementen kunnen alleen via de&quot;+ _&#xA;	vbCRLF+&quot; toolbox op dit diagram worden opgenomen&quot;&#xA;dim DDH_PROMT_NOTALL : DDH_PROMT_NOTALL = &quot;Dit element is niet toegestaan&quot;+vbCRLF+&quot;op {0} diagram&quot;&#xA;dim DDH_PROMPT_PBCR_NOTALLOWED : DDH_PROMPT_PBCR_NOTALLOWED = _&#xA;	&quot;Modelelementen mogen alleen via de toolbox&quot;+vbCRLF+&quot;bij een diagram worden aangemaakt.&quot;&#xA;const DDH_NOTALL_FLOWDEFDGM = &quot;een workflow definitie&quot;&#xA;const DDH_NOTALL_GENERICTYPE = &quot;dit type&quot;&#xA;const DDH_NOTALL_FLOWSDGM = &quot;een workflow overzicht&quot;&#xA;const DDH_NOTALL_FLOWDGM = &quot;een workflow realisatie&quot;&#xA;const DDH_NOTALL_DOMAINDGM = &quot;een domein&quot;&#xA;const DDH_NOTALL_REQDGM = &quot;een requirements&quot;&#xA;const DDH_NOTALL_MNTDGM = &quot;een beheer&quot;&#xA;&#xA;' TFCS element already present in diagram&#xA;dim DDH_PROMPT_ELTONDGM : DDH_PROMPT_ELTONDGM = &quot;Dit element is al opgenomen op dit diagram&quot;+vbCRLF+&quot;U kunt dit element maar 1x opnemen&quot;&#xA;const DDH_TITLE_ELTONDGM = &quot;TFCS Model validatie&quot;&#xA;&#xA;&#xA;' =============================================================================&#xA;' Can be/have been used in several modules &#xA;' =============================================================================&#xA;&#xA;' Location in private workspace to put new elements  &#xA;const GEN__WORKSPACE = &quot;Onderhanden&quot; &#xA;&#xA;const GEN__PCK_ACTORS = &quot;Actoren&quot;&#xA;const GEN__PCK_REQUIREMENTS = &quot;Requirements&quot;&#xA;const GEN__PCK_TODO = &quot;Nog oppakken&quot;&#xA;const GEN__PCK_DOMAIN = &quot;Domein&quot;&#xA;const GEN__PCK_SCREENS =&quot;Schermen&quot;&#xA;const GEN__PCK_COMPONENTS = &quot;Componenten&quot;&#xA;const GEN__PCK_AUTHORISATIONS =&quot;Authorisaties&quot;&#xA;const GEN__PCK_WORKFLOWS =&quot;Workflows&quot;&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="214"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{DB817121-A9DE-4388-821D-1F32B273F157}"/>
			<Column name="ScriptAuthor" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;Converteer Dolores UCs&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC Local Scripts.EAConstants-VBScript&#xA;!INC TFCS.TFCS Commons&#xA;&#xA;&#xA;'&#xA;' This code has been included from the default Project Browser template.&#xA;' If you wish to modify this template, it is located in the Config\Script Templates&#xA;' directory of your EA install path.   &#xA;'&#xA;' Script Name:&#xA;' Author:&#xA;' Purpose:&#xA;' Date:&#xA;'&#xA;&#xA;'&#xA;' Project Browser Script main function&#xA;'&#xA;sub OnProjectBrowserScript()&#xA;	&#xA;	' Get the type of element selected in the Project Browser&#xA;	dim treeSelectedType&#xA;	treeSelectedType = Repository.GetTreeSelectedItemType()&#xA;	&#xA;	' Handling Code: Uncomment any types you wish this script to support&#xA;	' NOTE: You can toggle comments on multiple lines that are currently&#xA;	' selected with [CTRL]+[SHIFT]+[C].&#xA;	select case treeSelectedType&#xA;	&#xA;'		case otElement&#xA;'			dim act as EA.Element&#xA;'			set act = Repository.GetTreeSelectedObject()&#xA;'			convertActivity(act)					&#xA;		case otPackage&#xA;			' Code for when a package is selected&#xA;'			convertDoloresUCs(Repository.GetTreeSelectedObject())&#xA;			convertUCStereotypes(Repository.GetTreeSelectedObject())&#xA;'		case otDiagram&#xA;'			' Code for when a diagram is selected&#xA;'			dim theDiagram as EA.Diagram&#xA;'			set theDiagram = Repository.GetTreeSelectedObject()&#xA;'			&#xA;'		case otAttribute&#xA;'			' Code for when an attribute is selected&#xA;'			dim theAttribute as EA.Attribute&#xA;'			set theAttribute = Repository.GetTreeSelectedObject()&#xA;'			&#xA;'		case otMethod&#xA;'			' Code for when a method is selected&#xA;'			dim theMethod as EA.Method&#xA;'			set theMethod = Repository.GetTreeSelectedObject()&#xA;		&#xA;		case else&#xA;			' Error message&#xA;			Session.Prompt &quot;This script does not support items of this type.&quot;, promptOK&#xA;			&#xA;	end select&#xA;	&#xA;	exit sub&#xA;	ErrHandler:&#xA;    '&#xA;end sub&#xA;&#xA;sub convertActivity(theAct)&#xA;	dim act as EA.Element&#xA;	set act = theAct&#xA;	dim dgm as EA.Diagram&#xA;	act.Stereotype = &quot;TFCS_Activity&quot;&#xA;	set dgm = act.CompositeDiagram&#xA;&#xA;'			on error resume next&#xA;'			dgm.ApplyUserLock()&#xA;'			if err.number&lt;&gt; 0 then&#xA;'				Msgbox dgm.GetLastError(),0,err.Description&#xA;'				exit sub&#xA;'			end if&#xA;	&#xA;	Repository.execute(&quot;update t_diagram&quot;&amp;_&#xA;		&quot; set pdata='HideRel=0;ShowTags=0;ShowReqs=0;ShowCons=0;OpParams=1;ShowSN=0;&quot;&amp;_&#xA;		&quot;ScalePI=0;PPgs.cx=0;PPgs.cy=0;PSize=9;ShowIcons=1;SuppCN=0;HideProps=0;&quot;&amp;_&#xA;		&quot;HideParents=0;UseAlias=0;HideAtts=0;HideOps=0;HideStereo=0;HideEStereo=1;FormName=;'&quot;&amp;_&#xA;		&quot; where diagram_id = &quot;&amp;dgm.DiagramID)&#xA;	Repository.execute(&quot;update t_diagram&quot;&amp;_&#xA;		&quot; set styleex='ExcludeRTF=0;DocAll=0;HideQuals=0;AttPkg=1;ShowTests=0;ShowMaint=0;&quot;&amp;_&#xA;		&quot;SuppressFOC=1;MatrixActive=0;SwimlanesActive=1;MatrixLineWidth=1;MatrixLocked=0;&quot;&amp;_&#xA;		&quot;TConnectorNotation=UML 2.1;TExplicitNavigability=0;AdvancedElementProps=1;&quot;&amp;_&#xA;		&quot;AdvancedFeatureProps=1;AdvancedConnectorProps=1;ProfileData=;MDGDgm=TFCS::TFCS_FlowDefnDiagram;&quot;&amp;_&#xA;		&quot;STBLDgm=;ShowNotes=0;VisibleAttributeDetail=0;ShowOpRetType=1;SuppressBrackets=0;&quot;&amp;_&#xA;		&quot;SuppConnectorLabels=0;PrintPageHeadFoot=0;ShowAsList=0;SuppressedCompartments=;'&quot;&amp;_&#xA;		&quot; where diagram_id = &quot;&amp;dgm.DiagramID)&#xA;	convertElements(act)&#xA;	&#xA;	Repository.AdviseElementChange(act.ElementID)&#xA;	&#xA;	&#xA;	MsgBox dgm.Name,0,&quot;Updated&quot;&#xA;	&#xA;	act.Update()&#xA;&#xA;end sub&#xA;&#xA;sub convertUCStereotypes(pck)&#xA;	Dim sRes&#xA;	dim SQL&#xA;	dim thePackage as EA.Package&#xA;	Set thePackage = pck&#xA;	&#xA;	Dim row, dict &#xA;	Dim args(1)&#xA;	args(0) = thePackage.PackageID&#xA;	Set dict = ExecuteSQL( _&#xA;		&quot;select o.ea_guid, o.Name from t_object o, t_package c, t_package p &quot;+_&#xA;		&quot;where o.object_type = 'Usecase'  &quot;+_&#xA;		&quot;and o.package_id = c.package_id and c.parent_id = p.package_id &quot;+_&#xA;		&quot;and p.package_id = {0} and c.name &lt;&gt; 'oud' order by o.name&quot;,args)&#xA;	if not dict.exists(SQLERROR) then&#xA;		for each row in dict.Items&#xA;				Dim uc as EA.Element&#xA;				dim ucSpec as EA.Diagram&#xA;				Set uc = Repository.GetElementByGuid(row.item(&quot;EA_GUID&quot;))&#xA;				if uc.Stereotype = &quot;TFCS_WorkFlow&quot; then&#xA;					Session.output(&quot;Converteren van UC: &quot;&amp; uc.Name&amp;&quot; - &quot;&amp;uc.Stereotype)&#xA;					set ucSpec = ucActivity.CompositeDiagram&#xA;					if ucSpec.Stereotype = &quot;TFCS_FlowDefnDiagram&quot; then&#xA;					ucSpec.Name = &quot;UC-&quot;+answer&#xA;					ucSpec.Update()&#xA;					&#xA;'					uc.StereotypeEx = &quot;&quot;&#xA;'					uc.Stereotype = &quot;TFCS_WorkFlow&quot;&#xA;'					uc.Update()&#xA;				end if&#xA;		next&#xA;	else&#xA;		session.output(&quot;Woops: &quot;&amp;dict.item(SQLERROR))&#xA;	end if&#xA;end sub&#xA;&#xA;sub convertDoloresUCs(pck)&#xA;	&#xA;	Dim sRes&#xA;	dim SQL&#xA;	dim thePackage as EA.Package&#xA;	Set thePackage = pck&#xA;&#xA;	SQL = &quot;select ea_guid from t_object where object_type = 'Usecase' and parentid = 0 and package_id = &quot;&amp;thePackage.PackageID&amp;&quot; order by name&quot;&#xA;	sRes = Repository.SQLQuery(sql)&#xA;'			Session.output(&quot;Result: &quot;+sRes)&#xA;&#xA;	dim xmlDom&#xA;	set xmlDom = createobject(&quot;MSXML2.DOMDocument.4.0&quot;)&#xA;	xmlDOM.validateOnParse = false&#xA;	xmlDOM.async = false&#xA;&#xA;&#xA;	if xmlDom.loadXML(sRes) then&#xA;		Dim nodeList  &#xA;		Set nodeList = xmlDom.selectNodes(&quot;//Dataset_0/Data/Row/ea_guid&quot;)&#xA;		&#xA;		If nodeList.length = 0 Then&#xA;			MsgBox &quot;Geen usecases gevonden!?&quot;,0,&quot;Toevoegen stap door use case&quot;&#xA;			Exit Sub&#xA;		Else&#xA;			dim  i&#xA;			for i=0 to nodeList.length - 1&#xA;				Dim ucd as EA.Element&#xA;				Set ucd = Repository.GetElementByGuid(nodeList.item(i).text)&#xA;				dim answer&#xA;				answer = ucd.Name&#xA;				Session.output(&quot;Converteren van UC: &quot;&amp; ucd.Name)&#xA;				&#xA;					&#xA;				' UC package&#xA;				dim ucPackage as EA.Package&#xA;				set ucPackage = thePackage.packages.AddNew(&quot;UC-&quot;+answer, &quot;Class&quot; )&#xA;				ucPackage.Update()&#xA;				' Include Activity&#xA;				dim ucActivity as EA.Element&#xA;				set ucActivity = ucPackage.elements.AddNew(&quot;UC-&quot;+ answer, &quot;TFCS::TFCS_Activity&quot; )&#xA;				ucPackage.Elements.Refresh()&#xA;				' UC &amp; UC Spec diagram below activity&#xA;				dim ucSpec as EA.Diagram&#xA;				' Change the name of the UC definition diagram&#xA;				set ucSpec = ucActivity.CompositeDiagram&#xA;				ucSpec.Name = &quot;UC-&quot;+answer&#xA;				ucSpec.Update()&#xA;&#xA;				dim uc as EA.Element&#xA;				set uc = ucActivity.elements.AddNew( &quot;UC-&quot;+answer, &quot;TFCS::TFCS_WorkFlow&quot; )&#xA;				ucActivity.Elements.Refresh()&#xA;&#xA;				' Change the name of the UC realization diagram&#xA;				dim ucReal as EA.Diagram&#xA;				set ucReal = uc.CompositeDiagram&#xA;				ucReal.Name = &quot;UCR-&quot;+answer&#xA;				ucReal.Update()&#xA;				uc.Update()&#xA;				&#xA;				' Populate UC spec diagram&#xA;				' usecase element&#xA;				dim dgmObject as EA.DiagramObject&#xA;				dim dgmElement as EA.Element&#xA;				set dgmObject = ucSpec.diagramObjects.AddNew( &quot;l=331;t=416;r=436;b=486;&quot;, &quot;&quot; )&#xA;				dgmObject.ElementID( uc.ElementID )&#xA;				dgmObject.Update()&#xA;				&#xA;				' Diagramlabel&#xA;				set dgmElement = ucActivity.Elements.AddNew(&quot;&quot;,&quot;Text&quot;)&#xA;				dgmElement.Subtype = 18&#xA;				dgmElement.Update()&#xA;				set dgmObject = ucSpec.diagramObjects.AddNew( &quot;l=5;t=5;r=10;b=10;&quot;, &quot;&quot; )&#xA;				dgmObject.ElementID( dgmElement.ElementID )&#xA;				dgmObject.Update()&#xA;		&#xA;				' Notes&#xA;				set dgmObject = addPostIt(ucActivity,ucSpec,&quot;l=252;t=5;r=769;b=128;&quot;,ucd.Notes)&#xA;				dgmObject.Style = &quot;BCol=16249847;&quot;&#xA;				dgmObject.Update()&#xA;				addPostIt ucActivity,ucSpec,&quot;l=559;t=27;r=701;b=85;&quot;,&quot;&lt;b&gt;TODO&lt;/b&gt;: neem hier een korte beschrijving van de UC op&quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: platte tekst&quot;&#xA;				addPostIt ucActivity,ucSpec,&quot;l=256;r=564;t=819;b=885;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige requirements op waarin door deze UC wordt voorzien.&quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar autorisatieitems onder &lt;u&gt;\Requirements\...&lt;/u&gt;&lt;/font&gt;&quot;&#xA;				addPostIt ucActivity,ucSpec,&quot;l=30;t=799;r=186;b=927;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle autorisatie items op die binnen de UC worden gebruikt&quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar autorisatieitems onder &lt;font color='000ff'&gt;&lt;u&gt;\Requirements\Autorisaties&lt;/u&gt;&lt;/font&gt;&quot;&#xA;				addPostIt ucActivity,ucSpec,&quot;l=427;t=673;r=682;b=718;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige post-condities op&quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: platte tekst&quot;  &#xA;				addPostIt ucActivity,ucSpec,&quot;l=68;t=670;r=323;b=715;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige pre-condities op&lt;u&gt;&quot;+VbCrLf +&quot;Vorm&lt;/u&gt;: platte tekst&quot;&#xA;				addPostIt ucActivity,ucSpec,&quot;l=537;t=404;r=761;b=498;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die door deze UC worden verwijderd, gewijzigd, of gecreeerd&quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot;&#xA;				addPostIt ucActivity,ucSpec,&quot;l=272;t=532;r=494;b=603;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die door deze UC worden gelezen&quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot; &#xA;				addPostIt ucActivity,ucSpec,&quot;l=41;t=409;r=220;b=493;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die input zijn voor deze UC&quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot;&#xA;				addPostIt ucActivity,ucSpec,&quot;l=177;t=289;r=589;b=368;&quot;,&quot;&lt;b&gt;TODO: &lt;/b&gt;neem hier alle extensie- en include- relaties op met andere UC-es.&quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: Links naar de betreffende UC-es onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Functioneel Ontwerp\Use cases&lt;/u&gt;&lt;/font&gt;&quot;+VbCrLf +VbCrLf +&quot;&lt;u&gt;Richtlijn&lt;/u&gt;: aan extended en included UC-es worden geen actoren gekoppeld (deze volgen impliciet uit het gebruik)&quot;&#xA;				addPostIt ucActivity,ucSpec,&quot;l=174;t=181;r=626;b=229;&quot;,&quot;&lt;b&gt;TODO: &lt;/b&gt;neem hier de relevante actoren op en koppel die aan de UC &quot;+VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar actoren onder &lt;font color='#0000ff'&gt;&lt;u&gt;\ProcesBeschrijvingen\Actoren&lt;/u&gt;&lt;/font&gt; met associatie met de UC&quot;&#xA;				&#xA;				' Boundaries&#xA;				addBoundary ucActivity,ucSpec,&quot;l=401;t=629;r=766;b=762;&quot;,&quot;Post-condities&quot; &#xA;				addBoundary ucActivity,ucSpec,&quot;l=22;t=769;r=197;b=1061;&quot;,&quot;Autorisaties&quot;&#xA;				addBoundary ucActivity,ucSpec,&quot;l=16;t=151;r=765;b=258;&quot;,&quot;Actoren&quot;&#xA;				addBoundary ucActivity,ucSpec,&quot;l=22;t=629;r=387;b=762;&quot;,&quot;Pre-condities&quot; &#xA;				addBoundary ucActivity,ucSpec,&quot;l=207;t=769;r=766;b=1061;&quot;,&quot;Requirements&quot;&#xA;				&#xA;				ucSpec.DiagramObjects.Refresh()&#xA;&#xA;				set dgmElement = uc.Elements.AddNew(&quot;&quot;,&quot;Note&quot;)&#xA;				dim scen as EA.Scenario&#xA;				dim descr&#xA;				dim j&#xA;				descr = &quot;&quot;&#xA;				for j=0 to ucd.Scenarios.Count - 1&#xA;					set scen = ucd.Scenarios.GetAt(j)&#xA;					descr = descr&amp; vbCrLf &amp; scen.Type&amp; vbCrLf &amp; vbCrLf &amp; scen.Notes&#xA;				next&#xA;				dgmElement.Notes = descr&#xA;				dgmElement.Update()&#xA;				&#xA;				set dgmObject = ucReal.diagramObjects.AddNew(&quot;l=10;t=10;r=800;b=100;&quot;,&quot;&quot;)&#xA;				dgmObject.ElementID = dgmElement.ElementID&#xA;				dgmObject.Update()&#xA;				ucReal.DiagramObjects.Refresh()&#xA;&#xA;			next&#xA;		End If&#xA;	else&#xA;	   ' Obtain the ParseError object&#xA;		Dim xPE &#xA;		Set xPE = xmlDom.parseError&#xA;		With xPE&#xA;			strErrText = &quot;Your XML Document failed to load&quot; &amp; _&#xA;				&quot;due the following error.&quot; &amp; vbCrLf &amp; _&#xA;				&quot;Error #: &quot; &amp; .errorCode &amp; &quot;: &quot; &amp; xPE.reason &amp; _&#xA;				&quot;Line #: &quot; &amp; .Line &amp; vbCrLf &amp; _&#xA;				&quot;Line Position: &quot; &amp; .linepos &amp; vbCrLf &amp; _&#xA;				&quot;Position In File: &quot; &amp; .filepos &amp; vbCrLf &amp; _&#xA;				&quot;Source Text: &quot; &amp; .srcText &amp; vbCrLf &amp; _&#xA;				&quot;Document URL: &quot; &amp; .url&#xA;		End With&#xA;		MsgBox strErrText,0,&quot;Toevoegen stap door use case&quot;&#xA;		exit sub&#xA;	end if&#xA;&#xA;end sub&#xA;&#xA;sub convertElements(theElt)&#xA;&#xA;	dim elt as EA.Element&#xA;	dim elts as EA.Collection&#xA;	&#xA;	set elts = theElt.Elements&#xA;	&#xA;	dim i&#xA;	for i = 0 to elts.Count-1&#xA;		set elt = elts.GetAt(i)&#xA;		dim eltType&#xA;		eltType = elt.type&#xA;'		Session.Output(&quot;Element: &quot;+elt.Name+&quot;(&quot;+elt.Type+&quot;)&quot;)&#xA;		if eltType = &quot;UseCase&quot; then&#xA;			elt.Stereotype = &quot;TFCS_WorkFlow&quot;&#xA;			dim dgm as EA.Diagram&#xA;			set dgm = elt.CompositeDiagram&#xA;&#xA;			on error resume next&#xA;			dgm.ApplyUserLock()&#xA;			if err.number&lt;&gt; 0 then&#xA;				Msgbox dgm.GetLastError(),0,err.Description&#xA;				exit sub&#xA;			end if&#xA;			&#xA;			Repository.execute(&quot;update t_diagram&quot;&amp;_&#xA;				&quot; set pdata='HideRel=0;ShowTags=0;ShowReqs=0;ShowCons=0;OpParams=1;ShowSN=0;&quot;&amp;_&#xA;				&quot;ScalePI=0;PPgs.cx=0;PPgs.cy=0;PSize=9;ShowIcons=1;SuppCN=0;HideProps=0;&quot;&amp;_&#xA;				&quot;HideParents=0;UseAlias=0;HideAtts=0;HideOps=0;HideStereo=0;HideEStereo=1;FormName=;'&quot;&amp;_&#xA;				&quot; where diagram_id = &quot;&amp;dgm.DiagramID)&#xA;			Repository.execute(&quot;update t_diagram&quot;&amp;_&#xA;				&quot; set styleex='ExcludeRTF=0;DocAll=0;HideQuals=0;AttPkg=1;ShowTests=0;ShowMaint=0;&quot;&amp;_&#xA;				&quot;SuppressFOC=1;MatrixActive=0;SwimlanesActive=1;MatrixLineWidth=1;MatrixLocked=0;&quot;&amp;_&#xA;				&quot;TConnectorNotation=UML 2.1;TExplicitNavigability=0;AdvancedElementProps=1;&quot;&amp;_&#xA;				&quot;AdvancedFeatureProps=1;AdvancedConnectorProps=1;ProfileData=;MDGDgm=TFCS::TFCS_FlowDiagram;&quot;&amp;_&#xA;				&quot;STBLDgm=;ShowNotes=0;VisibleAttributeDetail=0;ShowOpRetType=1;SuppressBrackets=0;&quot;&amp;_&#xA;				&quot;SuppConnectorLabels=0;PrintPageHeadFoot=0;ShowAsList=0;SuppressedCompartments=;'&quot;&amp;_&#xA;				&quot; where diagram_id = &quot;&amp;dgm.DiagramID)&#xA;			convertElements(elt)&#xA;&#xA;		elseif eltType = &quot;Object&quot; then&#xA;'			elt.stereotype = &quot;TFCS_Object&quot;&#xA;		elseif eltType = &quot;Action&quot; then&#xA;			dim res&#xA;			res = SQLQueryString(&quot;select Description as found from t_xref where Client = '&quot;+elt.ElementGUID+&quot;' and Description = '@PROP=@NAME=kind@ENDNAME;@TYPE=ActionKind@ENDTYPE;@VALU=CallBehavior@ENDVALU;@PRMT=@ENDPRMT;@ENDPROP;'&quot;) &#xA;			if res &lt;&gt; &quot;&quot; then&#xA;				elt.Stereotype = &quot;TFCS_Action&quot;&#xA;			else&#xA;				elt.Stereotype = &quot;TFCS_AtomicAction&quot;&#xA;			end if&#xA;		elseif eltType = &quot;MergeNode&quot; then&#xA;			elt.stereotype = &quot;TFCS_MergeNode&quot;&#xA;		end if&#xA;		elt.Update()&#xA;	next &#xA;	&#xA;end sub&#xA;&#xA;' execute query returning named string found&#xA;function SQLQueryString(sql)&#xA;	dim sRes&#xA;	sRes = Repository.SQLQuery(sql)&#xA;&#xA;	dim xmlDom&#xA;	set xmlDom = createobject(&quot;MSXML2.DOMDocument.4.0&quot;)&#xA;	xmlDOM.validateOnParse = false&#xA;	xmlDOM.async = false&#xA;&#xA;	if xmlDom.loadXML(sRes) then&#xA;		Dim nodeList  &#xA;		Set nodeList = xmlDom.selectNodes(&quot;//Dataset_0/Data/Row/found&quot;)&#xA;		&#xA;		If nodeList.length &lt;&gt; 1 Then&#xA;			SQLQueryString = &quot;&quot;&#xA;		Else&#xA;			SQLQueryString = nodeList.item(0).text&#xA;		end if&#xA;	else&#xA;		SQLQueryString = &quot;&quot;&#xA;	end if&#xA;end function&#xA;&#xA;OnProjectBrowserScript&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="215"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{E4A591D7-648A-42d7-A919-4FBDE94D62C2}"/>
			<Column name="ScriptAuthor" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_DragDropHandlerOnPre&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Creation of new elements on diagrams, or drag-n-drop of existing elements:&#xA;' - allows the user to select an element from a list of available elements for the type&#xA;' - when the element does not yet exist the user gets the opportunity to create and select it&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;!INC TFCS_Support.TFCS_WorkflowCreation&#xA;&#xA;dim refreshDiagram&#xA;Function EA_OnPreNewElement( Info ) &#xA;	refreshDiagram = false&#xA;	EA_OnPreNewElement = HandleDropElement(Info,nothing)&#xA;	if refreshDiagram then&#xA;		dim dgmID: dgmID = Info.get(&quot;DiagramID&quot;).value&#xA;		if dgmID &lt;&gt; 0 then&#xA;'			SaveDiagram(dgmID)&#xA;			ReloadDiagram(dgmID)&#xA;		end if&#xA;	end if&#xA;end function&#xA;&#xA;Function EA_OnPreNewDiagramObject( Info ) &#xA;	refreshDiagram = false&#xA;	dim ID : ID = Info.get(&quot;ID&quot;).Value&#xA;	dim eltType : eltType = Info.Get(&quot;Type&quot;).Value&#xA;	dim eltDropped : set eltDropped = nothing&#xA;	if ID &lt;&gt; 0 then&#xA;		if eltType = &quot;Package&quot; then&#xA;			set eltDropped = GetPackageByID(ID)&#xA;		elseif eltType = &quot;Diagram&quot; then&#xA;			set eltDropped = GetDiagramByID(ID)&#xA;		else&#xA;			set eltDropped = GetElementByID(ID)&#xA;		end if&#xA;	end if&#xA;	&#xA;	EA_OnPreNewDiagramObject = HandleDropElement(Info,eltDropped)&#xA;	if refreshDiagram then&#xA;		dim dgmID: dgmID = Info.get(&quot;DiagramID&quot;).value&#xA;		if dgmID &lt;&gt; 0 then&#xA;'			SaveDiagram(dgmID)&#xA;			ReloadDiagram(dgmID)&#xA;		end if&#xA;	end if&#xA;end Function&#xA;&#xA;function HandleDropElement(info,eltDropped)&#xA;	HandleDropElement = true&#xA;&#xA;	' Only handle drops on TFCS diagrams&#xA;	dim dgmID: dgmID = CInt(Info.Get(&quot;DiagramID&quot;))&#xA;	if(dgmID = 0) then exit function end if&#xA;	dim dgm : Set dgm = Repository.GetDiagramByID(dgmID)&#xA;	dim dgmStereo : dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;	if Left(dgmStereo,4) &lt;&gt; &quot;TFCS&quot; then	&#xA;		EAST.LogInfo(&quot;Diagram is non-TFCS =&gt; OK&quot;)&#xA;		exit function &#xA;	end if&#xA;&#xA;	' Validation strategy: disallow the drop, -unless- ....&#xA;	HandleDropElement = false&#xA;	dim eltStereo : eltStereo = Info.Get(&quot;Stereotype&quot;).Value&#xA;	dim elt: set elt = nothing&#xA;	if eltStereo = &quot;&quot; or Left(eltStereo,4) &lt;&gt; &quot;TFCS&quot; then&#xA;		' Handle drop of non-TFCS elements&#xA;		dim eltType : eltType = Info.Get(&quot;Type&quot;).Value&#xA;		if eltType = &quot;Artifact&quot; _&#xA;			or eltType = &quot;Note&quot; _&#xA;			or eltType = &quot;Text&quot; _&#xA;			or eltType = &quot;Constraint&quot; _&#xA;			or eltType = &quot;Boundary&quot; Then&#xA;			' Allowed (fall-through to next event handler)&#xA;			EAST.LogInfo(&quot;Drop of artifact,note,text,constraint,boundaries on TFCS dgm =&gt; OK&quot;)&#xA;			HandleDropElement = true&#xA;		elseif eltType = &quot;&quot; then&#xA;			EAST.LogWarning(&quot;Inserting new element: elementtype missing (maybe copy-paste?) =&gt; silently ignored&quot;)&#xA;		else&#xA;			EAST.LogInfo(&quot;Non-TFCS element '&quot;+eltType+&quot;' drop on TFCS diagram '&quot;+dgmStereo+&quot;' =&gt; not allowed &quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;		end if&#xA;	else&#xA;		' Handle drop of TFCS elements/stereotypes&#xA;		' How a drop is handled depends on the specific element - diagram combination&#xA;		if (dgmStereo = &quot;TFCS::TFCS_FlowsDiagram&quot;) then&#xA;			set elt = HandleDropOnFlowsDgm(dgm,eltStereo,eltDropped)&#xA;			if elt is nothing then exit function end if&#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_FlowDefnDiagram&quot;) then&#xA;			set elt = HandleDropOnFlowDefnDgm(dgm,eltStereo,eltDropped)&#xA;			if elt is nothing then exit function end if&#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_FlowDiagram&quot;) then&#xA;			set elt = HandleDropOnFlowDgm(dgm,eltStereo,eltDropped)&#xA;			if elt is nothing then exit function end if&#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_DomainDiagram&quot;) then&#xA;			set elt = HandleDropOnDomainDgm(dgm,eltStereo,eltDropped)&#xA;			if elt is nothing then exit function end if&#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_RequirementsDiagram&quot;) then&#xA;			set elt = HandleDropOnReqDgm(dgm,eltStereo,eltDropped)&#xA;			if elt is nothing then exit function end if&#xA;		elseif (dgmStereo = &quot;TFCS::TFCS_MaintenanceDiagram&quot;) then&#xA;			set elt = HandleDropOnMntDgm(dgm,eltStereo,eltDropped)&#xA;			if elt is nothing then exit function end if&#xA;		else&#xA;			EAST.LogWarning(&quot;Drops on TFCS diagram type '&quot;+dgmStereo+&quot;' not yet defined =&gt; not allowed&quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;			exit function&#xA;		end if&#xA;&#xA;		' Only get here if drop is handled &amp; allowed&#xA;		if ObjectIsOnDiagram(elt.ElementID,dgm) then&#xA;			EAST.LogInfo(&quot;Object already on diagram =&gt; not allowed&quot;)&#xA;			EAST.MsgBox DDH_PROMPT_ELTONDGM,16,DDH_TITLE_ELTONDGM&#xA;		else&#xA;			dim thedgm as EA.Diagram&#xA;			dim obj: set obj=addEltToDiagram(elt,dgm,200,200)&#xA;			dgm.SelectedObjects.addnew obj.ElementID,obj.ElementID &#xA;			refreshDiagram = true&#xA;		end if&#xA;	end if&#xA;end Function&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Handlers for specific TFCS diagrams&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;function HandleDropOnFlowsDgm(dgm,eltStereo,eltDropped)&#xA;	set HandleDropOnFlowsDgm = nothing&#xA;	&#xA;	dim elt: set elt = eltDropped&#xA;	if eltStereo = &quot;TFCS_Actor&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,&quot;Actor&quot;,GEN__PCK_ACTORS)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Workflow&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectWorkflow(dgm,&quot;UseCase,WerkInstructie,BedrijfsProces&quot;,&quot;&quot;)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Requirement&quot; _&#xA;		or eltStereo = &quot;TFCS_NFR&quot; _&#xA;		or eltStereo = &quot;TFCS_Legislation&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_REQUIREMENTS)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Issue&quot; _&#xA;		or eltStereo = &quot;TFCS_Request&quot; _&#xA;		or eltStereo = &quot;TFCS_TBD&quot; _&#xA;		or eltStereo = &quot;TFCS_Ambiguity&quot; _&#xA;		or eltStereo = &quot;TFCS_ReviewComment&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_TODO)&#xA;		end if&#xA;	else&#xA;		EAST.LogInfo(&quot;HandleDropOnFlowsDgm: not allowed &quot;)&#xA;		EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWSDGM),16,DDH_TITLE_NOTALL&#xA;		set elt = nothing&#xA;	end if&#xA;	&#xA;	set HandleDropOnFlowsDgm = elt&#xA;end function&#xA;&#xA;function HandleDropOnFlowDefnDgm(dgm,eltStereo,eltDropped)&#xA;	set HandleDropOnFlowDefnDgm = nothing&#xA;&#xA;	dim elt: set elt = eltDropped&#xA;	if eltStereo = &quot;TFCS_Actor&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,&quot;Actor&quot;,GEN__PCK_ACTORS)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Workflow&quot; then&#xA;		if elt is nothing then&#xA;			dim wfAct : set wfAct = Repository.GetElementByID(dgm.ParentID)&#xA;			dim wfUC : Set wfUC = wfAct.Elements.GetByName(wfAct.Name)&#xA;			dim defaultType : defaultType = GetTagValByName(wfUC.TaggedValues,&quot;WorkflowType&quot;)&#xA;			set elt = SelectWorkflow(dgm,defaultType,defaultType)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_DomainObject&quot; then&#xA;		set elt = CreateDomainInstance(dgm,elt)&#xA;	elseif eltStereo = &quot;TFCS_Requirement&quot; _&#xA;		or eltStereo = &quot;TFCS_NFR&quot; _&#xA;		or eltStereo = &quot;TFCS_Legislation&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_REQUIREMENTS )&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Issue&quot; _&#xA;		or eltStereo = &quot;TFCS_Request&quot; _&#xA;		or eltStereo = &quot;TFCS_TBD&quot; _&#xA;		or eltStereo = &quot;TFCS_Ambiguity&quot; _&#xA;		or eltStereo = &quot;TFCS_ReviewComment&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_TODO)&#xA;		end if&#xA;	else&#xA;		EAST.LogInfo(&quot;HandleDropOnFlowDefnDgm: not allowed &quot;)&#xA;		EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDEFDGM),16,DDH_TITLE_NOTALL&#xA;		set elt = nothing&#xA;	end if&#xA;	&#xA;	set HandleDropOnFlowDefnDgm = elt&#xA;end function&#xA;&#xA;function HandleDropOnFlowDgm(dgm,eltStereo,eltDropped)&#xA;	set HandleDropOnFlowDgm = nothing&#xA;	&#xA;	dim elt: set elt = eltDropped&#xA;	if eltStereo = &quot;TFCS_Workflow&quot; then&#xA;		set elt = CreateWorkflowInstance( dgm,elt)&#xA;	elseif eltStereo = &quot;TFCS_Authorisation&quot; then&#xA;		set elt = CreateAuthorisationEffect(dgm,elt)&#xA;	elseif eltStereo = &quot;TFCS_CompositeActivity&quot; then&#xA;		set elt = CreateCompActionInstance(dgm,elt,&quot;Component&quot;)&#xA;	elseif eltStereo = &quot;TFCS_DomainObject&quot; then&#xA;		set elt = CreateDomainInstance(dgm,elt)&#xA;	elseif eltStereo = &quot;TFCS_DomainRule&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram( dgm,eltStereo,&quot;Domeinregel&quot;,GEN__PCK_DOMAIN)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Sketch&quot; then&#xA;		if elt is nothing then&#xA;			set elt = CreateCompActionInstance( dgm,elt,&quot;Schermvoorbeeld&quot;)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_GUI&quot; then&#xA;		set elt = CreateCompActionInstance( dgm,elt,&quot;Scherm&quot;)&#xA;	elseif eltStereo = &quot;TFCS_Requirement&quot; _&#xA;		or eltStereo = &quot;TFCS_NFR&quot; _&#xA;		or eltStereo = &quot;TFCS_Legislation&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_REQUIREMENTS )&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Issue&quot; _&#xA;		or eltStereo = &quot;TFCS_Request&quot; _&#xA;		or eltStereo = &quot;TFCS_TBD&quot; _&#xA;		or eltStereo = &quot;TFCS_Ambiguity&quot; _&#xA;		or eltStereo = &quot;TFCS_ReviewComment&quot;  then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_TODO)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_ActivityInitial&quot; _&#xA;			or eltStereo = &quot;TFCS_ActivityFinal&quot; _&#xA;			or eltStereo = &quot;TFCS_AtomicAction&quot; _&#xA;			or eltStereo = &quot;TFCS_IntermediateResult&quot; _&#xA;			or eltStereo = &quot;TFCS_Decision&quot; _&#xA;			or eltStereo = &quot;TFCS_MergeNode&quot; _&#xA;			or eltStereo = &quot;TFCS_Event&quot; then&#xA;		&#xA;		if elt is nothing then&#xA;			set elt = AddNewElement(dgm,eltStereo)&#xA;		end if&#xA;	else&#xA;		EAST.LogInfo(&quot;HandleDropOnFlowDgm: not allowed &quot;)&#xA;		EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDGM),16,DDH_TITLE_NOTALL&#xA;		set elt = nothing&#xA;	end if&#xA;&#xA;	set HandleDropOnFlowDgm = elt&#xA;end function&#xA;&#xA;function HandleDropOnDomainDgm(dgm,eltStereo,eltDropped)&#xA;	set HandleDropOnDomainDgm = nothing&#xA;	&#xA;	dim elt: set elt = eltDropped&#xA;	if eltStereo = &quot;TFCS_DomainObject&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram( dgm,eltStereo,&quot;Domeinobject&quot;,GEN__PCK_DOMAIN)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_DomainRule&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram( dgm,eltStereo,&quot;Domeinregel&quot;,GEN__PCK_DOMAIN)&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Requirement&quot; _&#xA;		or eltStereo = &quot;TFCS_NFR&quot; _&#xA;		or eltStereo = &quot;TFCS_Legislation&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_REQUIREMENTS )&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Issue&quot; _&#xA;		or eltStereo = &quot;TFCS_Request&quot; _&#xA;		or eltStereo = &quot;TFCS_TBD&quot; _&#xA;		or eltStereo = &quot;TFCS_Ambiguity&quot; _&#xA;		or eltStereo = &quot;TFCS_ReviewComment&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_TODO)&#xA;		end if&#xA;	else&#xA;		EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_DOMAINDGM),16,DDH_TITLE_NOTALL&#xA;		set elt = nothing&#xA;	end if&#xA;&#xA;	set HandleDropOnDomainDgm = elt&#xA;end function&#xA;&#xA;function HandleDropOnReqDgm(dgm,eltStereo,eltDropped)&#xA;	set HandleDropOnReqDgm = nothing&#xA;	&#xA;	dim elt: set elt = eltDropped&#xA;	if eltStereo = &quot;TFCS_Requirement&quot; _&#xA;		or eltStereo = &quot;TFCS_NFR&quot; _&#xA;		or eltStereo = &quot;TFCS_Legislation&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_REQUIREMENTS )&#xA;		end if&#xA;	elseif eltStereo = &quot;TFCS_Authorisation&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_AUTHORISATIONS )&#xA;		end if&#xA;	else&#xA;		EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_REQDGM),16,DDH_TITLE_NOTALL&#xA;		set elt = nothing&#xA;	end if&#xA;&#xA;	set HandleDropOnReqDgm = elt&#xA;end function&#xA;&#xA;function HandleDropOnMntDgm(dgm,eltStereo,eltDropped)&#xA;	set HandleDropOnMntDgm = nothing&#xA;	&#xA;	dim elt: set elt = eltDropped&#xA;	if eltStereo = &quot;TFCS_Issue&quot; _&#xA;		or eltStereo = &quot;TFCS_Request&quot; _&#xA;		or eltStereo = &quot;TFCS_TBD&quot; _&#xA;		or eltStereo = &quot;TFCS_Ambiguity&quot; _&#xA;		or eltStereo = &quot;TFCS_ReviewComment&quot; then&#xA;		if elt is nothing then&#xA;			set elt = SelectElementForDropOnDiagram(dgm,eltStereo,Mid(eltStereo,6),GEN__PCK_TODO)&#xA;		end if&#xA;	else&#xA;		EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_MNTDGM),16,DDH_TITLE_NOTALL&#xA;		set elt = nothing&#xA;	end if&#xA;	&#xA;	set HandleDropOnMntDgm = elt&#xA;end function&#xA;&#xA;' Create a composite action instance in the model to be placed on a diagram&#xA;function CreateCompActionInstance(dgm,eltDropped,compositeActionType)&#xA;	set CreateCompActionInstance = nothing&#xA;&#xA;	dim classifier&#xA;	if eltDropped is nothing then&#xA;		if (compositeActionType = &quot;Scherm&quot;) then&#xA;			set classifier = SelectElementForDropOnDiagram(dgm,&quot;TFCS_GUI&quot;,&quot;Scherm&quot;,GEN__PCK_SCREENS)&#xA;		elseif (compositeActionType = &quot;Schermvoorbeeld&quot;) then&#xA;			set classifier = SelectElementForDropOnDiagram(dgm,&quot;TFCS_GUI&quot;,&quot;Schermvoorbeeld&quot;,GEN__PCK_SCREENS )&#xA;		elseif (compositeActionType = &quot;Component&quot;) then&#xA;			set classifier = SelectElementForDropOnDiagram(dgm,&quot;TFCS_CompositeActivity&quot;,&quot;Component&quot;,GEN__PCK_COMPONENTS)&#xA;		else&#xA;			EAST.MsgBox &quot;Unsopperted composite action type: &quot;+compositeActionType,16,&quot;Creating composite activity&quot;&#xA;			exit function&#xA;		end if&#xA;		if classifier is nothing then exit function end if&#xA;	else&#xA;		set classifier = eltDropped&#xA;	end if&#xA;&#xA;	' Create the composite action for the selected/created activity&#xA;	dim elt: set elt = GetElementByID(dgm.ParentID).Elements.AddNew(&quot;&quot;,&quot;TFCS::TFCS_CompositeAction&quot;)&#xA;	elt.ClassifierID = classifier.ElementID&#xA;	elt.ClassifierName = classifier.Name&#xA;	SetTagValByName elt.TaggedValues,&quot;CompositeActionType&quot;,compositeActionType,&quot;&quot;&#xA;	elt.Update()&#xA;&#xA;	' Set the behaviour (not supported by 9.3 API)&#xA;	Repository.Execute(EAST.StrRep(&quot;insert into t_xref &quot;&amp;_&#xA;		&quot; (XRefID,name,type,visibility,partition,description,client,supplier)&quot; &amp;_&#xA;		&quot; values ('{0}','CustomProperties', 'element property', 'Public', 0, &quot; &amp;_&#xA;		&quot; '@PROP=@NAME=kind@ENDNAME;@TYPE=ActionKind@ENDTYPE;@VALU=CallBehavior@ENDVALU;@PRMT=@ENDPRMT;@ENDPROP;', &quot;&amp;_&#xA;		&quot; '{1}','&lt;none&gt;')&quot;,EAST.GenerateGUID()+&quot;|&quot;+elt.ElementGUID))&#xA;&#xA;	set CreateCompActionInstance = elt&#xA;end function&#xA;&#xA;' Create a domainobject instance in the model to be placed on a diagram&#xA;function CreateDomainInstance(dgm,eltDropped)&#xA;	set CreateDomainInstance = nothing&#xA;&#xA;	dim classifier&#xA;	if eltDropped is nothing then&#xA;		set classifier = SelectElementForDropOnDiagram(dgm,&quot;TFCS_DomainObject&quot;,&quot;Domeinobject&quot;,GEN__PCK_DOMAIN)&#xA;		if classifier is nothing then exit function end if&#xA;	else&#xA;		set classifier = eltDropped&#xA;	end if&#xA;	&#xA;	dim elt: set elt = GetElementByID(dgm.ParentID).Elements.AddNew(&quot;&quot;,&quot;TFCS::TFCS_DomainInstance&quot;)&#xA;	elt.ClassifierID = classifier.ElementID&#xA;	elt.ClassifierName = classifier.Name&#xA;	elt.Update()&#xA;&#xA;	set CreateDomainInstance = elt&#xA;end function&#xA;&#xA;' Create an authorisation instance in the model to be placed on a diagram&#xA;function CreateAuthorisationEffect(dgm,eltDropped)&#xA;	set CreateAuthorisationEffect = nothing&#xA;	&#xA;	dim classifier &#xA;	if eltDropped is nothing then&#xA;		set classifier = SelectElementForDropOnDiagram(dgm,&quot;TFCS_Authorisation&quot;,&quot;Authorisatie&quot;,GEN__PCK_AUTHORISATIONS)&#xA;		if classifier is nothing then exit function end if&#xA;	else&#xA;		set classifier = eltDropped&#xA;	end if&#xA;&#xA;	dim elt: set elt = GetElementByID(dgm.ParentID).Elements.AddNew(&quot;&quot;,&quot;TFCS::TFCS_AuthorisationEffect&quot;)&#xA;	elt.ClassifierID = classifier.ElementID&#xA;	elt.ClassifierName = classifier.Name&#xA;	elt.Update()&#xA;&#xA;	set CreateAuthorisationEffect = elt&#xA;end function&#xA;&#xA;' Create an workflow instance in the model to be placed on a diagram&#xA;function CreateWorkflowInstance(dgm,eltDropped)&#xA;	set CreateWorkflowInstance = nothing&#xA;&#xA;	dim wf&#xA;	if eltDropped is nothing then&#xA;		dim wfUC : set wfUC = Repository.GetElementByID(dgm.ParentID)&#xA;		dim defaultType : defaultType = GetTagValByName(wfUC.TaggedValues,&quot;WorkflowType&quot;)&#xA;		dim allowedTypes : allowedTypes = defaultType&#xA;		if defaultType = &quot;BedrijfsProces&quot; then&#xA;			allowedTypes = &quot;UseCase,WerkInstructie,BedrijfsProces&quot;&#xA;		elseif defaultType = &quot;WerkInstructie&quot; then&#xA;			allowedTypes = &quot;UseCase,WerkInstructie&quot;&#xA;		end if&#xA;		set wf = SelectWorkflow(dgm,allowedTypes,defaultType)&#xA;		if wf is nothing then exit function end if&#xA;	else&#xA;		set wf = eltDropped&#xA;	end if&#xA;	&#xA;	dim classifier: set classifier = GetElementByID(wf.ParentID)&#xA;	dim flowType : flowType = GetTagValByName(wf.TaggedValues,&quot;WorkflowType&quot;)&#xA;	dim elt: set elt = GetElementByID(dgm.ParentID).Elements.AddNew(&quot;&quot;,&quot;TFCS::TFCS_Action&quot;)&#xA;	elt.ClassifierID = classifier.ElementID&#xA;	elt.ClassifierName = classifier.Name&#xA;	SetTagValByName elt.TaggedValues,&quot;WorkflowType&quot;,flowtype,&quot;&quot;&#xA;	elt.Update()&#xA;&#xA;	' Set the behaviour (nbot supported by 9.3 API)&#xA;	Repository.Execute(EAST.StrRep(&quot;insert into t_xref &quot;&amp;_&#xA;		&quot; (XRefID,name,type,visibility,partition,description,client,supplier)&quot; &amp;_&#xA;		&quot; values ('{0}','CustomProperties', 'element property', 'Public', 0, &quot; &amp;_&#xA;		&quot; '@PROP=@NAME=kind@ENDNAME;@TYPE=ActionKind@ENDTYPE;@VALU=CallBehavior@ENDVALU;@PRMT=@ENDPRMT;@ENDPROP;', &quot;&amp;_&#xA;		&quot; '{1}','&lt;none&gt;')&quot;,EAST.GenerateGUID()+&quot;|&quot;+elt.ElementGUID))&#xA;		&#xA;	set CreateWorkflowInstance = elt&#xA;end function&#xA;&#xA;' Create a workflow in the model to be placed on a diagram&#xA;function SelectWorkflow(dgm,tagValues,dfltTagValue)&#xA;	EAST.LogStart(&quot;SelectWorkflow&quot;)&#xA;	set SelectWorkflow = nothing&#xA;&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;&#xA;	' Let the user select one of the existing UC-es or create a new one.&#xA;	dim userSelection : userSelection = SelectElementTagFromTree( _&#xA;		&quot;Selecteer een workflow&quot;,&quot;TFCS_Workflow&quot;, _&#xA;		&quot;WorkflowType&quot;,tagValues,model.Name,dfltTagValue,True)&#xA;	if userSelection = &quot;&quot;  then exit function end if&#xA;	&#xA;	dim uc, ucActivity&#xA;	if left(userSelection,3) = &quot;NEW&quot; then&#xA;		' User opted to create a new workflow =&gt; userselection is in format: NEW&lt;model&gt;.&lt;workflowtype&gt;)&#xA;		dim pos : pos=InStrRev(userSelection,&quot;.&quot;)&#xA;		dim dropFlowType : dropFlowType = Mid(userSelection,pos+1)&#xA;		dim modelName : modelName= Mid(userSelection,4,pos-4)&#xA;		Set ucActivity = CreateWorkFlowForModel(dgm,dropFlowType,getWorkflowPrefix(dropFlowType),modelName)&#xA;		if ucActivity is nothing then exit function end if&#xA;		Set SelectWorkflow = ucActivity.Elements.GetByName(ucActivity.Name)&#xA;	else					&#xA;		' User selected existing workflow&#xA;		set SelectWorkflow = GetElementByGUID(userSelection)&#xA;	end if&#xA;	EAST.LogEnd(&quot;SelectWorkflow&quot;)&#xA;end function&#xA;&#xA;function AddNewElement(dgm, eltStereo)&#xA;	set AddNewElement = nothing&#xA;	&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;	dim answer&#xA;	&#xA;	' Create standard stereotyped element. For some types this  is a bit convoluted.&#xA;	dim elt: set elt = nothing&#xA;	dim parent: set parent = GetElementByID(dgm.ParentID)&#xA;	if eltStereo = &quot;TFCS_ActivityInitial&quot; then&#xA;		set elt = parent.Elements.AddNew(&quot;&quot;,&quot;StateNode&quot;)&#xA;		elt.Subtype = 100 &#xA;		elt.Stereotype = &quot;TFCS_ActivityInitial&quot;&#xA;		elt.Name = &quot;&quot;&#xA;		parent.Elements.Refresh()&#xA;		elt.Update()&#xA;	elseif eltStereo = &quot;TFCS_ActivityFinal&quot; then&#xA;		set elt = parent.Elements.AddNew(&quot;&quot;,&quot;StateNode&quot;)&#xA;		elt.Subtype = 101 &#xA;		elt.Stereotype = &quot;TFCS_ActivityFinal&quot;&#xA;		elt.Name = &quot;&quot;&#xA;		parent.Elements.Refresh()&#xA;		elt.Update()&#xA;	elseif eltStereo = &quot;TFCS_Event&quot; then&#xA;		answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuw event&quot;,&quot;Mijn event&quot;)&#xA;		if answer = empty or answer = &quot;&quot; then exit function end if&#xA;		set elt = parent.Elements.AddNew(&quot;&quot;,&quot;Event&quot;)&#xA;		elt.Subtype = 1 &#xA;		elt.Stereotype = &quot;TFCS_Event&quot;&#xA;		elt.Name = answer&#xA;		parent.Elements.Refresh()&#xA;		elt.Update()&#xA;	elseif eltStereo = &quot;TFCS_Actor&quot; then&#xA;		answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuwe actor&quot;,&quot;Mijn actor&quot;)&#xA;		if answer = empty or answer = &quot;&quot; then exit function end if&#xA;		dim thePackage : set thePackage = GetPrivatePackage(model.Name,GEN__PCK_ACTORS)&#xA;		set elt = thePackage.elements.AddNew(&quot;&quot;, &quot;Actor&quot; )&#xA;		elt.Stereotype = &quot;TFCS_Actor&quot;&#xA;		elt.Name = answer&#xA;		thePackage.Elements.Refresh()&#xA;		elt.Update()&#xA;	elseif eltStereo = &quot;TFCS_IntermediateResult&quot; then&#xA;		answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuw tussenresultaat&quot;,&quot;Mijn tussenresultaat&quot;)&#xA;		if answer = empty or answer = &quot;&quot; then exit function end if&#xA;		set elt = parent.elements.AddNew(&quot;&quot;, &quot;TFCS::&quot;+eltStereo ) &#xA;		elt.Name = answer&#xA;		parent.Elements.Refresh()&#xA;		elt.Update()&#xA;	elseif eltStereo = &quot;TFCS_AtomicAction&quot; then&#xA;		answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuwe stap&quot;,&quot;Mijn stap&quot;)&#xA;		if answer = empty or answer = &quot;&quot; then exit function end if&#xA;		set elt = parent.elements.AddNew(&quot;&quot;, &quot;TFCS::&quot;+eltStereo ) &#xA;		elt.Name = answer&#xA;		parent.Elements.Refresh()&#xA;		elt.Update()&#xA;	else&#xA;		' Remaining elements are all tied to the diagram so include them there...&#xA;		set elt = parent.elements.AddNew(&quot;&quot;, &quot;TFCS::&quot;+eltStereo ) &#xA;		elt.Name = &quot;&quot;&#xA;		parent.Elements.Refresh()&#xA;		elt.Update()&#xA;	end if&#xA;		&#xA;	set AddNewElement = elt&#xA;end function&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Let the user select/create an element to drop on the diagram&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;Function SelectElementForDropOnDiagram(dgm,stereotype,stereotypeName,packageName)&#xA;	set SelectElementForDropOnDiagram = nothing&#xA;	&#xA;	' In the selectiontree dialog, open the model the diagram belongs to &#xA;	' (this is most likely the model the user wishes to select/create elements in)&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;	&#xA;	' Let the use make his choice&#xA;	dim userSelection : userSelection = SelectElementFromTree( _&#xA;		&quot;Selecteer een &quot;+stereotypeName,stereotype,stereotypeName, _&#xA;		model.Name,True)&#xA;	if userSelection = &quot;&quot;  then exit function end if&#xA;	&#xA;	dim elt: set elt = nothing&#xA;	if left(userSelection,3) = &quot;NEW&quot; then&#xA;		' User opted to create a new element&#xA;		' userselection is in format: NEW&lt;model&gt;.&lt;element type&gt;)&#xA;		dim pos : pos=InStrRev(userSelection,&quot;.&quot;)&#xA;		dim modelName : modelName= Mid(userSelection,4,pos-4)&#xA;		&#xA;		' Create the element&#xA;		dim thePackage as EA.Package&#xA;		set thePackage = GetPrivatePackage(modelName,packageName)&#xA;&#xA;		' Get the name for the new element&#xA;		dim answer: answer = EAST.InputBox(&quot;Naam voor &quot;+stereotypeName+&quot; : &quot;,&quot;Toevoegen &quot;+stereotypeName,&quot;Mijn &quot;+stereotypeName)&#xA;		if answer = &quot;&quot; then exit function end if&#xA;		&#xA;		' Actors are created differently (?!)&#xA;		if stereotype = &quot;TFCS_Actor&quot; then&#xA;			set elt = thePackage.elements.AddNew(answer, &quot;Actor&quot; ) &#xA;			elt.Stereotype = &quot;TFCS_Actor&quot;&#xA;		else&#xA;			set elt = thePackage.elements.AddNew(answer, &quot;TFCS::&quot;+stereotype ) &#xA;		end if&#xA;		elt.Name = answer&#xA;		thePackage.Elements.Refresh()&#xA;		elt.Update()&#xA;&#xA;	else					&#xA;		' User selected existing &#xA;		set elt = GetElementByGUID(userSelection)&#xA;	end if&#xA;	&#xA;	Set SelectElementForDropOnDiagram = elt&#xA;end function&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="216"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{8AEAB418-600A-48bb-9A45-15C360C4006E}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="Incubation"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="217"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{6E20A32C-98AA-4179-96BB-21441431F437}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;PROJBROWSER&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="Incubation project browser"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="218"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{E5F9585B-2DD4-4445-B968-17D32A8DC25C}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_ModelValidation&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Executes TFCS model validations in response to project/model validation/validate selected&#xA;' NOTE: although these EA validation events are used the events are not acutally triggered directly by EA&#xA;'       as this seems to lead to instability ulitmately leading EA to crash. &#xA;' 		To work around this EAST provides a method ValidateItem that will walk the tree of the selected element&#xA;'		and trigger the expected event. Results are displayed in a seperate output screen 'TFCS Guidance'        &#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_Commons&#xA;!INC TFCS_Support.TFCS_VALSQL&#xA;&#xA;const MNU_VALIDATESELECTED = &quot;Controleer tegen TFCS regels&quot;&#xA;&#xA;' =================================================================================================&#xA;' Handlers for events of interest&#xA;' =================================================================================================&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	if MenuLocation = &quot;TreeView&quot; and MenuName = MNU_TFCSMAIN then&#xA;		EA_GetMenuItems = MNU_VALIDATESELECTED&#xA;	end if&#xA;end Function&#xA;&#xA;Sub EA_MenuClick( MenuName , ItemName )&#xA;	if Menuname = MNU_TFCSMAIN and ItemName = MNU_VALIDATESELECTED then&#xA;		' This will walk the tree below the selected elementy in the project browser.&#xA;		' For each element in the tree the appropriate callback 'EA_OnRunXXXRule' is called&#xA;		' Querying EAST.CheckSevere&#xA;		EAST.ValidateItem(GetTreeSelectedObject())&#xA;	end if&#xA;end sub&#xA;&#xA;' The tree is walked first to locate severe errors (CheckSevere = true), &#xA;' next for remaining errors (CheckSevere = false). OnRunXXXRule check the value to do the&#xA;' appropriate validations.&#xA;dim CheckSevere: CheckSevere = true&#xA;Sub EA_OnStartValidation(args())&#xA;	CheckSevere = EAST.CheckSevere()&#xA;end sub&#xA;&#xA;Sub EA_OnRunElementRule(RuleID,elt)&#xA;      EAST.LogInfo(&quot;****************** Validating... &quot;+elt.name+&quot; (&quot;+elt.stereotype+&quot;) ********************&quot;)&#xA;      if elt.Stereotype = &quot;&quot; or Left(elt.Stereotype,4) &lt;&gt; &quot;TFCS&quot; then&#xA;		' non-TFCS element found    &#xA;		dim eltType : eltType = elt.Type&#xA;		if eltType = &quot;Artifact&quot; _&#xA;			or eltType = &quot;Note&quot; _&#xA;			or eltType = &quot;Text&quot; _&#xA;			or eltType = &quot;Constraint&quot; _&#xA;			or eltType = &quot;Boundary&quot; _&#xA;			or eltType = &quot;Package&quot; _&#xA;			or eltType = &quot;UMLDiagram&quot; Then&#xA;			' Allowed (must match the list in TFCS_CreateFromToolbox)&#xA;		else&#xA;			if (checkSevere) then&#xA;				  PublishResult 1,VAL_NON_TFCS_ELEMENT&#xA;			end if&#xA;		end if&#xA;      else&#xA;		select case elt.Type&#xA;			case &quot;Issue&quot;&#xA;				ValidateIssue(elt)&#xA;			case &quot;Requirement&quot;&#xA;				if elt.Stereotype = &quot;TFCS_DomainRule&quot; then&#xA;					ValidateDomainRule(elt)&#xA;				elseif elt.Stereotype = &quot;TFCS_Authorisation&quot; then&#xA;					ValidateAutorisation(elt)&#xA;				else&#xA;					ValidateRequirement(elt)&#xA;				end if&#xA;			case else&#xA;				select case elt.Stereotype&#xA;					case &quot;TFCS_Activity&quot;					' container for specs relating to a workflow&#xA;						ValidateActivity(elt)&#xA;					case &quot;TFCS_GUI&quot;							' screen defn&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ACT_ON_DGM,&quot;''&quot; ' template, only allowed as classifier for elements on diagrams&#xA;							CheckHasNoRelationsOfType elt,3,VAL_NO_RELATIONS_ALLOWED_OFTYPE,&quot;'ControlFlow,ObjectFlow'&quot;&#xA;							CheckHasExactlyOneDiagram elt,3,VAL_MISSING_WF_DIAGRAM,&quot;TFCS_FlowDiagram&quot; &#xA;						else&#xA;							CheckUsedAsClassifier elt,1,VAL_COMP_IS_NOT_USED ' is the template used?&#xA;							CheckHasNoRelations elt,0,VAL_NO_RELATIONS_ALLOWED&#xA;						end if&#xA;					case &quot;TFCS_Workflow&quot;					' UC element for workflow, container for WF realisation&#xA;						if(CheckSevere)then&#xA;							CheckIsOnDiagram elt,3,VAL_WF_NOT_ON_UCDEFDGM,&quot;'TFCS_FlowDefnDiagram'&quot;&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDefnDiagram','TFCS_FlowsDiagram'&quot;&#xA;							CheckHasTagValueIn elt,3,VAL_WFTYPETAG_MISSING,&quot;WorkflowType&quot;,&quot;'UseCase','WerkInstructie','BedrijfsProces'&quot;&#xA;							CheckHasExactlyOneDiagram elt,3,VAL_MISSING_WF_DIAGRAM,&quot;TFCS_FlowDiagram&quot;&#xA;						else&#xA;							CheckWFExtendsSameLevelWF elt,0,VAL_INVALID_WF_EXTENSION&#xA;							CheckWFIsUsed elt,1,VAL_WF_IS_NOT_USED ' is the activity acting as template for this workflow used?&#xA;							CheckIsOnDiagram elt,2,VAL_WF_NOT_ON_UCDGM,&quot;'TFCS_FlowsDiagram'&quot;&#xA;						end if&#xA;					case &quot;TFCS_CompositeActivity&quot;			' Component definition&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ACT_ON_DGM,&quot;''&quot; ' template, only allowed as classifier for elements on diagrams&#xA;							CheckHasNoRelations elt,3,VAL_NO_RELATIONS_ALLOWED&#xA;							CheckHasNoRelationsOfType elt,3,VAL_NO_RELATIONS_ALLOWED_OFTYPE,&quot;'ControlFlow,ObjectFlow'&quot;&#xA;							CheckHasExactlyOneDiagram elt,3,VAL_MISSING_WF_DIAGRAM,&quot;TFCS_FlowDiagram&quot;&#xA;						else&#xA;							CheckUsedAsClassifier elt,1,VAL_COMP_IS_NOT_USED ' is the template used?&#xA;						end if&#xA;					case &quot;TFCS_Actor&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowsDiagram','TFCS_FlowDefnDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,1,VAL_ACTOR_NOT_ON_UCDEFDGM,&quot;'TFCS_FlowDefnDiagram'&quot;&#xA;							CheckIsOnDiagram elt,2,VAL_ACTOR_NOT_ON_UCDGM,&quot;'TFCS_FlowsDiagram'&quot;&#xA;							CheckReferences elt,1,VAL_ACTOR_UNUSED,&quot;'UseCase'&quot;,&quot;''&quot;&#xA;						end if&#xA;					case &quot;TFCS_DomainObject&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_DomainDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,1,VAL_ELT_NOT_ON_DIAGRAM,&quot;'TFCS_DomainDiagram'&quot;&#xA;						end if&#xA;					case &quot;TFCS_DomainInstance&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram','TFCS_FlowDefnDiagram'&quot;&#xA;						else&#xA;							CheckHasClassifier elt,3,VAL_DOMAIN_MISSING_CLASSIFIER&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM,&quot;'TFCS_FlowDiagram','TFCS_FlowDefnDiagram'&quot;&#xA;							CheckHasRelation elt,1,VAL_ELT_NOT_USED,&quot;'ControlFlow,ObjectFlow,Dependency'&quot;,&quot;''&quot;&#xA;							CheckClassifierInstanceIsOnWFDefDiagram  elt,0,VAL_NO_CLASSIFIERINST_ON_FLOWDEFDGM ' note: reverse is not required&#xA;						end if&#xA;					case &quot;TFCS_AuthorisationEffect&quot;&#xA;						if(CheckSevere)then&#xA;							CheckHasClassifier elt,3,VAL_AUT_MISSING_CLASSIFIER&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram','TFCS_FlowDefnDiagram'&quot;&#xA;							CheckHasNoRelationsOfType elt,3,VAL_NO_RELATIONS_ALLOWED_OFTYPE,&quot;'ControlFlow,ObjectFlow'&quot;&#xA;						else&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case &quot;TFCS_Action&quot;&#xA;						if(CheckSevere)then&#xA;							CheckHasClassifier elt,3,VAL_ACTION_MISSING_CLASSIFIER&#xA;							CheckHasTagValueIn elt,3,VAL_WFTYPETAG_MISSING,&quot;WorkflowType&quot;,&quot;'UseCase','WerkInstructie','BedrijfsProces'&quot;&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckWFStepNotInLowerWorkflow elt,3,VAL_WFSTEP_INVALID_IN_WORKFLOW&#xA;							CheckWFStepNotInComponent elt,3,VAL_WFSTEP_INVALID_IN_COMPONENT&#xA;						else&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;							CheckHasRelation elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckActionTagSameAsWF elt&#xA;						end if&#xA;					case &quot;TFCS_AtomicAction&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckHasRelation elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case &quot;TFCS_CompositeAction&quot;&#xA;						if(CheckSevere)then&#xA;							CheckHasClassifier elt,3,VAL_COMP_MISSING_CLASSIFIER&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckHasRelation elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case &quot;TFCS_ActivityInitial&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckReferences elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case &quot;TFCS_ActivityFinal&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckReferencedBy elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case &quot;TFCS_Decision&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckHasRelation elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case &quot;TFCS_MergeNode&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckHasRelation elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case &quot;TFCS_Event&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckReferences elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case &quot;TFCS_IntermediateResult&quot;&#xA;						if(CheckSevere)then&#xA;							CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;'TFCS_FlowDiagram'&quot;&#xA;						else&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;'TFCS_FlowDiagram'&quot;&#xA;							CheckHasRelation elt,1,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;						end if&#xA;					case else&#xA;						' Stereotype missing in model validation!	&#xA;						PublishResult 3,EAST.StrRep(VAL_UNKNOWN_STEREOTYPE,elt.stereotype)&#xA;				end select&#xA;		end select&#xA;	end if&#xA;end sub&#xA;&#xA;Sub EA_OnRunDiagramRule(RuleID,DiagramID)&#xA;' - check for allowed elements are allowed elements&#xA;' - ucdef: includes must match the subflow actions on real dgm&#xA;' - ucdef: actors must match the actual related actors&#xA;	dim dgm as EA.Diagram&#xA;	set dgm = GetDiagramByID(DiagramID)&#xA;	dim dgmStereo: dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;) &#xA;	if dgmStereo = &quot;&quot; or Left(dgmStereo,4) &lt;&gt; &quot;TFCS&quot; then &#xA;		' non-TFCS =&gt; not interested&#xA;		exit sub &#xA;	end if&#xA;	&#xA;	EAST.LogInfo(&quot;****************** Validating... &quot;+dgm.name+&quot; (&quot;+dgmStereo+&quot;) ********************&quot;)&#xA;	select case dgmStereo&#xA;		case &quot;TFCS::TFCS_FlowDiagram&quot;&#xA;			if(CheckSevere)then&#xA;				CheckDiagramHasParent dgm,&quot;'TFCS_Workflow','TFCS_GUI','TFCS_CompositeActivity'&quot;&#xA;				&#xA;				' not a rule but automatic synhronisation of flowdefinition dgm with flow realisation dgm&#xA;				SynchronizeWFDefWithFlow(dgm)&#xA;			else&#xA;				' none defined&#xA;			end if&#xA;		case &quot;TFCS::TFCS_FlowDefnDiagram&quot;&#xA;			if(CheckSevere)then&#xA;				CheckDiagramHasParent dgm,&quot;'TFCS_Activity'&quot;&#xA;&#xA;				' not a rule but automatic synhronisation of flowdefinition dgm with missing model relations&#xA;				SynchronizeWFDefWithModel(dgm)&#xA;			else&#xA;				' none defined&#xA;			end if&#xA;	end select&#xA;end sub&#xA;&#xA;&#xA;Sub EA_OnRunConnectorRule(RuleID,ConnectorID)&#xA;     EAST.LogInfo(&quot;****************** Validating connector... ********************&quot;)&#xA;	&#xA;	dim conn as EA.Connector&#xA;	dim eltFrom as EA.Element&#xA;	dim eltTo as EA.Element&#xA;&#xA;	set conn = GetConnectorByID(ConnectorID)&#xA;	set eltFrom = GetElementByID(conn.ClientID)&#xA;	set eltTo = GetElementByID(conn.SupplierID)&#xA;	if Left(eltFrom.Stereotype,4) &lt;&gt; &quot;TFCS&quot; or Left(eltTo.Stereotype,4) &lt;&gt; &quot;TFCS&quot; then&#xA;		' We only check 'pure TFCS' relations: between TFCS model elements&#xA;		exit sub&#xA;	end if&#xA;&#xA;	if(CheckSevere)then&#xA;		if conn.Direction = &quot;Destination -&gt; Source&quot; then&#xA;			' Preventing reverse direction connectors makes it easier to eg traverse control/object flows&#xA;			PublishResult 3,VAL_REVERSED_CONNECTOR&#xA;		else&#xA;			' Check if from/to element (stereo)types are valid for the type of relation&#xA;			' NOTE: validation that required relations are present is handled by element validation&#xA;			dim fromType: fromType = eltFrom.Type&#xA;			dim toType: toType = eltTo.Type&#xA;			dim toStereo: toStereo = eltTo.Stereotype&#xA;			dim fromStereo: fromStereo = eltFrom.Stereotype&#xA;			dim subType: subType = conn.Subtype&#xA;			select case  conn.Type&#xA;				case &quot;Dependency&quot;&#xA;					if fromType = &quot;Issue&quot; then exit sub end if&#xA;					if fromStereo = &quot;TFCS_AuthorisationEffect&quot; then exit sub end if&#xA;					if toType = &quot;Class&quot; and fromStereo = &quot;TFCS_DomainRule&quot; then exit sub end if&#xA;					if (fromType = &quot;UseCase&quot; and toStereo = &quot;TFCS_DomainInstance&quot;) _&#xA;						or (toType = &quot;UseCase&quot; and fromStereo = &quot;TFCS_DomainInstance&quot;) then &#xA;						&#xA;						' Check for valid stereotype&#xA;						if conn.Stereotype = &quot;input&quot; or conn.Stereotype = &quot;create&quot; _&#xA;							or conn.Stereotype = &quot;update&quot; or conn.Stereotype = &quot;delete&quot; or conn.Stereotype = &quot;&quot; then&#xA;						else&#xA;							PublishResult 3,EAST.StrRep(VAL_RELATIONSTEREO_NOT_VALID,conn.type&amp;&quot;|&quot;&amp;fromType&amp;&quot;|&quot;&amp;fromStereo&amp;&quot;|&quot;&amp;toType&amp;&quot;|&quot;&amp;toStereo&amp;&quot;|&quot;&amp;conn.Stereotype)&#xA;						end if&#xA;						exit sub &#xA;					end if&#xA;				case &quot;UseCase&quot;&#xA;					if fromType = &quot;Actor&quot; and toType = &quot;UseCase&quot; then exit sub end if&#xA;					if toType = &quot;Actor&quot; and fromType = &quot;UseCase&quot; then exit sub end if&#xA;					if toType = &quot;UseCase&quot; and fromType = &quot;UseCase&quot; then exit sub end if&#xA;				case &quot;ControlFlow&quot;&#xA;					if fromStereo = &quot;TFCS_ActivityInitial&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromStereo = &quot;TFCS_ActivityInitial&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;					if fromType = &quot;Action&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;					if fromType = &quot;Action&quot; and toType = &quot;MergeNode&quot; then exit sub end if&#xA;					if fromType = &quot;Action&quot; and toStereo = &quot;TFCS_ActivityFinal&quot; then exit sub end if&#xA;					if fromType = &quot;Action&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromType = &quot;Decision&quot; and toType = &quot;MergeNode&quot; then exit sub end if&#xA;					if fromType = &quot;Decision&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromType = &quot;Decision&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;					if fromType = &quot;Decision&quot; and toStereo = &quot;TFCS_ActivityFinal&quot; then exit sub end if&#xA;					if fromType = &quot;MergeNode&quot; and toType = &quot;MergeNode&quot; then exit sub end if&#xA;					if fromType = &quot;MergeNode&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;					if fromType = &quot;MergeNode&quot; and toStereo = &quot;TFCS_ActivityFinal&quot; then exit sub end if&#xA;					if fromType = &quot;MergeNode&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromType = &quot;Event&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromType = &quot;Event&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;				case &quot;ObjectFlow&quot;&#xA;					if fromType = &quot;Object&quot; and fromStereo = &quot;TFCS_DomainInstance&quot; then exit sub end if&#xA;					if fromType = &quot;Object&quot; and fromStereo = &quot;TFCS_IntermediateResult&quot; then exit sub end if&#xA;					if toType = &quot;Object&quot; and toStereo = &quot;TFCS_DomainInstance&quot; then exit sub end if&#xA;					if toType = &quot;Object&quot; and toStereo = &quot;TFCS_IntermediateResult&quot; then exit sub end if&#xA;				case &quot;Association&quot;&#xA;					if toType = &quot;Class&quot; and fromType = &quot;Class&quot; then exit sub end if&#xA;				case &quot;Generalization&quot;&#xA;					if toType = &quot;Class&quot; and fromType = &quot;Class&quot; then exit sub end if&#xA;					if toType = &quot;Actor&quot; and fromType = &quot;Actor&quot; then exit sub end if&#xA;				case &quot;Aggregation&quot;&#xA;					if toType = &quot;Class&quot; and fromType = &quot;Class&quot; then exit sub end if&#xA;				case &quot;Realisation&quot;&#xA;					if toType = &quot;Requirement&quot; then exit sub end if&#xA;			end select&#xA;			PublishResult 3,EAST.StrRep(VAL_RELATION_NOT_VALID,conn.type&amp;&quot;|&quot;&amp;fromType&amp;&quot;|&quot;&amp;fromStereo&amp;&quot;|&quot;&amp;toType&amp;&quot;|&quot;&amp;toStereo)&#xA;		end if	&#xA;	end if&#xA;end sub&#xA;&#xA;Sub EA_OnRunPackageRule(RuleID,PackageID)&#xA;' - Packages no more than 3 levels deep: model - view - pck - subpck - subsubpck&#xA;end sub&#xA;&#xA;' =================================================================================================&#xA;' Validation rules &#xA;' =================================================================================================&#xA;&#xA;' Validate all elements of type issue (TFCS_TBD, TFCS_ReviewComment,...)&#xA;sub ValidateIssue(elt)&#xA;	if(CheckSevere)then&#xA;		' none defined&#xA;	else&#xA;		CheckIsOnDiagram elt,1,VAL_ELT_NOT_ON_DIAGRAM, _&#xA;			&quot;'TFCS_FlowDefnDiagram','TFCS_MaintenanceDiagram',&quot;+ _&#xA;			&quot;'TFCS_RequirementsDiagram','TFCS_DomainDiagram','TFCS_FlowDiagram','TFCS_FlowsDiagram'&quot;&#xA;		CheckReferences elt,1,VAL_ISSUE_NOT_REALISED,&quot;'Dependency'&quot;,&quot;''&quot;&#xA;	end if&#xA;end sub&#xA;&#xA;' Validate all elements of type requirement &#xA;sub ValidateRequirement(elt)&#xA;	if(CheckSevere)then&#xA;		' none defined&#xA;	else&#xA;		CheckIsOnDiagram elt,1,VAL_ELT_NOT_ON_DIAGRAM, _&#xA;			&quot;'TFCS_FlowDefnDiagram','TFCS_RequirementsDiagram','TFCS_DomainDiagram'&quot;+ _&#xA;			&quot;,'TFCS_FlowDiagram','TFCS_FlowsDiagram'&quot;&#xA;		CheckReferencedBy elt,1,VAL_REQ_NOT_REALISED,&quot;'Realisation'&quot;,&quot;''&quot;&#xA;	end if&#xA;end sub&#xA;&#xA;sub ValidateDomainRule(elt)&#xA;	if(CheckSevere)then&#xA;		CheckIsOnlyOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM,&quot;'TFCS_DomainDiagram','TFCS_FlowDiagram'&quot;&#xA;	else&#xA;		CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM,&quot;'TFCS_DomainDiagram','TFCS_FlowDiagram'&quot;&#xA;		CheckReferences elt,0,VAL_DOMRULE_NOT_REALISED,&quot;'Dependency'&quot;,&quot;'TFCS_DomainObject'&quot;&#xA;	end if&#xA;end sub&#xA;				&#xA;sub ValidateAutorisation(elt)&#xA;	if(CheckSevere)then&#xA;		' none defined&#xA;	else&#xA;		CheckUsedAsClassifier elt,1,VAL_AI_IS_NOT_USED ' has the AI any effects?&#xA;	end if&#xA;end sub&#xA;&#xA;sub ValidateActivity(elt)&#xA;	if(CheckSevere)then&#xA;' Activity must be present on flow realisation diagram of the workflow it rperesents so update rule:&#xA;'					CheckIsOnlyOnDiagram elt,3,VAL_ACT_ON_DGM,&quot;''&quot; ' template, only allowed as classifier for elements on diagrams&#xA;		CheckHasNoRelations elt,3,VAL_NO_RELATIONS_ALLOWED&#xA;		CheckHasExactlyOneDiagram elt,3,VAL_MISSING_WFDEFN_DIAGRAM,&quot;TFCS_FlowDefnDiagram&quot;&#xA;		&#xA;		' Must have a workflow element&#xA;		dim uc: set uc = GetElementByName(elt.Elements,elt.Name)&#xA;		if uc is nothing or uc.stereotype &lt;&gt; &quot;TFCS_Workflow&quot; then&#xA;			PublishResult 3,VAL_UC_MISSING_FOR_WF&#xA;		end if&#xA;	else&#xA;		' none defined&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckElementOnlyUsedOnParent(elt)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_CNT_OTHER_DIAGRAMS_FOR_ELT,elt.ElementID)&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;		PublishResult 0,VAL_ELT_ON_OTHER_DIAGRAM&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element has no relations at all&#xA;sub CheckHasNoRelations(elt,severity,msg)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_RELATIONS_FOR_ELT,elt.ElementID&amp;&quot;|''&quot;)&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element has no relations of a specific type&#xA;sub CheckHasNoRelationsOfType(elt,severity,msg,connTypeList)&#xA;      dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_RELATIONS_FOR_ELT,elt.ElementID&amp;&quot;|&quot;&amp;connTypeList)&#xA;      if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;            PublishResult severity,EAST.STRRep(msg,connTypeList)&#xA;      end if&#xA;end sub&#xA;&#xA;' Checks if an element has at least one relation of the specified type with elements of the specified type&#xA;sub CheckHasRelation(elt,severity,msg,connTypeList,stereoTypeList)&#xA;	dim result: set result = EAST.ExecuteSQL( _&#xA;		VAL_SQL_ELT_REFERENCEd_by,elt.ElementID&amp;&quot;|&quot;&amp;ucase(connTypeList)&amp;&quot;|&quot;&amp;ucase(stereoTypeList))&#xA;	if result is nothing then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckRelation&quot;)&#xA;	elseif result.count = 0  then&#xA;		set result = EAST.ExecuteSQL( _&#xA;			VAL_SQL_ELT_REFERENCES,elt.ElementID&amp;&quot;|&quot;&amp;ucase(connTypeList)&amp;&quot;|&quot;&amp;ucase(stereoTypeList))&#xA;		if result is nothing then&#xA;			PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckRelation&quot;)&#xA;		elseif result.count = 0  then&#xA;			PublishResult severity,msg&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;function RelationExists(eltFromID,connType,connSubType,eltToID)&#xA;	RelationExists = false&#xA;	&#xA;	dim result: result = EAST.ExecuteScalarSQL( VAL_SQL_ELT_REFERENCES_ELT, _&#xA;		eltFromID&amp;&quot;|&quot;&amp;connType&amp;&quot;|&quot;&amp;connSubType&amp;&quot;|&quot;&amp;eltToID)&#xA;	if Typename(result) &lt;&gt; &quot;Empty&quot; and CInt(result) &gt; 1 then&#xA;		RelationExists = true&#xA;	end if&#xA;end function&#xA;&#xA;' Checks if an element has a relation originating from an element with one of the specified stereotypes and relation type&#xA;sub CheckReferencedBy(ELT,severity,msg,connTypeList,stereoTypeList)&#xA;	dim result: set result = EAST.ExecuteSQL( _&#xA;		VAL_SQL_ELT_REFERENCEd_by,elt.ElementID&amp;&quot;|&quot;&amp;ucase(connTypeList)&amp;&quot;|&quot;&amp;ucase(stereoTypeList))&#xA;	if result is nothing then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckReferencedBy&quot;)&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element has a relation to an element with one of the specified stereotypes and relation type&#xA;sub CheckReferences(ELT,severity,msg,connTypeList,stereoTypeList)&#xA;	dim result: set result = EAST.ExecuteSQL( _&#xA;		VAL_SQL_ELT_REFERENCES,elt.ElementID&amp;&quot;|&quot;&amp;ucase(connTypeList)&amp;&quot;|&quot;&amp;ucase(stereoTypeList))&#xA;	if result is nothing then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckReferences&quot;)&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element is present on at least one diagram of the specified (stereo)type&#xA;' Usage: IsOnDiagram(elt,&quot;'TFCS_FlowsDiagram'&quot;)&#xA;sub CheckIsOnDiagram(elt,severity,msg,dgmStereoTypeList)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_CNT_DGMS_WITH_ELT,elt.ElementID&amp;&quot;|&quot;&amp;ucase(dgmStereoTypeList))&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) = 0  then&#xA;		PublishResult severity,EAST.StrRep(msg,dgmStereoTypeList)&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element is present on none of the diagrams of the specified (stereo)type&#xA;' Usage: IsNotOnDiagram(elt,&quot;'TFCS_FlowsDiagram','TFCSFlowDefnDiagram'&quot;)&#xA;sub CheckIsOnlyOnDiagram(elt,severity,msg,dgmStereoTypeList)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_CNT_OTHER_DGMS_WITH_ELT,elt.ElementID&amp;&quot;|&quot;&amp;ucase(dgmStereoTypeList))&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;		dim postfix: postfix = &quot;&quot;&#xA;		if dgmStereoTypeList &lt;&gt; &quot;''&quot; then&#xA;			postfix = &quot; (komt voor in een of meer diagrammen van een ander type dan	&quot;+dgmStereoTypeList+&quot;)&quot;&#xA;		else&#xA;			postfix = &quot;&quot;&#xA;		end if&#xA;		PublishResult severity, msg+postfix&#xA;	end if&#xA;end sub&#xA;&#xA;' The element is parent for exacly one diagram, and this has the provided stereotype&#xA;sub CheckHasExactlyOneDiagram(elt,severity,msg,dgmStereoType)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_DGMSTEREO_FOR_ELT,elt.ElementID)&#xA;	if (result is nothing) then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckHasExactlyOneDiagram&quot;)&#xA;	else&#xA;		if result.count &gt; 1  then&#xA;			PublishResult severity,msg + &quot; (meerdere diagrammen gevonden)&quot;&#xA;		elseif result.count = 0  then&#xA;			PublishResult severity,msg + &quot; (geen diagram gevonden)&quot;&#xA;		else&#xA;			dim stereotype&#xA;			dim style : style = result.item(0).item(&quot;STYLEEX&quot;)&#xA;			dim srch: srch = &quot;MDGDgm=&quot;&#xA;			Dim sPos: sPos = InStr(1, style,srch)&#xA;			If sPos &gt; 0 Then&#xA;				Dim ePos: ePos = InStr(sPos, style, &quot;;&quot;)&#xA;				stereotype = Mid(style, sPos+len(srch), ePos-sPos-len(srch))&#xA;			End If&#xA;			if (ucase(stereotype) &lt;&gt; ucase(&quot;TFCS::&quot;+dgmStereoType)) then&#xA;				PublishResult severity,msg + &quot; (stereotype is '&quot;+stereotype+&quot;' ipv '&quot;+dgmStereoType+&quot;')&quot;&#xA;			end if&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element does not contain elements of the specified type in its 'Elements' list&#xA;sub CheckNotContains(elt,severity,msg,eltStereoTypeList)&#xA;&#xA;	' Add typelist to Where clause&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_COMPOSITE_CONTAINS,elt.ElementID&amp;&quot;|&quot;&amp;ucase(eltStereoTypeList))&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;		PublishResult severity,msg+&quot;(diagram bij dit element bevat een of meer elementen van type '&quot;+eltStereoTypeList+&quot;'&quot;&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element contains an element of the specified type in its 'Elements' list&#xA;sub CheckNotContainedInComposite(elt,severity,msg)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_CONTAINED_IN_COMP,elt.ElementID)&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckWFIncludesNoHigherLevelSubflows(elt,severity,msg) &#xA;&#xA;	' Determine invalid sublow types&#xA;	dim flowType : flowType = GetTagValByName(elt.TaggedValues,&quot;WorkflowType&quot;)&#xA;	dim disAllowedTypes : disAllowedTypes = &quot;'WerkInstructie','BedrijfsProces'&quot;&#xA;	select case flowType&#xA;		case &quot;BedrijfsProces&quot;&#xA;			exit sub&#xA;		case &quot;WerkInstructie&quot;&#xA;			disAllowedTypes = &quot;'BedrijfsProces'&quot;&#xA;	end select&#xA;	&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_SUBFLOWS_OFTYPE,elt.ElementID&amp;&quot;|&quot;&amp;disAllowedTypes)&#xA;	if result is nothing  then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckWFIncludesNoHigherLevelSubflows&quot;)&#xA;	elseif result.count &gt; 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckWFIsUsed(elt,severity,msg) &#xA;	' Note we use ParentID iso ElementID as steps on workflows are classified by the UC -activity- element&#xA;	' which is the parent of the UC element if the TFCS structure for workflows has been obeyed (this is&#xA;	' validated elsewhere)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_AS_CLASSIFIER,elt.ParentID)&#xA;	if result is nothing  then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckWFIsUsed&quot;)&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckUsedAsClassifier(elt,severity,msg) &#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_AS_CLASSIFIER,elt.ElementID)&#xA;	if result is nothing  then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckUsedAsClassifier&quot;)&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckTagSameAsClassifier(elt,severity,msg,tagName) &#xA;	dim eltTag  : eltTag = GetTagValByName(elt.TaggedValues,tagName)&#xA;	dim classifierTag  : classifierTag = GetTagValByName(GetElementByID(elt.classifierID).TaggedValues,tagName)&#xA;	if eltTag &lt;&gt; classifierTag then&#xA;		PublishResult severity,EAST.StrRep(msg,eltTag&amp;&quot;|&quot;&amp;classifierTag)&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckActionTagSameAsWF(elt)&#xA;	dim eltTag  : eltTag = GetTagValByName(elt.TaggedValues,&quot;WorkflowType&quot;)&#xA;	dim ucElt,actElt&#xA;'	EAST.LogError(&quot;&gt;&gt; &quot;+Cstr(elt.ElementID)+&quot;(&quot;+eltTag+&quot;) classifierID: &quot;+CStr(elt.classifierID))&#xA;	set actElt = GetElementByID(elt.ClassifierID)&#xA;	set ucElt = actElt.Elements.GetByName(actElt.Name)&#xA;	dim ucTag  : ucTag = GetTagValByName(ucElt.TaggedValues,&quot;WorkflowType&quot;)&#xA;	if eltTag &lt;&gt; ucTag then&#xA;		PublishResult 3,EAST.StrRep(VAL_WFTYPETAG_DIFFERS,eltTag&amp;&quot;|&quot;&amp;ucTag)&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckHasTagValueIn(elt,severity,msg,tagName,valueList) &#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_HAS_TAGVALUE,elt.ElementID&amp;&quot;|&quot;&amp;tagName&amp;&quot;|&quot;&amp;valueList)&#xA;	if result is nothing then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckHasTagValueIn&quot;)&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,EAST.StrRep(msg,valueList)&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckWFExtendsSameLevelWF(elt,severity,msg)&#xA;	dim eltWFType: eltWFType = GetTagValByName(elt.taggedValues,&quot;WorkflowType&quot;)&#xA;	dim result: result = EAST.ExecuteScalarSQL( _&#xA;		VAL_SQL_WF_EXTENDS_OTHERLEVEL,elt.ElementID&amp;&quot;|&quot;&amp;eltWFType)&#xA;	if TypeName(result) = &quot;Empty&quot;  then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckWFExtendsSameLevelWF&quot;)&#xA;	elseif result &gt; 0  then&#xA;		PublishResult severity,EAST.StrRep(msg,eltWFType)&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckWFStepNotInLowerWorkflow(elt,severity,msg)&#xA;&#xA;	' Determine invalid flow types&#xA;	dim subflowType : subflowType = GetTagValByName(elt.TaggedValues,&quot;WorkflowType&quot;)&#xA;	dim disAllowedTypes : disAllowedTypes = &quot;'UseCase','WerkInstructie'&quot;&#xA;	select case subflowType&#xA;		case &quot;UseCase&quot;&#xA;			disAllowedTypes = &quot;'xxx'&quot;&#xA;		case &quot;WerkInstructie&quot;&#xA;			disAllowedTypes = &quot;'UseCase'&quot;&#xA;	end select&#xA;	&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_CNT_WF_OFTYPE,elt.ElementID&amp;&quot;|&quot;&amp;disAllowedTypes)&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;		PublishResult severity,EAST.StrRep(msg,subflowType&amp;&quot;|&quot;&amp;disAllowedTypes)&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckWFStepNotInComponent(elt,severity,msg)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_CNT_COMP,elt.ElementID)&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckClassifierInstanceIsOnWFDefDiagram(elt,severity,msg)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_CNT_CLASSIFIERINST_MISSING_ON_DD,elt.ElementID)&#xA;	if TypeName(result) = &quot;Empty&quot;  or CInt(result) &gt; 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckDiagramHasParent(dgm,validStereoList)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_PARENT_STEREOTYPE,dgm.DiagramID&amp;&quot;|&quot;&amp;validStereoList)&#xA;	if TypeName(result) = &quot;Empty&quot; then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckDiagramHasParent&quot;)&#xA;	elseif result &gt; 0 then&#xA;		PublishResult 3,EAST.StrRep(VAL_DGM_INVALID_PARENT,validStereoList)&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckHasClassifier(elt,severity,msg)&#xA;	if elt.classifierID = 0  then&#xA;		PublishResult severity,msg&#xA;	end if&#xA;end sub&#xA;&#xA;&#xA;' =================================================================================================&#xA;' Synchronisations &#xA;' =================================================================================================&#xA;&#xA;' Add all missing relations with actors and other workflows to the workflow definition diagram&#xA;sub SynchronizeWFDefWithModel(dgm)&#xA;&#xA;	dim reload: reload = false 'will be set of something was added&#xA;	dim offset: offset = 0&#xA;	dim i,row,classifier&#xA;	dim elt as EA.Element&#xA;	dim offA: offA = 0&#xA;	dim offWF: offWF = 0&#xA;	dim offREQ: offREQ = 0&#xA;	dim offISS: offISS = 0&#xA;	&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_RELATIONS_ON_WFDEFN,dgm.DiagramID)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		reload = true&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Stereotype&#xA;				case &quot;TFCS_Workflow&quot;&#xA;					addEltToDiagram elt,dgm,300+offWF,260+(offWF/4)&#xA;					offWF = offWF + 100&#xA;				case &quot;TFCS_Actor&quot;&#xA;					addEltToDiagram elt,dgm,50+offA,150&#xA;					offA = offA + 60&#xA;				case else&#xA;					if  elt.Type = &quot;Requirement&quot; then&#xA;						addEltToDiagram elt,dgm,230,800+offREQ&#xA;						PublishResult 2,VAL_INFO_ADDED_REQ_TO_WFDEFN&#xA;						offREQ = offREQ + 50&#xA;					else&#xA;						addEltToDiagram elt,dgm,500,800+offISS&#xA;						PublishResult 2,VAL_INFO_ADDED_ISSUE_TO_WFDEFN&#xA;						offISS = offISS + 50&#xA;					end if&#xA;			end select&#xA;			PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_ELT_TO_WFDEFN,elt.Name)&#xA;		next&#xA;	end if&#xA;	&#xA;	if(reload)then&#xA;		'Something was added =&gt; reload&#xA;		ReloadDiagram(dgm.DiagramID)&#xA;	end if&#xA;&#xA;end sub&#xA;&#xA;' Add all elements used in the flow that are missing in the fl,ow definition diagram &#xA;sub SynchronizeWFDefWithFlow(dgm)&#xA;&#xA;	dim defDgm: set defDgm = nothing 'will be set of something was added&#xA;	dim offAI: offAI = 0&#xA;	dim offDO: offDO = 0&#xA;	dim offREQ: offREQ = 0&#xA;	dim offISS: offISS = 0&#xA;	dim offWF: offWF = 0&#xA;	dim i,row,elt,eltInst,conn,wf&#xA;	dim result&#xA;	&#xA;	' Add all Authorisationitems that have effects on the flow but have not been included in the WF definition diagram&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_CLASSIFIERS_ON_WFDEFN,dgm.DiagramID&amp;&quot;|'TFCS_Authorisation'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		set defDgm = GetDiagramByID(result.item(0).item(&quot;DIAGRAM_ID&quot;))&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Stereotype&#xA;				case &quot;TFCS_Authorisation&quot;&#xA;					addEltToDiagram elt,defDgm,50,800+offAI&#xA;					PublishResult 2,VAL_INFO_ADDED_AI_TO_WFDEFN&#xA;					offAI = offAI + 50&#xA;				case else&#xA;			end select&#xA;		next&#xA;	end if&#xA;&#xA;	' Add an instance for each domainobject included (as instance) in the flow but not on the WF definition diagram&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_INST_ON_WFDEFN,dgm.DiagramID&amp;&quot;|'TFCS_DomainObject'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		set defDgm = GetDiagramByID(result.item(0).item(&quot;DIAGRAM_ID&quot;))&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Stereotype&#xA;				case &quot;TFCS_DomainObject&quot;&#xA;					set eltInst= GetElementByID(defDgm.ParentID).Elements.AddNew(&quot;&quot;,&quot;TFCS::TFCS_DomainInstance&quot;)&#xA;					eltInst.ClassifierID = elt.ElementID&#xA;					eltInst.ClassifierName = elt.Name&#xA;					eltInst.Update()&#xA;					addEltToDiagram eltInst,defDgm,100+offDO,500+(offDO/10)&#xA;					PublishResult 2,VAL_INFO_ADDED_DO_TO_WFDEFN&#xA;					offDO = offDO + 50&#xA;				case else&#xA;			end select&#xA;		next&#xA;	end if&#xA;&#xA;	' Add all subflows that have not been included in the WF definition diagram&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_WORKFLOWS_ON_WFDEFN,dgm.DiagramID)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		set defDgm = GetDiagramByID(result.item(0).item(&quot;DIAGRAM_ID&quot;))&#xA;		set wf = GetElementByID(result.item(0).item(&quot;WF_ID&quot;))&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			&#xA;			' If an include relation does not yet exist, create it now&#xA;'			if not RelationExists(wf.ElementID,&quot;'UseCase'&quot;,&quot;'Includes'&quot;,elt.ElementID) then&#xA;'				set conn = wf.Connectors.AddNew(&quot;&quot;, &quot;UseCase&quot;)&#xA;'				conn.SupplierID = elt.ElementID&#xA;'				conn.SubType=&quot;Includes&quot;&#xA;'				conn.alias=&quot;&lt;&lt;includes&gt;&gt;&quot;&#xA;'				conn.Update()&#xA;'			end if&#xA;			addEltToDiagram elt,defDgm,50+offWF,350-(offWF/4)&#xA;			PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_WF_TO_WFDEFN,elt.name)&#xA;			offWF = offWF + 100&#xA;		next&#xA;	end if&#xA;	&#xA;	' Add all requirements and issues included in the flow but not on the WF definition&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_ELTS_ON_WFDEFN,dgm.DiagramID&amp; _&#xA;		&quot;|'TFCS_Legislation','TFCS_Requirement','TFCS_NFR','TFCS_Request','TFCS_ReviewComment','TFCS_Ambiguity','TFCS_TBD','TFCS_Issue'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		set defDgm = GetDiagramByID(result.item(0).item(&quot;DIAGRAM_ID&quot;))&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Type&#xA;				case &quot;Requirement&quot;&#xA;					addEltToDiagram elt,defDgm,230,800+offREQ&#xA;					PublishResult 2,VAL_INFO_ADDED_REQ_TO_WFDEFN&#xA;					offREQ = offREQ + 50&#xA;				case else&#xA;					addEltToDiagram elt,defDgm,500,800+offISS&#xA;					PublishResult 2,VAL_INFO_ADDED_ISSUE_TO_WFDEFN&#xA;					offISS = offISS + 50&#xA;			end select&#xA;		next&#xA;	end if&#xA;	&#xA;	if(not defDgm is nothing)then&#xA;		'Something was added =&gt; reload&#xA;		ReloadDiagram(defDgm.DiagramID)&#xA;	end if&#xA;end sub&#xA;&#xA;&#xA;' =================================================================================================&#xA;' Reporting interface&#xA;' =================================================================================================&#xA;&#xA;'WARNING LEVELS&#xA;'mvError 						= 0&#xA;'mvWarning 						= 1&#xA;'mvInformation 					= 2&#xA;'mvErrorCritical 				= 3 &#xA;sub PublishResult(severity,msg)&#xA;	EAST.PublishValidationResult severity,msg&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="219"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{D113CB7C-DAE3-4c25-8768-FE4122810123}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_commons&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Module containing general utility methods.&#xA;' &#xA;' This module contains no event handlers only supporting functions, so registration with EAST is indirect, through&#xA;' inclusion within other modules&#xA;'&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' Retrieves the named element from the user temp package (userdir.temp)&#xA;' If the user temp package does not yet exist, its created.&#xA;' If the temp element does not yet exist, its created (always type 'Class') including the note as explanation.&#xA;function GetTempElement(name,notes)&#xA;	dim pck: set pck = EAST.GetPackageByFQN(GEN__WORKSPACE+&quot;.&quot;+EAST.UserName()+&quot;.temp&quot;,true)&#xA;	on error resume next&#xA;	dim elt: set elt = pck.Elements.GetByName(name)&#xA;	if elt is nothing then&#xA;		set elt = pck.Elements.AddNew(&quot;&quot;,&quot;Class&quot;)&#xA;		elt.name = name&#xA;		elt.Notes = notes&#xA;		elt.Update()&#xA;	end if&#xA;	set GetTempElement = elt&#xA;end function&#xA;&#xA;' If the element is orphaned, delete it else leave it as it is&#xA;function DeleteIfOrphanedElement(elt)&#xA;	DeleteIfOrphanedElement = false ' meaning: continue with other handlers&#xA;	&#xA;	select case elt.Stereotype&#xA;		case &quot;TFCS_Action&quot;&#xA;		case &quot;TFCS_AtomicAction&quot;&#xA;		case &quot;TFCS_CompositeAction&quot;&#xA;		case &quot;TFCS_ActivityInitial&quot;&#xA;		case &quot;TFCS_ActivityFinal&quot;&#xA;		case &quot;TFCS_Decision&quot;&#xA;		case &quot;TFCS_MergeNode&quot;&#xA;		case &quot;TFCS_Event&quot;&#xA;		case &quot;TFCS_DomainInstance&quot;&#xA;		case &quot;TFCS_IntermediateResult&quot;&#xA;		case &quot;TFCS_AuthorisationEffect&quot;&#xA;		case else&#xA;			exit function&#xA;	end select&#xA;&#xA;	' owned element, but it's still possible it was dropped on another diagram as well&#xA;	dim result: result = EAST.ExecuteScalarSQL(DELH_SQL_DGMOBJS,Cstr(elt.ElementID))&#xA;	if (not TypeName(result) = &quot;Empty&quot;) and CInt(result) &lt;= 1  then&#xA;		' Element exclusively used by this diagram =&gt; delete it&#xA;		EAST.LogInfo(&quot;DeleteIfOrphanedElement: element no longer used so deleting that as well&quot;)&#xA;		DeleteElementFromModel(elt)&#xA;		DeleteIfOrphanedElement = true&#xA;	end if&#xA;&#xA;end function&#xA;&#xA;' Remove an element from the model&#xA;sub DeleteElementFromModel(elt)		&#xA;	dim elements, i&#xA;	if elt.ParentID = 0 then&#xA;		set elements = GetPackageByID(elt.PackageID).elements&#xA;	else &#xA;		set elements = GetElementByID(elt.ParentID).elements&#xA;	end if&#xA;&#xA;	for i = 0 to elements.Count - 1&#xA;		if elements.GetAt(i).ElementID = elt.ElementID then&#xA;			elements.DeleteAt i, false&#xA;			Elements.Refresh()&#xA;			EAST.LogInfo(&quot;DeleteElementFromModel: deleted &quot;&amp;elt.ElementID)&#xA;			exit sub&#xA;		end if&#xA;	next&#xA;end sub&#xA;&#xA;function GetPrivatePackage(model,name)&#xA;	set GetPrivatePackage = nothing&#xA;	&#xA; 	' Get the private workspace for the current user&#xA;	dim workspacePath: workspacePath = GEN__WORKSPACE+&quot;.&quot;+EAST.UserName()&#xA;	dim workspace as EA.Package&#xA;	on error resume next&#xA;	set workspace = EAST.GetPackageByFQN(workspacePath) &#xA;	if err.number &lt;&gt; 0 then&#xA;		EAST.MsgBox EAST.StrRep(MSG_WORKSPACE_MISSING,workspacePath),16,COMM_NEW_WORKFLOW&#xA;		exit function&#xA;	end if&#xA;	on error goto 0&#xA;&#xA;	' Get the package (create if not available)&#xA;	if(name &lt;&gt; &quot;&quot;) then&#xA;		name = &quot;.&quot;+name&#xA;	end if&#xA;	if model = GEN__WORKSPACE then&#xA;		' No model selected: drop in private workspace root&#xA;		set GetPrivatePackage = EAST.GetPackageByFQN(workspacePath+name, true)&#xA;	else&#xA;		set GetPrivatePackage = EAST.GetPackageByFQN(workspacePath+&quot;.&quot;+model+name, true) &#xA;	end if&#xA;&#xA;end function&#xA;&#xA;' Add an action for the supplied workflow activity to the diagram at the indicated position&#xA;' Returns the action element that was created&#xA;&#xA;'-----------------------------------------------------------------------------------&#xA;' Generic diagram &amp; element &#xA;'-----------------------------------------------------------------------------------&#xA;&#xA;' Tree selection dialog - all elements in repository, current model is default open Returns GUID of selected dgm&#xA;function SelectDiagramFromTree(title,stereotype,stereotypeName,modelDefault,allowNew)&#xA;	SelectDiagramFromTree = &quot;&quot;&#xA;&#xA;	' Data to pass to the dialog&#xA;	dim dict : set dict = CreateObject(&quot;Scripting.Dictionary&quot;)&#xA;	dim rows : set rows = EAST.ExecuteSQL(COMM_SQL_DGMSBYSTEREO,ucase(stereotype))	&#xA;	dim rootModels : set rootModels = EAST.ExecuteSQL(COMM_SQL_GETMODELS,&quot;&quot;)	&#xA;	dict.add &quot;DFLT_MDL&quot;,modelDefault &#xA;	if(allowNew) then&#xA;		dict.add &quot;ALLOWNEW&quot;,stereotypeName&#xA;	end if&#xA;	dict.add &quot;ROWS&quot;,rows&#xA;	dict.add &quot;MODELS&quot;, rootModels&#xA;	&#xA;	EAST.OpenDialog &quot;tfcsSelectTree.html&quot;,title,dict&#xA;	EAST.LogDebug(&quot;SelectDiagramFromTree: &quot;+dict.item(&quot;RESULT&quot;))&#xA;	SelectDiagramFromTree = dict.item(&quot;RESULT&quot;)&#xA;end function&#xA;&#xA;' Tree selection dialog - all elements in repository, current model is default open. Returns GUID of selected elt&#xA;function SelectElementFromTree(title,stereotype,stereotypeName,modelDefault,allowNew,hideElement)&#xA;	SelectElementFromTree = &quot;&quot;&#xA;&#xA;	' Data to pass to the dialog&#xA;	dim dict : set dict = CreateObject(&quot;Scripting.Dictionary&quot;)&#xA;	dim hideID: hideID = 0&#xA;	if not hideElement is nothing then&#xA;		hideID = hideElement.ElementID&#xA;	end if&#xA;	dim rows : set rows = EAST.ExecuteSQL(COMM_SQL_ELTSBYSTEREO,stereotype&amp;&quot;|&quot;&amp;hideID)	&#xA;	dim rootModels : set rootModels = EAST.ExecuteSQL(COMM_SQL_GETMODELS,&quot;&quot;)	&#xA;	dict.add &quot;DFLT_MDL&quot;,modelDefault &#xA;	if(allowNew) then&#xA;		dict.add &quot;ALLOWNEW&quot;,stereotypeName&#xA;	end if&#xA;	dict.add &quot;ROWS&quot;,rows&#xA;	dict.add &quot;MODELS&quot;, rootModels&#xA;	&#xA;	EAST.OpenDialog &quot;tfcsSelectTree.html&quot;,title,dict&#xA;	EAST.LogDebug(&quot;SelectElementFromTree: &quot;+dict.item(&quot;RESULT&quot;))&#xA;	SelectElementFromTree = dict.item(&quot;RESULT&quot;)&#xA;end function&#xA;&#xA;' Tree selection dialog - all elements in repository with specific tag values, default tag open .Returns GUID of selected elt&#xA;function SelectElementTagFromTree(title,stereotype,tagName,tagValues,modelDefault,tagDefault,allowNew)&#xA;	SelectElementTagFromTree = &quot;&quot;&#xA;&#xA;	' Data to pass to the dialog&#xA;	dim dict : set dict = CreateObject(&quot;Scripting.Dictionary&quot;)&#xA;	dim rows : set rows = EAST.ExecuteSQL(COMM_SQL_ELTSBYSTEREO_AND_TAG,stereotype+&quot;|&quot;+tagName+&quot;|&quot;+ucase(tagValues))	&#xA;	dim rootModels : set rootModels = EAST.ExecuteSQL(COMM_SQL_GETMODELS,&quot;&quot;)	&#xA;	dict.add &quot;DFLT_MDL&quot;,modelDefault &#xA;	dict.add &quot;DFLT_TAG&quot;,tagDefault&#xA;	if allowNew then&#xA;		dict.add &quot;ALLOWNEW&quot;,tagValues&#xA;	end if&#xA;	dict.add &quot;ROWS&quot;,rows&#xA;	dict.add &quot;MODELS&quot;, rootModels&#xA;	&#xA;	EAST.OpenDialog &quot;tfcsSelectTree.html&quot;,title,dict&#xA;	EAST.LogDebug(&quot;SelectElementTagFromTree: &quot;+dict.item(&quot;RESULT&quot;))&#xA;	SelectElementTagFromTree = dict.item(&quot;RESULT&quot;)&#xA;end function&#xA;&#xA;&#xA;' Returns true if an object is present on a specific diagram&#xA;function ObjectIsOnDiagram(objID,dgm)&#xA;	ObjectIsOnDiagram = false&#xA;	dim dgmObject as EA.DiagramObject&#xA;	for each dgmObject in dgm.DiagramObjects&#xA;		if dgmObject.ElementID = objID then&#xA;			ObjectIsOnDiagram = true&#xA;			exit function&#xA;		end if&#xA;	next&#xA;end function&#xA;&#xA;' Add an element as link to the diagram, return the created diagram object&#xA;function addEltToDiagram(elt, dgm, left, top)&#xA;	EAST.LogStart(&quot;addEltToDiagram&quot;)&#xA;	dim width: width = 20&#xA;	dim height: height = 30&#xA;	' TBD: Why is _sizeX/Y not working?&#xA;	select case elt.Type&#xA;	case &quot;Issue&quot;&#xA;		width = 200&#xA;	case &quot;Requirement&quot;&#xA;		width = 200&#xA;	case &quot;Object&quot;&#xA;		width = 150&#xA;		height = 50&#xA;	case &quot;Class&quot;&#xA;		width = 200&#xA;		height = 100&#xA;	case &quot;Decision&quot;&#xA;		width = 26&#xA;		height = 34&#xA;	case &quot;MergeNode&quot;&#xA;		width = 26&#xA;		height = 34&#xA;	case &quot;Actor&quot;&#xA;		width = 40&#xA;		height = 60&#xA;	case &quot;UseCase&quot;&#xA;		width = 100&#xA;		height = 70&#xA;	case &quot;Activity&quot;&#xA;		width = 80&#xA;		height = 60&#xA;	case &quot;Action&quot;&#xA;		width = 100&#xA;		if(elt.Stereotype = &quot;TFCS_CompositeAction&quot;) then&#xA;			height = 60&#xA;		else&#xA;			height = 30&#xA;		end if&#xA;	case else&#xA;	end select&#xA;	dim right: right = left + width&#xA;	dim bottom: bottom = top + height&#xA;	dim dgmObject: set dgmObject = dgm.diagramObjects.AddNew(&quot;l=&quot;&amp;left&amp;&quot;;r=&quot;&amp;right&amp;&quot;;t=&quot;&amp;top&amp;&quot;;b=&quot;&amp;bottom&amp;&quot;;&quot;, &quot;&quot; )&#xA;	dgm.DiagramObjects.Refresh()&#xA;	dgmObject.ElementID = elt.ElementID &#xA;	dgmObject.Update()&#xA;&#xA;	set addEltToDiagram = dgmObject&#xA;	EAST.LogInfo(&quot;Added element to '&quot;&amp;dgm.name&amp;&quot;' at (&quot;&amp;left&amp;&quot;,&quot;&amp;top&amp;&quot;)-(&quot;&amp;right&amp;&quot;,&quot;&amp;bottom&amp;&quot;)&quot;)&#xA;	EAST.LogEnd(&quot;addEltToDiagram&quot;)&#xA;end function&#xA;&#xA;' Adds a post-it to a diagram&#xA;' loc has the format: &quot;l=10;t=10;r=800;b=100;&quot; (#pixels left-top-right-bottom)&#xA;function addPostIt(elt,dgm,loc,notes)&#xA;&#xA;	dim dgmElement as EA.Element&#xA;	dim dgmObject as EA.DiagramObject&#xA;	&#xA;	set dgmElement = elt.Elements.AddNew(&quot;&quot;,&quot;Note&quot;)&#xA;	dgmElement.Notes = notes&#xA;	dgmElement.Update()&#xA;	&#xA;	set dgmObject = dgm.diagramObjects.AddNew(loc,&quot;&quot;)&#xA;	dgmObject.ElementID = dgmElement.ElementID&#xA;	dgmObject.Style = &quot;BCol=65535;NSL=0&quot;&#xA;	dgmObject.Update()&#xA;	&#xA;	set addPostIt = dgmObject&#xA;end function&#xA;&#xA;' Adds a boundary to a diagram&#xA;' loc has the format: &quot;l=10;t=10;r=800;b=100;&quot; (#pixels left-top-right-bottom)&#xA;' nonSelectable: 1: niet selecteerbaar, 0: wel&#xA;function addBoundary(elt,dgm,loc,notes,nonSelectable)&#xA;&#xA;	dim dgmElement as EA.Element&#xA;	dim dgmObject as EA.DiagramObject&#xA;	&#xA;	set dgmElement = elt.Elements.AddNew(&quot;&quot;,&quot;Boundary&quot;)&#xA;	dgmElement.Name = notes&#xA;	dgmElement.Update()&#xA;	&#xA;	set dgmObject = dgm.diagramObjects.AddNew(loc,&quot;&quot;)&#xA;	dgmObject.ElementID = dgmElement.ElementID&#xA;	dgmObject.Style = &quot;font=Arial;fontsz=100;bold=1;italic=0;ul=0;charset=0;pitch=34;NSL=&quot;&amp;nonSelectable&#xA;	dgmObject.Update()&#xA;	&#xA;	set addBoundary = dgmObject&#xA;end function&#xA;&#xA;Function GetStyleEx(byref dgm, srch)&#xA;	GetStyleEx = &quot;&quot;&#xA;	&#xA;	Dim style: style = dgm.StyleEx&#xA;    Dim sPos: sPos = InStr(1, style, srch+&quot;=&quot;)&#xA;    If sPos &gt; 0 Then&#xA;        Dim ePos: ePos = InStr(sPos, style, &quot;;&quot;)&#xA;        GetStyleEx = Mid(style, sPos+len(srch)+1, ePos-sPos-len(srch)-1)&#xA;    End If&#xA;End Function&#xA;&#xA;sub SetStyleEx(byref dgm, srch, value)&#xA;	&#xA;	Dim style: style = dgm.StyleEx&#xA;    Dim sPos: sPos = InStr(1, style, srch+&quot;=&quot;)&#xA;    If sPos = 0 Then&#xA;		style = style+srch+&quot;=&quot;+value+&quot;;&quot;&#xA;	else&#xA;	    Dim ePos: ePos = InStr(sPos, style, &quot;;&quot;)&#xA;		style = Left(style,sPos+len(srch)+1)+value+Mid(style, ePos)&#xA;	end if&#xA;	dgm.StyleEx = style&#xA;	dgm.update()&#xA;End sub&#xA;&#xA;Function GetTagByName(tags, name)&#xA;&#xA;	Dim i&#xA;	Dim tag As EA.TaggedValue&#xA;	Set tag = Nothing&#xA;	If Not tags Is Nothing Then&#xA;		For i = 0 To tags.Count - 1&#xA;			If tags.GetAt(i).Name = name Then&#xA;				Set tag = tags.GetAt(i)&#xA;				Exit For&#xA;			End If&#xA;		Next&#xA;	End If&#xA;	Set GetTagByName = tag&#xA;&#xA;End Function&#xA;&#xA;Function GetTagValByName(tags, name)&#xA;&#xA;	Dim ret&#xA;	ret = &quot;&quot;&#xA;&#xA;	If Not tags Is Nothing Then&#xA;		Dim i&#xA;		Dim tag As EA.TaggedValue&#xA;'		Set tag = tags.GetByName(name)&#xA;		For i = 0 To tags.Count - 1&#xA;			If tags.GetAt(i).Name = name Then&#xA;				ret = tags.GetAt(i).Value&#xA;				Exit For&#xA;			End If&#xA;		Next&#xA;	End If&#xA;&#xA;	GetTagValByName = ret&#xA;&#xA;End Function&#xA;&#xA;&#xA;Sub SetTagValByName(tags, name, val, notes)&#xA;&#xA;	If Not tags Is Nothing And Len(name) &gt; 0 Then&#xA;		Dim tag As EA.TaggedValue&#xA;'		Set tag = tags.GetByName(name)&#xA;		Set tag = GetTagByName(tags, name)&#xA;		If Not tag Is Nothing Then&#xA;			tag.Value = val&#xA;			tag.Notes = notes&#xA;			tag.Update&#xA;			tags.Refresh&#xA;		Else&#xA;			Set tag = tags.AddNew(name, val)&#xA;			tag.notes = notes&#xA;			tag.Update&#xA;			tags.Refresh&#xA;		End If&#xA;	End If&#xA;&#xA;End Sub&#xA;&#xA;function GetElementByName(eltList,name)&#xA;	set GetElementByName = nothing&#xA;	&#xA;	dim elt&#xA;	for each elt in eltList&#xA;		if elt.name = name then &#xA;			set GetElementByName = elt&#xA;			exit function&#xA;		end if&#xA;	next&#xA;end function&#xA;&#xA;' Adds a property to an element&#xA;' Carefull: no check if the property already exists!&#xA;sub AddProperty(eltGUID,pName,pType,pValue,pComment)&#xA;	dim props: set props = EAST.ExecuteSQL(SQL_GET_OBJECTPROPERTIES,eltGUID)&#xA;	if props is nothing or props.count = 0  then&#xA;EAST.LogError(&quot;Nothing founjd &quot;&amp;props.count)&#xA;		' create the very first property in the set&#xA;		Repository.Execute(EAST.StrRep(SQL_INS_OBJECTPROPERTIES, _&#xA;			EAST.GenerateGUID()+&quot;|&quot;+eltGUID+&quot;|&quot;+pName+&quot;|&quot;+pType+&quot;|&quot;+pValue+&quot;|&quot;+pComment ))&#xA;	else&#xA;		dim ID : ID = props.item(0).item(&quot;XREFID&quot;)&#xA;		dim DESC : DESC = props.item(0).item(&quot;DESCRIPTION&quot;)&#xA;		DESC = DESC + EAST.StrRep(&quot;@PROP=@NAME={0}@ENDNAME;@TYPE={1}@ENDTYPE;@VALU={2}@ENDVALU;@PRMT={3}@ENDPRMT;@ENDPROP;&quot;, _&#xA;			pName+&quot;|&quot;+pType+&quot;|&quot;+pValue+&quot;|&quot;+pComment )&#xA;		Repository.Execute(EAST.StrRep(SQL_UPD_OBJECTPROPERTIES, ID+&quot;|&quot;+DESC)) &#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="220"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{E5E09718-35FF-4805-BC63-95841AC88A91}"/>
			<Column name="ScriptAuthor" value="{F84E00CC-793B-4eca-B313-69DC30FAA19A}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_MainMenu&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Add a menu item TFCS to the EA context menu's.&#xA;' NOTE: EA allows only -one- main menu item for an add-in so TFCS menu items should be placed below&#xA;' then main TFCS menu item&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit &#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;'&#xA;' Display a main menu 'TFCS' for treeview and diagram&#xA;'&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	set EA_GetMenuItems = nothing&#xA;	&#xA;	if(MenuLocation = &quot;Diagram&quot; and MenuName = &quot;&quot;) then&#xA;		Dim dgm as EA.Diagram&#xA;		set dgm = Repository.GetCurrentDiagram()&#xA;		if(Left(GetStyleEx(dgm,&quot;MDGDgm&quot;),4) = &quot;TFCS&quot;)then&#xA;' Currently no specific diagram context menus in TFCS so don't create the main menu&#xA;'			EA_GetMenuItems = &quot;TFCS&quot;&#xA;		end if&#xA;	elseif MenuLocation = &quot;TreeView&quot; and MenuName = &quot;&quot; then&#xA;		EA_GetMenuItems = MNU_TFCSMAIN&#xA;	elseif MenuLocation = &quot;MainMenu&quot; then&#xA;		' main menu already created by the scripting toolkit&#xA;		if(MenuName = &quot;-EA EventDelegator&quot;) then&#xA;			dim menus(1)&#xA;			menus(1) = MNU_TFCSMAIN&#xA;			menus(0) = &quot;-&quot;&#xA;			EA_GetMenuItems = menus&#xA;		end if&#xA;	end if&#xA;end Function&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="221"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{3B45B068-E384-44a4-A3C5-E5A48C55EE3E}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_WorkflowCreation&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Creation of a new workflow of a specific type (UC/WI/BP)&#xA;'&#xA;' This module contains no event handlers only supporting functions, so registration with EAST is indirect, through&#xA;' inclusion within other modules&#xA;'&#xA;' Creates the following structure in the private workspace of the user, in package 'Workflows':&#xA;' 	&lt;WF package&gt;&#xA;'		&lt;WF activity&gt;&#xA;'			&lt;WF&gt;&#xA;'				&lt;default WF realisation diagram&gt;&#xA;'			&lt;default WF specification diagram&gt;&#xA;'&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;Function CreateWorkFlowForModel(dgm, flowType,flowPrefix,model)&#xA;	set CreateWorkFlowForModel = nothing&#xA;	dim thePackage : set thePackage = GetPrivatePackage(model,GEN__PCK_WORKFLOWS)&#xA;	&#xA;	' Get the name for the new WF&#xA;	dim answer: answer = EAST.InputBox(&quot;Naam (zonder prefix '&quot;+flowPrefix+&quot;-') : &quot;,&quot;Toevoegen nieuwe &quot;+flowType,&quot;000 - Mijn workflow&quot;)&#xA;	if answer = empty or answer = &quot;&quot; then&#xA;		exit function&#xA;	end if&#xA;	dim ucName : ucName = flowPrefix+&quot;-&quot;+ answer&#xA;&#xA;' -------------------------------------------------------&#xA;' 	&lt;WF package&gt;&#xA;' -------------------------------------------------------&#xA;	dim ucPackage :	set ucPackage = thePackage.packages.AddNew(ucName, &quot;Class&quot; )&#xA;	ucPackage.Update()&#xA;	&#xA;' -------------------------------------------------------&#xA;'		&lt;WF activity&gt;&#xA;' -------------------------------------------------------&#xA;	dim ucActivity : set ucActivity = ucPackage.elements.AddNew(ucName, &quot;TFCS::TFCS_Activity&quot; )&#xA;	ucPackage.Elements.Refresh()&#xA;&#xA;' -------------------------------------------------------&#xA;'			&lt;WF&gt;&#xA;'				&lt;default WF realisation diagram&gt;&#xA;' -------------------------------------------------------&#xA;	dim uc : set uc = ucActivity.elements.AddNew( ucActivity.Name, &quot;TFCS::TFCS_WorkFlow&quot; ) &#xA;	SetTagValByName uc.TaggedValues,&quot;WorkflowType&quot;,flowType,&quot;&quot;&#xA;&#xA;	dim ucReal : set ucReal = uc.CompositeDiagram&#xA;	ucReal.Name = flowPrefix+&quot;R-&quot;+answer&#xA;	ucActivity.Elements.Refresh()&#xA;	SetStyleEX ucReal,&quot;ShowDiagramInPages&quot;,&quot;1&quot;&#xA;	ucReal.Update()&#xA;	uc.Update()&#xA;&#xA;	' Populate UC realization diagram&#xA;	' Diagram notes&#xA;	dim dgmLabel : set dgmLabel = uc.Elements.AddNew(&quot;&quot;,&quot;Text&quot;)&#xA;	dgmLabel.Subtype = 18&#xA;	dgmLabel.Update()&#xA;	dim dgmObject : set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=5;t=5;r=10;b=10;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmLabel.ElementID )&#xA;	dgmObject.Style = &quot;NSL=1&quot;&#xA;	dgmObject.Update()&#xA;	&#xA;	' TODO note&#xA;	addPostIt ucActivity,ucReal,&quot;l=250;t=27;r=400;b=85;&quot;,&quot;&lt;b&gt;TODO&lt;/b&gt;: stappenplan nog uitwerken&quot;&#xA;	set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=559;t=27;r=701;b=85;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( ucActivity.ElementID )&#xA;	dgmObject.Style = &quot;NSL=1&quot;&#xA;	dgmObject.Update()&#xA;	&#xA;	' Default flow: start&#xA;	dim eltStart&#xA;	set dgmElement = uc.Elements.AddNew(&quot;Start&quot;,&quot;StateNode&quot;)&#xA;	dgmElement.Subtype = 100 'for ActivityInitial&#xA;	dgmElement.Stereotype = &quot;TFCS_ActivityInitial&quot;&#xA;	dgmElement.Update()&#xA;	set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=371;t=116;r=396;b=140;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmElement.ElementID )&#xA;	dgmObject.Update()&#xA;	set eltStart = dgmElement&#xA;&#xA;	' Default flow: action&#xA;	dim eltAction&#xA;	dim dgmElement: set dgmElement = uc.Elements.AddNew(&quot;Flow of &quot;+ucName,&quot;TFCS::TFCS_AtomicAction&quot;)&#xA;	dgmElement.Update()&#xA;	set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=331;t=180;r=436;b=250;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmElement.ElementID )&#xA;	dgmObject.Update()&#xA;	set eltAction = dgmElement&#xA;&#xA;	' Default flow: end&#xA;	dim eltEnd&#xA;	set dgmElement = uc.Elements.AddNew(&quot;Einde&quot;,&quot;StateNode&quot;)&#xA;	dgmElement.Subtype = 101 'for ActivityFinal&#xA;	dgmElement.Stereotype = &quot;TFCS_ActivityFinal&quot;&#xA;	dgmElement.Update()&#xA;	set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=371;t=280;r=396;b=304;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmElement.ElementID )&#xA;	dgmObject.Update()&#xA;	set eltEnd = dgmElement&#xA;&#xA;	' Default flow: connect start-action and action-end&#xA;    dim conn : set conn = eltStart.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;)&#xA;	conn.SupplierID = eltAction.ElementID&#xA;    conn.Update()&#xA;	set conn = eltAction.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;)&#xA;	conn.SupplierID = eltEnd.ElementID&#xA;    conn.Update()&#xA;	&#xA;	ucReal.DiagramObjects.Refresh()&#xA;&#xA;' -------------------------------------------------------&#xA;'			&lt;default WF specification diagram&gt;&#xA;' -------------------------------------------------------&#xA;	' Add usecase element&#xA;	dim ucSpec : set ucSpec = ucActivity.CompositeDiagram&#xA;	set dgmObject = ucSpec.diagramObjects.AddNew( &quot;l=331;t=416;r=436;b=486;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( uc.ElementID )&#xA;	dgmObject.Update()&#xA;	&#xA;	' Add diagramlabel&#xA;	set dgmElement = ucActivity.Elements.AddNew(&quot;&quot;,&quot;Text&quot;)&#xA;	dgmElement.Subtype = 18&#xA;	dgmElement.Update()&#xA;	set dgmObject = ucSpec.diagramObjects.AddNew( &quot;l=5;t=5;r=10;b=10;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmElement.ElementID )&#xA;	dgmObject.Style = &quot;NSL=1&quot;&#xA;	dgmObject.Update()&#xA;&#xA;	' Add TODO Notes&#xA;	set dgmObject = addPostIt(ucActivity,ucSpec,&quot;l=252;t=5;r=769;b=128;&quot;,&quot;&lt;&lt;korte omschrijving&gt;&gt;&quot;_&#xA;		+VbCrLf _&#xA;		+VbCrLf )&#xA;	dgmObject.Style = &quot;BCol=16249847;&quot;&#xA;	dgmObject.Update()&#xA;	addPostIt ucActivity,ucSpec,&quot;l=559;t=27;r=701;b=85;&quot;,&quot;&lt;b&gt;TODO&lt;/b&gt;: neem hier een korte beschrijving van de workflow op&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: platte tekst&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=256;r=564;t=819;b=885;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige requirements op waarin door deze workflow wordt voorzien.&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar autorisatieitems onder &lt;u&gt;\Requirements\...&lt;/u&gt;&lt;/font&gt;&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=30;t=799;r=186;b=927;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle autorisatie items op die binnen de workflow worden gebruikt&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar autorisatieitems onder &lt;font color='000ff'&gt;&lt;u&gt;\Requirements\Autorisaties&lt;/u&gt;&lt;/font&gt;&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=427;t=673;r=682;b=718;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige post-condities op&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: platte tekst&quot;  &#xA;	addPostIt ucActivity,ucSpec,&quot;l=68;t=670;r=323;b=715;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige pre-condities op&lt;u&gt;&quot;+ _&#xA;		VbCrLf +&quot;Vorm&lt;/u&gt;: platte tekst&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=537;t=404;r=761;b=498;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die door deze workflow worden verwijderd, gewijzigd, of gecreeerd&quot;+_&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=272;t=532;r=494;b=603;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die door deze workflow worden gelezen&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot; &#xA;	addPostIt ucActivity,ucSpec,&quot;l=41;t=409;r=220;b=493;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die input zijn voor deze workflow&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=177;t=289;r=589;b=368;&quot;,&quot;&lt;b&gt;TODO: &lt;/b&gt;neem hier alle extensie- en include- relaties op met andere workflows.&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: Links naar de betreffende UC-es onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Functioneel Ontwerp\Use cases&lt;/u&gt;&lt;/font&gt;&quot;+ _&#xA;		VbCrLf +VbCrLf +&quot;&lt;u&gt;Richtlijn&lt;/u&gt;: aan extended en included UC-es worden geen actoren gekoppeld (deze volgen impliciet uit het gebruik)&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=174;t=181;r=626;b=229;&quot;,&quot;&lt;b&gt;TODO: &lt;/b&gt;neem hier de relevante actoren op en koppel die aan de workflow &quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar actoren onder &lt;font color='#0000ff'&gt;&lt;u&gt;\ProcesBeschrijvingen\Actoren&lt;/u&gt;&lt;/font&gt; met associatie met de workflow&quot;&#xA;	&#xA;	' Add boundaries&#xA;	addBoundary ucActivity,ucSpec,&quot;l=401;t=629;r=766;b=762;&quot;,&quot;Post-condities&quot;,1&#xA;	addBoundary ucActivity,ucSpec,&quot;l=22;t=769;r=197;b=1061;&quot;,&quot;Autorisaties&quot;,1&#xA;	addBoundary ucActivity,ucSpec,&quot;l=16;t=151;r=765;b=258;&quot;,&quot;Actoren&quot;,1&#xA;	addBoundary ucActivity,ucSpec,&quot;l=22;t=629;r=387;b=762;&quot;,&quot;Pre-condities&quot; ,1&#xA;	addBoundary ucActivity,ucSpec,&quot;l=207;t=769;r=766;b=1061;&quot;,&quot;Requirements&quot;,1&#xA;	&#xA;	ucSpec.DiagramObjects.Refresh()&#xA;&#xA;	set CreateWorkFlowForModel = ucActivity&#xA;end function&#xA;&#xA;function getWorkflowPrefix(flowType)&#xA;	dim prefix&#xA;	if flowType = &quot;UseCase&quot; then&#xA;		prefix = &quot;UC&quot;&#xA;	elseif flowType = &quot;WerkInstructie&quot;then&#xA;		prefix = &quot;WI&quot;&#xA;	elseif flowType = &quot;BedrijfsProces&quot; then&#xA;		prefix = &quot;BP&quot;&#xA;	else&#xA;		EAST.LogWarning(&quot;Unkown flowtype: &quot;+flowType)&#xA;		prefix = &quot;UC&quot;&#xA;	end if&#xA;	&#xA;	getWorkflowPrefix = prefix&#xA;end function"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="222"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{79C79CD6-96BB-42c4-BC98-DBD91508C3A1}"/>
			<Column name="ScriptAuthor" value="{F84E00CC-793B-4eca-B313-69DC30FAA19A}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_DeleteHandler&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Handles deleting elements from diagrams&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;option explicit&#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;'Function EA_OnPreDeleteElement( Info ) &#xA;'	EA_OnPreDeleteElement = HandleDropElement(Info,nothing)&#xA;'end function&#xA;&#xA;Function EA_OnPreDeleteDiagramObject( Info ) &#xA;	EA_OnPreDeleteDiagramObject = true&#xA;&#xA;	dim elt: set elt = GetElementByID(Info.get(&quot;ID&quot;).Value)&#xA;	if elt.Stereotype = &quot;TFCS_Activity&quot; then&#xA;		' Disable deletion of the navigate-back-option from WF realisation diagrams&#xA;		EA_OnPreDeleteDiagramObject = false&#xA;	else&#xA;		EA_OnPreDeleteDiagramObject = not DeleteIfOrphanedElement(elt)&#xA;	end if&#xA;end Function&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="223"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{29CD9063-E84D-4f3e-BFBF-BEF5756D577B}"/>
			<Column name="ScriptAuthor" value="{F84E00CC-793B-4eca-B313-69DC30FAA19A}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_CreateFromProjectBrowser&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Reacts to drop on diagram from project browser: currently no drop as classifier allowed&#xA;' Also blocks creation of new elements directly in the projectbrowser&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;option explicit&#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;Function EA_OnPreNewElement( Info ) &#xA;	EAST.LogStart(&quot;EA_OnPreNewElement&quot;)&#xA;	EA_OnPreNewElement = true&#xA;	' Block if no diagramID provided&#xA;	if CInt(Info.get(&quot;DiagramID&quot;).value) = 0 then&#xA;		EA_OnPreNewElement = false&#xA;		EAST.MsgBox DDH_PROMPT_PBCR_NOTALLOWED,16,DDH_TITLE_NOTALL&#xA;	end if&#xA;	EAST.LogEnd(&quot;EA_OnPreNewElement&quot;)&#xA;end function&#xA;&#xA;Function EA_OnPreNewDiagramObject( Info ) &#xA;	EAST.LogStart(&quot;EA_OnPreNewDiagramObject&quot;)&#xA;	EA_OnPreNewDiagramObject = true&#xA;	dim ID: ID = CInt(Info.get(&quot;ID&quot;).value)&#xA;	if ID &lt;&gt; 0 then&#xA;		if ObjectIsOnDiagram(ID,GetCurrentDiagram()) then&#xA;			EA_OnPreNewDiagramObject = false&#xA;			EAST.MsgBox DDH_PROMPT_ELTONDGM,16,DDH_TITLE_ELTONDGM&#xA;		else&#xA;			dim eltType: eltType = Info.get(&quot;Type&quot;).value&#xA;			if eltType = &quot;Package&quot; then&#xA;				' OK&#xA;			elseif eltType = &quot;Diagram&quot; then&#xA;				' OK&#xA;			else&#xA;				EA_OnPreNewDiagramObject = OnDropElement(GetElementByID(ID)) &#xA;			end if&#xA;		end if&#xA;	end if&#xA;	EAST.LogEnd(&quot;EA_OnPreNewDiagramObject&quot;)&#xA;end function&#xA;&#xA;function OnDropElement(eltDropped)&#xA;	EAST.LogStart(&quot;OnDropElement&quot;)&#xA;	OnDropElement = false&#xA;	&#xA;	dim dgm: set dgm = GetCurrentDiagram()&#xA;	if(dgm is nothing) then exit function end if&#xA;	dim dgmStereo : dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;	if Left(dgmStereo,4) &lt;&gt; &quot;TFCS&quot; then	&#xA;		EAST.LogWarning(&quot;Diagram is non-TFCS =&gt; standard EA handling&quot;)&#xA;		EAST.LogEnd(&quot;OnDropElement&quot;)&#xA;		exit function &#xA;	end if&#xA;&#xA;	OnDropElement = HandleDropElement(dgm,dgmStereo,eltDropped) &#xA;	&#xA;	EAST.LogEnd(&quot;OnDropElement&quot;)&#xA;end function&#xA;&#xA;function HandleDropElement(dgm,dgmStereo,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropElement&quot;)&#xA;	HandleDropElement = true&#xA;&#xA;	dim eltStereo : eltStereo = eltDropped.Stereotype&#xA;	if eltStereo = &quot;&quot; or Left(eltStereo,4) &lt;&gt; &quot;TFCS&quot; then&#xA;		' Handle drop of non-TFCS elements&#xA;		dim eltType : eltType = eltDropped.Type&#xA;		if eltType = &quot;Artifact&quot; _&#xA;			or eltType = &quot;Note&quot; _&#xA;			or eltType = &quot;Text&quot; _&#xA;			or eltType = &quot;Constraint&quot; _&#xA;			or eltType = &quot;Boundary&quot; _&#xA;			or eltType = &quot;Package&quot; _&#xA;			or eltType = &quot;UMLDiagram&quot; Then&#xA;			' Allowed, standard EA handling&#xA;			EAST.LogInfo(&quot;Drop of artifact,note,text,constraint,boundaries on TFCS dgm =&gt; OK&quot;)&#xA;		elseif eltType = &quot;&quot; then&#xA;			EAST.LogWarning(&quot;Inserting new element: elementtype missing (maybe copy-paste?) =&gt; silently ignored&quot;)&#xA;			HandleDropElement = false&#xA;		else&#xA;			EAST.LogError(&quot;Non-TFCS element '&quot;+eltType+&quot;' drop on TFCS diagram '&quot;+dgmStereo+&quot;' =&gt; not allowed &quot;)&#xA;			HandleDropElement = false&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;		end if&#xA;	else&#xA;		' Handle drop of TFCS elements/stereotypes on TFCS diagrams&#xA;		select case dgmStereo &#xA;			case &quot;TFCS::TFCS_FlowsDiagram&quot;&#xA;				if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;					&quot;,TFCS_Actor,TFCS_Workflow&quot; + _&#xA;					&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;					EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWSDGM),16,DDH_TITLE_NOTALL&#xA;					HandleDropElement = false&#xA;				end if&#xA;			case &quot;TFCS::TFCS_FlowDefnDiagram&quot; &#xA;				if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;					&quot;,TFCS_Actor,TFCS_Workflow&quot; + _&#xA;					&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;					if InStr(&quot;TFCS_DomainObject,&quot;,eltStereo+&quot;,&quot;) &gt; 0 then&#xA;						EAST.MsgBox DDH_PROMPT_USE_TOOLBOX,16,DDH_TITLE_NOTALL&#xA;					else&#xA;						EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDEFDGM),16,DDH_TITLE_NOTALL&#xA;					end if&#xA;					HandleDropElement = false&#xA;				end if&#xA;			case &quot;TFCS::TFCS_FlowDiagram&quot;&#xA;				if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;					&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;					if InStr(&quot;TFCS_Event,TFCS_MergeNode,TFCS_Decision,TFCS_IntermediateResult,TFCS_AtomicAction,TFCS_CompositeActivity&quot;+ _&#xA;						&quot;,TFCS_ActivityFinal,TFCS_ActivityInitial,TFCS_CompositeAction,TFCS_Workflow,TFCS_DomainObject&quot;+ _&#xA;						&quot;,TFCS_DomainInstance,TFCS_AuthorisationEffect,TFCS_Action,TFCS_Authorisation,TFCS_GUI,&quot;,eltStereo+&quot;,&quot;) &gt; 0 then&#xA;						EAST.MsgBox DDH_PROMPT_USE_TOOLBOX,16,DDH_TITLE_NOTALL&#xA;					else&#xA;						EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDGM),16,DDH_TITLE_NOTALL&#xA;					end if&#xA;					HandleDropElement = false&#xA;				end if&#xA;			case &quot;TFCS::TFCS_DomainDiagram&quot; &#xA;				if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;					&quot;,TFCS_DomainObject,TFCS_DomainRule&quot; + _&#xA;					&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;					EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_DOMAINDGM),16,DDH_TITLE_NOTALL&#xA;					HandleDropElement = false&#xA;				end if&#xA;			case &quot;TFCS::TFCS_RequirementsDiagram&quot;&#xA;				if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;					&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation,TFCS_Authorisation,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;					EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_REQDGM),16,DDH_TITLE_NOTALL&#xA;					HandleDropElement = false&#xA;				end if&#xA;			case &quot;TFCS::TFCS_MaintenanceDiagram&quot; &#xA;				if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;					EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_MNTDGM),16,DDH_TITLE_NOTALL&#xA;					HandleDropElement = false&#xA;				end if&#xA;			case else&#xA;				EAST.LogError(&quot;Drops on TFCS diagram type '&quot;+dgmStereo+&quot;' not yet defined =&gt; not allowed&quot;)&#xA;				EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;				HandleDropElement = false&#xA;		end select&#xA;	end if&#xA;	if not HandleDropElement then&#xA;		EAST.LogError(&quot;Element can't be dropped from projectbrowser or not allowed&quot;)&#xA;	end if&#xA;	EAST.LogEnd(&quot;HandleDropElement&quot;)&#xA;end function&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="224"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{D75AE92D-C904-4153-A739-301C2E4AE808}"/>
			<Column name="ScriptAuthor" value="{8AEAB418-600A-48bb-9A45-15C360C4006E}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;aaa&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC Local Scripts.EAConstants-VBScript&#xA;&#xA;'&#xA;' Script Name: &#xA;' Author: &#xA;' Purpose: &#xA;' Date: &#xA;'&#xA;sub main&#xA;	dim model : set model = Repository.Models.GetByName(&quot;Systeemdocumentatie EDDA&quot;)&#xA;	dim pck as EA.Package&#xA;	set pck = model.Packages.GetByName(&quot;Werkmappen&quot;)&#xA;	set pck = pck.Packages.GetByName(&quot;paulus&quot;)&#xA;	dim dgm as EA.Diagram&#xA;	set dgm = pck.Diagrams.GetByName(&quot;paulusai&quot;)&#xA;	dim obj as EA.DiagramObject&#xA;	set obj = dgm.DiagramObjects.GetAt(2)&#xA;	session.output(obj.ElementID)	&#xA;	dgm.SelectedObjects.addnew obj.ElementID,obj.ElementID &#xA;	&#xA;end sub&#xA;&#xA;main"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="225"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{BD160839-751B-4ea5-874E-580BDBC87F5D}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_GenerateDocContext&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Component for creating document containing an element with allits surroundings&#xA;' NOTE: the generated document is in RTF which doesn't compress images very well/at all, so the RTF is &#xA;' converted to word after generation.&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Core.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;!INC TFCS_Support.TFCS_DocumentGeneration&#xA;&#xA;' Generating element context&#xA;const ELTX_CONTEXT_MASTER = &quot;TFCS_ContextMaster&quot;&#xA;const ELTX_CONTEXT_DIAGRAM = &quot;TFCS_ContextDiagram&quot;&#xA;'const ELTX_WFSPEC_FLOWREMARKS = &quot;TFCS_WFSpecFlowRemarks&quot;&#xA;'const ELTX_WFSPEC_COMPDGM = &quot;TFCS_WFSpecCompFlowDiagram&quot;&#xA;&#xA;' Add a menuitem to the project browser context menu&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	if MenuLocation = &quot;TreeView&quot; and MenuName = MNU_TFCSMAIN then&#xA;		dim item: set item = GetTreeSelectedObject()&#xA;		Select Case item.ObjectType&#xA;			Case 4&#xA;				EA_GetMenuItems = MNU_GENERATECONTEXTRTF&#xA;			Case 5 &#xA;				EA_GetMenuItems = MNU_GENERATECONTEXTRTF&#xA;			Case Else&#xA;				' No context-specific items&#xA;		end select&#xA;	end if&#xA;end Function&#xA;&#xA;' Handle click event&#xA;'dim oWord,oFSO&#xA;Sub EA_MenuClick( MenuName , ItemName )&#xA;	if Menuname = MNU_TFCSMAIN and itemName = MNU_GENERATECONTEXTRTF then&#xA;		dim path: path = EAST.FolderBrowserDialog(DOCGEN_OUTPUT_LOCATION)&#xA;		if path &lt;&gt; &quot;&quot; then&#xA;			dim item: set item = GetTreeSelectedObject()&#xA;'			Set oWord = CreateObject(&quot;Word.Application&quot;)&#xA;'			Set oFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xA;'			oWord.Visible = True&#xA;			GenerateContextDocumentRTF item,path&#xA;'			oWord.Quit&#xA;'			set oWord = nothing&#xA;'			set oFSO = nothing&#xA;			EAST.MsgBox &quot;Context is opgenomen onder &quot;+ _&#xA;				vbCRLF+path+vbCRLF+vbCRLF+&quot;LET OP de documenten zijn in RTF formaat.&quot;+vbCRLF+ _&#xA;				&quot;Gebruik MSWord om elk document om te zetten in Word formaat.&quot;,0,&quot;Genereren context documentatie&quot;&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;' Generate a document containing all diagrams that include a specific element&#xA;' IN: an EA.Element and location for output&#xA;' NOTES: &#xA;'	- Uses templates ELTX_ContextPreface for general document layout and ELTX_ContextDiagram for each diagram found&#xA;sub GenerateContextDocumentRTF(item,rootPath)&#xA;	EAST.LogStart &quot;GenerateContextDocumentRTF(&quot;&amp;item.Name&amp;&quot;)&quot;&#xA;&#xA;	dim elt as EA.Element&#xA;	set elt = item&#xA;&#xA;	dim path: path = rootPath+&quot;/Context_&quot;&amp;elt.Name&amp;&quot;.rtf&quot;&#xA;	&#xA;	dim gen as EA.DocumentGenerator&#xA;	set gen = Repository.CreateDocumentGenerator()&#xA; &#xA;	if not gen.NewDocument(&quot;&quot;) then&#xA;		EAST.LogError &quot;Unable to create a new document: &quot; + gen.GetLastError()&#xA;		EAST.LogEnd &quot;GenerateContextDocumentRTF&quot;&#xA;		exit sub&#xA;	end if&#xA;	&#xA;	' If the element has a linked document, use that as a template for the main body of the document&#xA;	' If not use a standard template 'ELTX_ContextPreface'&#xA;	if not gen.InsertLinkedDocument(elt.ElementGUID) then&#xA;		EAST.LogWarning &quot;Element has no linked document or unable to load a linked document, defaulting to standard template 'ELTX_CTXT_PREFACE'&quot;&#xA;		if not gen.DocumentElement(elt.ElementID,0,ELTX_CONTEXT_MASTER) then&#xA;			EAST.LogError &quot;Unable to generate preface (is 'ELTX_CTXT_PREFACE' missing?): &quot; + gen.GetLastError()&#xA;		end if&#xA;	end if&#xA;	&#xA;	dim name: name = elt.Name&#xA;	if name = &quot;&quot; then name = &quot;&lt;omschrijving ontbreekt&gt;&quot; end if&#xA;&#xA;	' Document all diagrams including this element&#xA;	dim diagrams: Set diagrams =  EAST.ExecuteSQL(DOCGEN_SQL_DIAGRAMSWITHELT,elt.ElementGUID)&#xA;	if diagrams.count &gt; 0 then&#xA;		gen.InsertText &quot;Directe verwijzingen '&quot;+name+&quot;'&quot;+vbCRLF,&quot;Heading 2&quot;&#xA;	end if&#xA;	dim	diagram&#xA;	for each diagram in diagrams.Items	&#xA;		dim DiagramGUID: DiagramGUID = diagram.item(&quot;EA_GUID&quot;)&#xA;		EAST.LogInfo(&quot;Adding diagram: &quot;&amp;DiagramGUID)&#xA;		If not gen.DocumentDiagram(diagram.item(&quot;ID&quot;),0,ELTX_CONTEXT_DIAGRAM) then&#xA;			gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_CONTEXT_DIAGRAM+&quot;' for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;			EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_CONTEXT_DIAGRAM+&quot;' for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;		end if&#xA;	next&#xA;&#xA;	' Document all diagrams including this element - as classifier-&#xA;	Set diagrams = EAST.ExecuteSQL(DOCGEN_SQL_DIAGRAMSWITHELTASCLASSIFIER,elt.ElementGUID)&#xA;	if diagrams.count &gt; 0 then&#xA;		gen.InsertText &quot;Indirecte verwijzingen '&quot;+name+&quot;'&quot;+vbCRLF,&quot;Heading 2&quot;&#xA;	end if&#xA;	for each diagram in diagrams.Items	&#xA;		DiagramGUID = diagram.item(&quot;EA_GUID&quot;)&#xA;		EAST.LogInfo(&quot;Adding diagram: &quot;&amp;DiagramGUID)&#xA;		If not gen.DocumentDiagram(diagram.item(&quot;ID&quot;),0,ELTX_CONTEXT_DIAGRAM) then&#xA;			gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_CONTEXT_DIAGRAM+&quot;' for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;			EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_CONTEXT_DIAGRAM+&quot;' for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;		end if&#xA;	next&#xA;	&#xA;	if not gen.ReplaceField(SYSTEM,EAST.GetModelForPackage(item.packageID).name) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+SYSTEM+&quot;' with value '&quot;+EAST.GetModelForPackage(item.packageID).name+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	if not gen.ReplaceField(AUTEUR,EAST.UserName()) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+AUTEUR+&quot;' with value '&quot;+EAST.UserName()+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	if not gen.SaveDocument(path,0) then&#xA;		EAST.LogError &quot;Unable to save document to '&quot;+path+&quot;': &quot; + gen.GetLastError()&#xA;	else&#xA;		EAST.LogInfo &quot;Generated '&quot;+path+&quot;' for element '&quot; + elt.Name+&quot;'&quot;&#xA;	end if&#xA;&#xA;	EAST.LogEnd &quot;GenerateContextDocumentRTF&quot;&#xA;end sub&#xA;&#xA;sub DocumentRemarks(gen,DiagramGUID)&#xA;	dim notes: Set notes =  EAST.ExecuteSQL(DOCGEN_SQL_DGM_REMARKSFORDGM,DiagramGUID)&#xA;	if notes is nothing then&#xA;		gen.InsertText &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; ,&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; &#xA;	else&#xA;		if notes.count &gt; 0 then&#xA;			gen.InsertText &quot;Toelichting bij de flow&quot;+vbCrlf,&quot;Strong&quot;&#xA;			dim eltRTF as EA.Element&#xA;			dim note&#xA;			for each note in notes.Items&#xA;				set eltRTF = GetElementByID(note.item(&quot;OBJECT_ID&quot;))&#xA;				if not gen.DocumentElement(eltRTF.ElementID,0,ELTX_WFSPEC_FLOWREMARKS) then&#xA;					EAST.LogError &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;				end if&#xA;			next&#xA;		end if&#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="226"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{F84E00CC-793B-4eca-B313-69DC30FAA19A}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="TFCS_Core"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="227"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{34C059F2-ED0A-431f-B78E-5326786C3B43}"/>
			<Column name="ScriptAuthor" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;New script&quot; Type=&quot;Internal&quot; Language=&quot;JavaScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC Local Scripts.EAConstants-JScript&#xA;&#xA;/*&#xA; * Script Name: &#xA; * Author: &#xA; * Purpose: &#xA; * Date: &#xA; */&#xA; &#xA;function main()&#xA;{&#xA;	// TODO: Enter script code here!&#xA;}&#xA;&#xA;main();"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="228"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{FC319E6C-AA40-4218-8AAE-27F6F3C23439}"/>
			<Column name="ScriptAuthor" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;GenerateWFSpecUsingFSTemplate&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' BACKUP TBV HERGEBRUIK TECHNISCH CONCEPT - VERDER ACHTERHAALD&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;&#xA;const ELTX_WFSPEC_MASTER = &quot;TFCS_WFSpecMaster&quot;&#xA;'const ELTX_WFSPEC_PREFACE = &quot;ELTX_Preface&quot;&#xA;const ELTX_WFSPEC_UCDEF = &quot;ELTX_WFSpecDiagram&quot;&#xA;&#xA;const SYSTEM = &quot;SYSTEM&quot;&#xA;const WORKFLOW_NAME = &quot;WORKFLOW&quot;&#xA;const WORKFLOW_VERSION = &quot;VERSION&quot;&#xA;&#xA;' Add a menuitem to the project browser context menu&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	if MenuLocation = &quot;TreeView&quot; and MenuName = MNU_TFCSMAIN then&#xA;		dim result(1)&#xA;		result(0) = &quot;-&quot;&#xA;		result(1) = MNU_GENERATE_WFSPEC&#xA;		dim item: set item = GetTreeSelectedObject()&#xA;		Select Case item.ObjectType&#xA;			Case 4&#xA;				if(item.Stereotype = &quot;TFCS_Activity&quot; or item.Stereotype = &quot;TFCS_Workflow&quot;) then&#xA;					EA_GetMenuItems = result&#xA;				end if&#xA;			Case 5 &#xA;				EA_GetMenuItems = result&#xA;			Case Else&#xA;				' No context-specific items&#xA;		end select&#xA;	end if&#xA;end Function&#xA;&#xA;' Handle click event&#xA;Sub EA_MenuClick( MenuName , ItemName )&#xA;	if Menuname = MNU_TFCSMAIN and itemName = MNU_GENERATE_WFSPEC then&#xA;east.logwarning(&quot;TFCS_GenerateDocWFSpec - zet pad selectie weer aan&quot;)&#xA;		dim path: path = &quot;C:/TFCS&quot; 'EAST.FolderBrowserDialog(RTFGEN_OUTPUT_LOCATION)&#xA;		if path &lt;&gt; &quot;&quot; then&#xA;			dim item: set item = GetTreeSelectedObject()&#xA;			if item.ObjectType = 4 then&#xA;				if item.Stereotype = &quot;TFCS_Workflow&quot; then&#xA;					' The generator expects an element of type TFCS_Activity&#xA;					item = GetElementByID(item.ParentID) &#xA;				end if&#xA;			end if&#xA;			GenerateWorkflowSpecification item,path&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;const TFCSBASEDIR = &quot;T:/Projecten/Project CDD/Beheer werkdocumenten/Systeemdocumentatie/100 EA Repository/TFCS/Configuratie&quot;&#xA;const ELT_MASTERDOCUMENT = &quot;GenerateWorkflowSpecification&quot;&#xA;&#xA;sub GenerateWorkflowSpecification(item,path)&#xA;	' create element for linked master document&#xA;	dim pck as EA.Package&#xA;	set pck = EAST.GetPackageByFQN(GEN__WORKSPACE+&quot;.&quot;+EAST.UserName()+&quot;.temp&quot;,true)&#xA;	dim elt as EA.Element&#xA;	set elt = pck.Elements.GetByName(ELT_MASTERDOCUMENT)&#xA;	if elt is nothing then&#xA;		set elt = pck.Elements.AddNew(&quot;&quot;,&quot;Class&quot;)&#xA;		elt.name = ELT_MASTERDOCUMENT&#xA;	end if&#xA;	elt.LoadLinkedDocument(TFCSBASEDIR+&quot;/reporttemplates/&quot;+ELTX_WFSPEC_MASTER+&quot;.rtf&quot;)&#xA;	elt.Update()&#xA;&#xA;	if GenerateWFSpecificationRTF(item,path,elt) then&#xA;		EAST.LogError(&quot;Convert to MS Word!!!&quot;)&#xA;	end if&#xA;&#xA;end sub&#xA;&#xA;' Generate a workflow specification document for the element/elements within a package&#xA;' IN: item = an EA.Element of type TFCS_Activity, or a package&#xA;'     path = location for generated files&#xA;' NOTES:&#xA;'	- Uses templates ELTX_WFSpecPreface for general document layout and ELT_WFSpecDiagram for each diagram found&#xA;'	- pakages are searched recursively for elements of type 'TFC_Activity'&#xA;function GenerateWFSpecificationRTF(item,rootPath,master)&#xA;	EAST.LogStart &quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;&#xA;	GenerateWFSpecificationRTF = false&#xA;	&#xA;	dim pck&#xA;	Select Case item.ObjectType&#xA;		case 5&#xA;			' Recursively handle packages&#xA;			dim elt&#xA;			for each elt in item.Elements&#xA;				if elt.Stereotype = &quot;TFCS_Activity&quot; then&#xA;					GenerateWFSpecificationRTF elt,rootPath,master&#xA;				end if&#xA;			next&#xA;			for each pck in item.Packages&#xA;				GenerateWFSpecificationRTF pck,rootPath,master&#xA;			next&#xA;			EAST.LogEnd(&quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;)&#xA;			exit function&#xA;	end select&#xA;	&#xA;	dim ucAct as EA.Element&#xA;	set ucAct = item ' ... just so we can use inellisense support of the EA script editor (item is not typed)&#xA;&#xA;	' Handle a single element&#xA;	dim path: path = rootPath+&quot;/Spec_&quot;&amp;ucAct.Name&amp;&quot;.rtf&quot;&#xA;	&#xA;	' Prepare: get all involved model elements&#xA;	dim dgmSpec as EA.Diagram&#xA;	set dgmSpec = ucAct.CompositeDiagram&#xA;&#xA;	dim uc as EA.Element&#xA;	dim dgmFlow as EA.Diagram&#xA;	set uc = ucAct.Elements.GetByName(ucAct.Name)&#xA;	set dgmFlow = uc.CompositeDiagram&#xA;&#xA;	dim gen as EA.DocumentGenerator&#xA;	set gen = Repository.CreateDocumentGenerator()&#xA; &#xA;	if not gen.NewDocument(&quot;&quot;) then&#xA;		EAST.LogError &quot;Unable to create a new document: &quot; + gen.GetLastError()&#xA;		EAST.LogEnd &quot;GenerateWFSpecificationRTF&quot;&#xA;		exit function&#xA;	end if&#xA;	&#xA;'	' Use a 'master document' as template for the overall layout of the document&#xA;'	if not gen.InsertLinkedDocument(master.ElementGUID) then&#xA;'		EAST.LogError &quot;Unable to include the master document: &quot; + gen.GetLastError()&#xA;'		EAST.LogEnd &quot;GenerateWFSpecificationRTF&quot;&#xA;'		exit function&#xA;'	end if&#xA;'&#xA;'	if not gen.ReplaceField(WORKFLOW_NAME,uc.name) then&#xA;'		EAST.LogError &quot;Unable to replae field '&quot;+WORKFLOW_NAME+&quot;' with value '&quot;+uc.Name+&quot;': &quot;+ gen.GetLastError()&#xA;'	end if&#xA;'	if not gen.ReplaceField(WORKFLOW_VERSION,uc.Version) then&#xA;'		EAST.LogError &quot;Unable to replae field '&quot;+WORKFLOW_VERSION+&quot;' with value '&quot;+uc.Version+&quot;': &quot; + gen.GetLastError()&#xA;'	end if&#xA;&#xA;	if not gen.DocumentElement(ucAct.ElementID,0,ELTX_WFSPEC_MASTER) then&#xA;		EAST.LogError &quot;Unable to generate preface: from template '&quot;+ELTX_WFSPEC_MASTER+&quot;': &quot; + gen.GetLastError()&#xA;	end if&#xA;	if not gen.ReplaceField(SYSTEM,EAST.GetModelForPackage(uc.packageID).name) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+SYSTEM+&quot;' with value '&quot;+EAST.GetModelForPackage(uc.packageID).name+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	EAST.LogInfo(&quot;Adding UC spec diagram: &quot;&amp;dgmSpec.DiagramGUID)&#xA;	If not gen.DocumentDiagram(dgmSpec.DiagramID,0,ELTX_WFSPEC_UCDEF) then&#xA;		gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_UCDEF+&quot;' for diagram GUID='&quot;+dgmSpec.DiagramGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_UCDEF+&quot;' for diagram GUID='&quot;+dgmSpec.DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;	end if&#xA;	&#xA;	EAST.LogInfo(&quot;Adding UC flow diagram: &quot;&amp;dgmFlow.DiagramGUID)&#xA;	gen.InsertText &quot;Realisatie&quot;,&quot;Heading 1&quot; &#xA;	DocumentFlowDiagram gen, dgmFlow,1&#xA;	&#xA;	if not gen.SaveDocument(path,0) then&#xA;		EAST.LogError &quot;Unable to save document to '&quot;+path+&quot;': &quot; + gen.GetLastError()&#xA;	else&#xA;		EAST.LogInfo &quot;Generated '&quot;+path+&quot;' for element '&quot; + item.Name+&quot;'&quot;&#xA;	end if&#xA;&#xA;	EAST.LogEnd &quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;&#xA;end function&#xA;&#xA;function DocumentFlowDiagram(gen,dgm,level)&#xA;'	if level &gt; 1 then&#xA;'		gen.InsertText &quot;TBD: Subflow: &quot;*dgm.Name,&quot;Heading &quot;&amp;level&#xA;'	end if&#xA;'	If not gen.DocumentDiagram(dgmFlow.DiagramGUID,0,&quot;ELTX_WFSpecDiagram&quot;) then&#xA;'		gen.InsertText &quot;Unable to generate from template 'ELTX_WFSpecDiagram' for diagram GUID='&quot;+dgmFlow.DiagramGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;'		EAST.LogWarning &quot;Unable to generate from template 'ELTX_WFSpecDiagram' for diagram GUID='&quot;+dgmFlow.DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;'	end if&#xA;'	&#xA;'	EAST.LogInfo(&quot;Recursively adding copmonent &amp; screen diagrams... &quot;.)&#xA;'		gen.InsertText &quot;TBD: Componenten en schermen&quot;,&quot;Heading &quot;&amp;level&#xA;'	end if&#xA;'	dim notes: Set notes =  EAST.ExecuteSQL(RTFGEN_SQL_DGM_REMARKSFORDGM,DiagramGUID)&#xA;'		if notes is nothing then&#xA;'			gen.InsertText &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; ,&quot;Strong&quot;&#xA;'			EAST.LogWarning &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; &#xA;'		else&#xA;'			if notes.count &gt; 0 then&#xA;'				if not gen.InsertText(&quot;Remarks&quot;,&quot;Strong&quot;) then&#xA;'					EAST.LogError &quot;Unable to generate notes header for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;'				else&#xA;'					' construct the text to add in RTF format&#xA;'					Dim html: html = &quot;&quot;&#xA;'					Dim note&#xA;'					for each note in notes.Items&#xA;'						html = html + &quot;&lt;br&gt;&quot;+note.item(&quot;REMARK&quot;)&#xA;'					next&#xA;'					if not gen.InsertText(EAST.HTML2Text(html),&quot;Normal&quot;) then&#xA;'						EAST.LogError &quot;Unable to generate note for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;'					end if&#xA;'				end if&#xA;'			end if&#xA;'		end if&#xA;'		if not gen.InsertBreak(0) then&#xA;'			EAST.LogError &quot;Unable to generate page break: &quot; + gen.GetLastError()&#xA;'		end if&#xA;'	end if	&#xA;end function&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="229"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{DB346A7B-9192-4bee-ADB6-FC07B6D19D52}"/>
			<Column name="ScriptAuthor" value="{F84E00CC-793B-4eca-B313-69DC30FAA19A}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_Constants&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="&#xA;'const TFCSBASEDIR = &quot;T:/Projecten/Project CDD/Beheer werkdocumenten/Systeemdocumentatie/100 EA Repository/TFCS/Configuratie&quot;&#xA;const TFCSBASEDIR = &quot;G:/TFCS/beheer&quot;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="230"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{B8494864-F895-45c3-92A5-68464C37423E}"/>
			<Column name="ScriptAuthor" value="{58CA235E-3E44-4a0a-A9F7-56A68EADD84F}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;xxx&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="option explicit&#xA;&#xA;!INC Local Scripts.EAConstants-VBScript&#xA;&#xA;'&#xA;' Script Name: &#xA;' Author: &#xA;' Purpose: &#xA;' Date: &#xA;'&#xA;sub main&#xA;	' TODO: Enter script code here!&#xA;end sub&#xA;&#xA;main"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="231"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{72C04D72-8B9E-47a5-B115-791084D9DCF5}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_DocumentGeneration&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Module containing helper methods for document generation&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;const SYSTEM = &quot;SYSTEM&quot;&#xA;const AUTEUR = &quot;AUTEUR&quot;&#xA;&#xA;' Include notes from all elements in a specific diagram within a boundary 'Toelichting'&#xA;' in the document currently being generated.&#xA;sub DocumentRemarks(gen,DiagramGUID,template)&#xA;	dim notes: Set notes =  EAST.ExecuteSQL(DOCGEN_SQL_DGM_REMARKSFORDGM,DiagramGUID)&#xA;	if notes is nothing then&#xA;		gen.InsertText &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; ,&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; &#xA;	else&#xA;		if notes.count &gt; 0 then&#xA;			gen.InsertText &quot;Toelichting bij de flow&quot;+vbCrlf,&quot;Strong&quot;&#xA;			dim eltRTF as EA.Element&#xA;			dim note&#xA;			for each note in notes.Items&#xA;				set eltRTF = GetElementByID(note.item(&quot;OBJECT_ID&quot;))&#xA;				if not gen.DocumentElement(eltRTF.ElementID,0,template) then&#xA;					EAST.LogError &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;				end if&#xA;			next&#xA;		end if&#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
	</DataSet>
</RefData>
