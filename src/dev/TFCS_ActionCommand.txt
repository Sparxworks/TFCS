option explicit

'----------------------------------------------------------------------------------------------------------------------
' Handles doubleclicked on en element of stereotype TFCS_Script by executing the content of the notes
' field as (VB)Script
'----------------------------------------------------------------------------------------------------------------------
'option explicit

Function EA_OnContextItemDoubleClicked(GUID,ot)
	EA_OnContextItemDoubleClicked = false
	if ot = 4 then
		Dim elt : 
		set elt = GetElementByGuid(GUID)
		if elt.Stereotype = "SCRIPT" then
			EAST.RunScript "VBSCRIPT",GetFormatFromField("TXT",elt.Notes)
			EA_OnContextItemDoubleClicked = true
		end if
	end if
end function

' Prevent any action elements with stereotype SCRIPT to be removed from a diagram
Function EA_OnPreDeleteDiagramObject( Info ) 
	EA_OnPreDeleteDiagramObject = true

	dim elt: set elt = GetElementByID(Info.get("ID").Value)
	if elt.Stereotype = "SCRIPT" and elt.Type = "Action" then
		EA_OnPreDeleteDiagramObject = false
	end if
end Function
