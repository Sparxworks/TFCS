<?xml version="1.0" encoding="windows-1252"?>
<RefData version="1.0" exporter="EA.25">
	<DataSet name="Automation Scripts" table="t_script" filter="ScriptName='#ScriptName#' and ScriptCategory='#ScriptCategory#'" stoplist=";ScriptID;">
		<DataRow>
			<Column name="ScriptID" value="404"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{E5E09718-35FF-4805-BC63-95841AC88A91}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_MainMenu&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Add a menu item named 'TFCS' to the EA context menu's.&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit &#xA;&#xA;!INC TFCS_Support.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;'&#xA;' Display a main menu 'TFCS' for treeview and diagram&#xA;'&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	set EA_GetMenuItems = nothing&#xA;	&#xA;	if(MenuLocation = &quot;Diagram&quot; and MenuName = &quot;&quot;) then&#xA;		Dim dgm as EA.Diagram&#xA;		set dgm = Repository.GetCurrentDiagram()&#xA;		if(Left(GetStyleEx(dgm,&quot;MDGDgm&quot;),4) = &quot;TFCS&quot;)then&#xA;' Currently no specific diagram context menus in TFCS so don't create the main menu&#xA;'			EA_GetMenuItems = &quot;TFCS&quot;&#xA;		end if&#xA;	elseif MenuLocation = &quot;TreeView&quot; and MenuName = &quot;&quot; then&#xA;		EA_GetMenuItems = MNU_TFCSMAIN&#xA;	end if&#xA;end Function&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="405"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{3B45B068-E384-44a4-A3C5-E5A48C55EE3E}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_WorkflowCreation&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Creation of a new workflow of a specific type (UC/WI/BP)&#xA;'&#xA;' This module contains no event handlers only supporting functions, so registration with EAST is indirect, through&#xA;' inclusion within other modules&#xA;'&#xA;' Creates the following structure in the private workspace of the user, in package 'Workflows':&#xA;' 	&lt;WF package&gt;&#xA;'		&lt;WF activity&gt;&#xA;'			&lt;WF&gt;&#xA;'				&lt;default WF realisation diagram&gt;&#xA;'			&lt;default WF specification diagram&gt;&#xA;'&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;Function CreateWorkFlowForModel(dgm, flowType,flowPrefix,model)&#xA;	set CreateWorkFlowForModel = nothing&#xA;	dim thePackage : set thePackage = GetPrivatePackage(model,GEN__PCK_WORKFLOWS)&#xA;	&#xA;	' Get the name for the new WF&#xA;	dim answer: answer = EAST.InputBox(&quot;Naam (zonder prefix '&quot;+flowPrefix+&quot;-') : &quot;,&quot;Toevoegen nieuwe &quot;+flowType,&quot;000 - Mijn &quot;+flowType)&#xA;	if answer = empty or answer = &quot;&quot; then&#xA;		exit function&#xA;	end if&#xA;	dim ucName : ucName = flowPrefix+&quot;-&quot;+ answer&#xA;&#xA;' -------------------------------------------------------&#xA;' 	&lt;WF package&gt;&#xA;' -------------------------------------------------------&#xA;	dim ucPackage :	set ucPackage = thePackage.packages.AddNew(ucName, &quot;Class&quot; )&#xA;	ucPackage.Update()&#xA;	&#xA;' -------------------------------------------------------&#xA;'		&lt;WF activity&gt;&#xA;' -------------------------------------------------------&#xA;	dim ucActivity : set ucActivity = ucPackage.elements.AddNew(ucName, &quot;TFCS::TFCS_Activity&quot; )&#xA;	ucPackage.Elements.Refresh()&#xA;&#xA;' -------------------------------------------------------&#xA;'			&lt;WF&gt;&#xA;'				&lt;default WF realisation diagram&gt;&#xA;' -------------------------------------------------------&#xA;	dim uc : set uc = ucActivity.elements.AddNew( ucActivity.Name, &quot;TFCS::TFCS_WorkFlow&quot; ) &#xA;	SetTagValByName uc.TaggedValues,&quot;WorkflowType&quot;,flowType,&quot;&quot;&#xA;&#xA;	dim ucReal : set ucReal = uc.CompositeDiagram&#xA;	ucReal.Name = flowPrefix+&quot;R-&quot;+answer&#xA;	ucActivity.Elements.Refresh()&#xA;	SetStyleEX ucReal,&quot;ShowDiagramInPages&quot;,&quot;1&quot;&#xA;	ucReal.Update()&#xA;	uc.Update()&#xA;&#xA;	' Populate UC realization diagram&#xA;	' Diagram notes&#xA;	dim dgmLabel : set dgmLabel = uc.Elements.AddNew(&quot;&quot;,&quot;Text&quot;)&#xA;	dgmLabel.Subtype = 18&#xA;	dgmLabel.Update()&#xA;	dim dgmObject : set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=5;t=5;r=10;b=10;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmLabel.ElementID )&#xA;	dgmObject.Style = &quot;NSL=1&quot;&#xA;	dgmObject.Update()&#xA;	&#xA;	' TODO note&#xA;	addPostIt ucActivity,ucReal,&quot;l=250;t=27;r=400;b=85;&quot;,&quot;&lt;b&gt;TODO&lt;/b&gt;: stappenplan nog uitwerken&quot;&#xA;	set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=559;t=27;r=701;b=85;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( ucActivity.ElementID )&#xA;	dgmObject.Style = &quot;NSL=1&quot;&#xA;	dgmObject.Update()&#xA;	&#xA;	' Default flow: start&#xA;	dim eltStart&#xA;	set dgmElement = uc.Elements.AddNew(&quot;Start&quot;,&quot;StateNode&quot;)&#xA;	dgmElement.Subtype = 100 'for ActivityInitial&#xA;	dgmElement.Stereotype = &quot;TFCS_ActivityInitial&quot;&#xA;	dgmElement.Update()&#xA;	set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=371;t=116;r=396;b=140;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmElement.ElementID )&#xA;	dgmObject.Update()&#xA;	set eltStart = dgmElement&#xA;&#xA;	' Default flow: action&#xA;	dim eltAction&#xA;	dim dgmElement: set dgmElement = uc.Elements.AddNew(&quot;Flow of &quot;+ucName,&quot;TFCS::TFCS_AtomicAction&quot;)&#xA;	dgmElement.Update()&#xA;	set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=331;t=180;r=436;b=250;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmElement.ElementID )&#xA;	dgmObject.Update()&#xA;	set eltAction = dgmElement&#xA;&#xA;	' Default flow: end&#xA;	dim eltEnd&#xA;	set dgmElement = uc.Elements.AddNew(&quot;Einde&quot;,&quot;StateNode&quot;)&#xA;	dgmElement.Subtype = 101 'for ActivityFinal&#xA;	dgmElement.Stereotype = &quot;TFCS_ActivityFinal&quot;&#xA;	dgmElement.Update()&#xA;	set dgmObject = ucReal.diagramObjects.AddNew( &quot;l=371;t=280;r=396;b=304;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmElement.ElementID )&#xA;	dgmObject.Update()&#xA;	set eltEnd = dgmElement&#xA;&#xA;	' Default flow: connect start-action and action-end&#xA;    dim conn : set conn = eltStart.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;)&#xA;	conn.SupplierID = eltAction.ElementID&#xA;    conn.Update()&#xA;	set conn = eltAction.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;)&#xA;	conn.SupplierID = eltEnd.ElementID&#xA;    conn.Update()&#xA;	&#xA;	ucReal.DiagramObjects.Refresh()&#xA;&#xA;' -------------------------------------------------------&#xA;'			&lt;default WF specification diagram&gt;&#xA;' -------------------------------------------------------&#xA;&#xA;	' Add usecase element&#xA;	dim ucSpec : set ucSpec = ucActivity.CompositeDiagram&#xA;	set dgmObject = ucSpec.diagramObjects.AddNew( &quot;l=331;t=416;r=436;b=486;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( uc.ElementID )&#xA;	dgmObject.Update()&#xA;	&#xA;	' Add diagramlabel&#xA;	set dgmElement = ucActivity.Elements.AddNew(&quot;&quot;,&quot;Text&quot;)&#xA;	dgmElement.Subtype = 18&#xA;	dgmElement.Update()&#xA;	set dgmObject = ucSpec.diagramObjects.AddNew( &quot;l=5;t=5;r=10;b=10;&quot;, &quot;&quot; )&#xA;	dgmObject.ElementID( dgmElement.ElementID )&#xA;	dgmObject.Style = &quot;NSL=1&quot;&#xA;	dgmObject.Update()&#xA;&#xA;	' Add TODO Notes&#xA;	set dgmObject = addPostIt(ucActivity,ucSpec,&quot;l=252;t=5;r=769;b=128;&quot;,&quot;&lt;&lt;korte omschrijving&gt;&gt;&quot;_&#xA;		+VbCrLf _&#xA;		+VbCrLf )&#xA;	dgmObject.Style = &quot;BCol=16249847;&quot;&#xA;	dgmObject.Update()&#xA;	addPostIt ucActivity,ucSpec,&quot;l=559;t=27;r=701;b=85;&quot;,&quot;&lt;b&gt;TODO&lt;/b&gt;: neem hier een korte beschrijving van de workflow op&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: platte tekst&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=256;r=564;t=819;b=885;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige requirements op waarin door deze workflow wordt voorzien.&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar autorisatieitems onder &lt;u&gt;\Requirements\...&lt;/u&gt;&lt;/font&gt;&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=30;t=799;r=186;b=927;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle autorisatie items op die binnen de workflow worden gebruikt&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar autorisatieitems onder &lt;font color='000ff'&gt;&lt;u&gt;\Requirements\Autorisaties&lt;/u&gt;&lt;/font&gt;&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=427;t=673;r=682;b=718;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige post-condities op&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: platte tekst&quot;  &#xA;	addPostIt ucActivity,ucSpec,&quot;l=68;t=670;r=323;b=715;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle overige pre-condities op&lt;u&gt;&quot;+ _&#xA;		VbCrLf +&quot;Vorm&lt;/u&gt;: platte tekst&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=537;t=404;r=761;b=498;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die door deze workflow worden verwijderd, gewijzigd, of gecreeerd&quot;+_&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=272;t=532;r=494;b=603;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die door deze workflow worden gelezen&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot; &#xA;	addPostIt ucActivity,ucSpec,&quot;l=41;t=409;r=220;b=493;&quot;,&quot;&lt;b&gt;TODO:&lt;/b&gt; neem hier alle objecten op die input zijn voor deze workflow&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: instanties van domeinobjecten onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Domeinmodel&lt;/u&gt;&lt;/font&gt;&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=177;t=289;r=589;b=368;&quot;,&quot;&lt;b&gt;TODO: &lt;/b&gt;neem hier alle extensie- en include- relaties op met andere workflows.&quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: Links naar de betreffende UC-es onder &lt;font color='#0000ff'&gt;&lt;u&gt;\Functioneel Ontwerp\Use cases&lt;/u&gt;&lt;/font&gt;&quot;+ _&#xA;		VbCrLf +VbCrLf +&quot;&lt;u&gt;Richtlijn&lt;/u&gt;: aan extended en included UC-es worden geen actoren gekoppeld (deze volgen impliciet uit het gebruik)&quot;&#xA;	addPostIt ucActivity,ucSpec,&quot;l=174;t=181;r=626;b=229;&quot;,&quot;&lt;b&gt;TODO: &lt;/b&gt;neem hier de relevante actoren op en koppel die aan de workflow &quot;+ _&#xA;		VbCrLf +&quot;&lt;u&gt;Vorm&lt;/u&gt;: links naar actoren onder &lt;font color='#0000ff'&gt;&lt;u&gt;\ProcesBeschrijvingen\Actoren&lt;/u&gt;&lt;/font&gt; met associatie met de workflow&quot;&#xA;	&#xA;	' Add boundaries&#xA;	addBoundary ucActivity,ucSpec,&quot;l=401;t=629;r=766;b=762;&quot;,&quot;Post-condities&quot;,1&#xA;	addBoundary ucActivity,ucSpec,&quot;l=22;t=769;r=197;b=1061;&quot;,&quot;Autorisaties&quot;,1&#xA;	addBoundary ucActivity,ucSpec,&quot;l=16;t=151;r=765;b=258;&quot;,&quot;Actoren&quot;,1&#xA;	addBoundary ucActivity,ucSpec,&quot;l=22;t=629;r=387;b=762;&quot;,&quot;Pre-condities&quot; ,1&#xA;	addBoundary ucActivity,ucSpec,&quot;l=207;t=769;r=766;b=1061;&quot;,&quot;Requirements&quot;,1&#xA;&#xA;	ucSpec.DiagramObjects.Refresh()&#xA;&#xA;	set CreateWorkFlowForModel = ucActivity&#xA;end function&#xA;&#xA;function getWorkflowPrefix(flowType)&#xA;	dim prefix&#xA;	if flowType = FLOWTYPE_UC then&#xA;		prefix = &quot;UC&quot;&#xA;	elseif flowType = FLOWTYPE_WI then&#xA;		prefix = &quot;WI&quot;&#xA;	elseif flowType = FLOWTYPE_WF then&#xA;		prefix = &quot;BP&quot;&#xA;	else&#xA;		EAST.LogWarning(&quot;Unkown flowtype: &quot;+flowType)&#xA;		prefix = &quot;UC&quot;&#xA;	end if&#xA;	&#xA;	getWorkflowPrefix = prefix&#xA;end function"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="406"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{79C79CD6-96BB-42c4-BC98-DBD91508C3A1}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_DeleteHandler&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Delete handler for diagram objects.&#xA;'&#xA;' - Prevent deletion of the navigate-back-option from WF realisation diagrams&#xA;' - If the corresponding model element is no longer included in any diagram =&gt; delete it as well&#xA;'   (only for basic elements that from a user perspective are owned by a specific diagram, &#xA;'   like action, descision,...)&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_commons&#xA;const DH_PROMPT_WFDEFDGM = &quot;Dit element is integraal onderdeel van dit diagram.&quot;&#xA;const DH_TITLE_DELETEELT = &quot;Verwijderen niet toegestaan&quot;&#xA;&#xA;const DELH_SQL_DGMOBJS = &quot;select count(*) as RESULT from t_diagramobjects where object_id = {0}&quot;&#xA;dim DELH_SQL_GET_WF_PARENT_DGM : DELH_SQL_GET_WF_PARENT_DGM = _&#xA;	 &quot; select d.diagram_id&quot; + _&#xA;	 &quot; from t_diagram d, t_object o&quot; + _&#xA;	 &quot; where d.parentID = o.parentid&quot; + _&#xA;	 &quot; and o.object_id = {0}&quot;&#xA;	 &#xA;Function EA_OnPreDeleteDiagramObject( Info ) &#xA;	EA_OnPreDeleteDiagramObject = true ' Continue calling other handlers&#xA;	&#xA;	dim result&#xA;	dim eltID: eltID = Info.get(&quot;ID&quot;).Value&#xA;	dim elt: set elt = GetElementByID(eltID)&#xA;	select case elt.Stereotype&#xA;		case &quot;TFCS_Action&quot;&#xA;		case &quot;TFCS_AtomicAction&quot;&#xA;		case &quot;TFCS_CompositeAction&quot;&#xA;		case &quot;TFCS_ActivityInitial&quot;&#xA;		case &quot;TFCS_ActivityFinal&quot;&#xA;		case &quot;TFCS_Decision&quot;&#xA;		case &quot;TFCS_MergeNode&quot;&#xA;		case &quot;TFCS_Event&quot;&#xA;		case &quot;TFCS_DomainInstance&quot;&#xA;		case &quot;TFCS_IntermediateResult&quot;&#xA;		case &quot;TFCS_AuthorisationEffect&quot;&#xA;		case &quot;TFCS_Workflow&quot;&#xA;			 set result = EAST.ExecuteSQL(DELH_SQL_GET_WF_PARENT_DGM,eltID)&#xA;			 if (not result is nothing) and result.count&gt;0 then&#xA;				if Cint(result.item(0).item(&quot;DIAGRAM_ID&quot;)) = GetCurrentDiagram().DiagramID then&#xA;					' Disallow deletion of a workflow element from its own definition diagram&#xA;					EAST.MsgBox DH_PROMPT_WFDEFDGM,16,DH_TITLE_DELETEELT&#xA;					EA_OnPreDeleteDiagramObject = false&#xA;					exit function&#xA;				end if&#xA;			end if&#xA;&#xA;		case &quot;TFCS_Activity&quot; 	&#xA;			' The only type of diagramobjects of this type are the ones implementing the &#xA;			' BACK option on WF realisation diagrams (normally located in the upper-left corner)&#xA;			' They should not be removed =&gt; prevent deletion&#xA;			EAST.MsgBox DH_PROMPT_WFDEFDGM,16,DH_TITLE_DELETEELT&#xA;			EA_OnPreDeleteDiagramObject = false&#xA;			exit function&#xA;		case else&#xA;			' Continue with other handlers&#xA;			exit function&#xA;	end select&#xA;	&#xA;	' The deleted diagram object is considered to be owned by the diagram so if the corresponding &#xA;	' model element is no longer included in any diagram =&gt; delete the model element as well&#xA;	result = EAST.ExecuteScalarSQL(DELH_SQL_DGMOBJS,Cstr(eltID))&#xA;	if (not TypeName(result) = &quot;Empty&quot;) and CInt(result) &lt;= 1  then&#xA;		EAST.LogInfo(&quot;Element no longer used&quot;)&#xA;		DeleteElementFromModel(elt)&#xA;		EA_OnPreDeleteDiagramObject = false&#xA;	end if&#xA;&#xA;end Function&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="407"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{29CD9063-E84D-4f3e-BFBF-BEF5756D577B}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_GUIConstraints&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Deviations from/constaints on the standard GUI of EA&#xA;'&#xA;' Note that it is not the intention of these scripts to completely prevent users from making mistakes,&#xA;' just the more obvious ones.&#xA;'&#xA;' A user can run ad-hoc checks to report all violations against (TFCS-) consistencyrules &#xA;' (module TFCS_ModelValidation)&#xA;'&#xA;' Possible extensions:&#xA;' - it should not be possible to create a WF definition or -realisation diagram using add diagram options&#xA;' - Tag WorkflowType must never be removed&#xA;' - Prevent creation of non-TFCS elements in TFCS packages&#xA;' - Prevent creation of TFCS elements on non-TFCS diagrams&#xA;' - naming convention UCactivity - UC - &amp; diagrams&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Changes navigation behavior:&#xA;' - double-clicking on a workflow 'Usecase' element on a WF overview dialog opens WF definition dgm&#xA;' - double-clicking on a workflow 'Action' element on a WF realisation dialog opens WF realisation dgm&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;Function EA_OnContextItemDoubleClicked(GUID, ot)&#xA;	EA_OnContextItemDoubleClicked = false ' continue processing unless...&#xA;	&#xA;	dim dgmStereo&#xA;	dim dgm as EA.Diagram&#xA;	dim elt as EA.Element&#xA;	set elt = GetElementByGuid(GUID)&#xA;	if not elt is Nothing then  ' eg doubleclicked on diagram...&#xA;		if elt.Stereotype = &quot;TFCS_Workflow&quot; then&#xA;			set dgm = GetCurrentDiagram()&#xA;			if not dgm is Nothing then&#xA;				dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;				if dgmStereo = &quot;TFCS::TFCS_FlowsDiagram&quot; then&#xA;					' Redirect to WF - definition diagram- iso realisation diagram &#xA;					' (this makes more sense in workflow overview dgms)&#xA;					dim ucActivity as EA.Element&#xA;					set ucActivity = GetElementByID(elt.ParentID)&#xA;					OpenDiagram(ucActivity.Diagrams.GetAt(0).diagramid)&#xA;					EA_OnContextItemDoubleClicked = True ' stop processing&#xA;				end if&#xA;			end if&#xA;		elseif elt.Stereotype = &quot;TFCS_Action&quot; and elt.ClassfierID &lt;&gt; 0 then&#xA;			dim classifier as EA.Element&#xA;			set classifier = GetElementByID(elt.ClassfierID)&#xA;			if not classifier is nothing  then&#xA;				set dgm = GetCurrentDiagram()&#xA;				if not dgm is Nothing then&#xA;					dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;					if dgmStereo = &quot;TFCS::TFCS_FlowDiagram&quot; then&#xA;						' Redirect to WF - realisation diagram- iso definition diagram &#xA;						' (this makes more sense in workflow realisation dgms)&#xA;						dim uc : set uc = classifier.Elements.GetByName(classifier.name)&#xA;						OpenDiagram(uc.Diagrams.GetAt(0).diagramid)&#xA;						EA_OnContextItemDoubleClicked = True ' stop processing&#xA;					end if&#xA;				end if&#xA;			end if&#xA;		end if&#xA;	end if&#xA;end Function&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Prevent modification of tagged value 'WorkflowType' of workflows&#xA;' NOTE: it is still possible to delete a tag (no way to prevent that...)&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;Sub EA_OnElementTagEdit(ObjectID , TagName, TagValue, TagNotes)&#xA;	if TagName = &quot;WorkflowType&quot; then&#xA;		' Prevent changes to this tag&#xA;		EAST.MsgBox &quot;Dit is niet toegestaan.&quot;+vbCrlf+ _&#xA;			&quot;Maak een nieuwe workflow aan van het juiste type &quot;+vbCRLF+ _&#xA;			&quot;en verplaats de informatie daarheen.&quot;,64,&quot;Wijzigen type workflow&quot;&#xA;	end if&#xA;end sub&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Consistency checks in response to creation of new model elements&#xA;'&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Element-related&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' Ensures that drag-n-drop of model elements is consistent with TFCS:&#xA;' - drag-n-drop of TFCS elements on TFCS diagrams only allowed when included in a toolbox for that diagram&#xA;' - drag-n-drop of TFCS elements on non-TFCS diagrams is allowed&#xA;' - drag-n-drop of non-TFCS elements on TFCS diagrams is not allowed&#xA;' Also creation of new TFCS elements using other means than TFCS toolboxes is not allowed&#xA;Function EA_OnPreNewElement( Info ) &#xA;	EA_OnPreNewElement = true&#xA;	&#xA;	dim diagramID: diagramID = CInt(Info.get(&quot;DiagramID&quot;).value)&#xA;	if  diagramID = 0 then&#xA;		' BLOCK: new modelelement was not created using one of the diagram toolboxes&#xA;		' (happens for instance when drag-n-dropping element as link from the project browser)&#xA;		EA_OnPreNewElement = false&#xA;		EAST.MsgBox DDH_PROMPT_PBCR_NOTALLOWED,16,DDH_TITLE_NOTALL&#xA;		exit function&#xA;	end if&#xA;	&#xA;	dim eltType: eltType = Info.get(&quot;Type&quot;)&#xA;	dim eltStereoType: eltStereoType = Info.get(&quot;Stereotype&quot;)&#xA;&#xA;'east.logerror(diagramID&amp;&quot;/&quot;&amp;eltType&amp;&quot;/&quot;&amp;eltStereoType)&#xA;&#xA;	if eltType = &quot;CallBehaviorAction&quot; or (eltType = &quot;Object&quot; and eltStereoType = &quot;&quot;) then&#xA;		' BLOCK: new element instance was not created using one of the diagram toolboxes&#xA;		' (happens for instance when drag-n-dropping element as instance from the project browser)&#xA;		EA_OnPreNewElement = false&#xA;		EAST.MsgBox DDH_PROMPT_PBCR_NOTALLOWED,16,DDH_TITLE_NOTALL&#xA;		exit function&#xA;	end if&#xA;	&#xA;	dim dgm as EA.Diagram: set dgm = GetDiagramByID(diagramID)&#xA;	if(dgm.parentID &lt;&gt; 0) then&#xA;		dim parentElement: set parentElement = GetElementByID(dgm.ParentID)&#xA;		if eltStereoType = &quot;TFCS_Action&quot; then&#xA;			if parentElement.Stereotype = &quot;TFCS_CompositeActivity&quot; or parentElement.Stereotype = &quot;TFCS_GUI&quot; then&#xA;				' BLOCK: subflow is not allowed on component/screen flow realisation&#xA;				EA_OnPreNewElement = false&#xA;				EAST.MsgBox DDH_PROMPT_WF_NOT_ALLOWED_ON_COMP,16,DDH_TITLE_NOTALL&#xA;				exit function&#xA;			else&#xA;				' allowed&#xA;				exit function&#xA;			end if&#xA;		end if&#xA;&#xA;		if eltStereoType = &quot;TFCS_CompositeAction&quot; then&#xA;			if parentElement.Stereotype = &quot;TFCS_CompositeActivity&quot; or parentElement.Stereotype = &quot;TFCS_GUI&quot; then&#xA;				' BLOCK: composite is not allowed on component/screen flow realisation&#xA;				EA_OnPreNewElement = false&#xA;				EAST.MsgBox DDH_PROMPT_COMP_NOT_ALLOWED_ON_COMP,16,DDH_TITLE_NOTALL&#xA;				exit function&#xA;			else&#xA;				' allowed&#xA;				exit function&#xA;			end if&#xA;		end if&#xA;	end if&#xA;end function&#xA;&#xA;' Verify that the object placed on the diagram is allowed on that diagram&#xA;Function EA_OnPreNewDiagramObject( Info ) &#xA;	EA_OnPreNewDiagramObject = true&#xA;	dim ID: ID = CInt(Info.get(&quot;ID&quot;).value)&#xA;	if ID &lt;&gt; 0 then&#xA;		if ObjectIsOnDiagram(ID,GetCurrentDiagram()) then&#xA;			' BLOCK: object cannot be included more than once&#xA;			EA_OnPreNewDiagramObject = false&#xA;			EAST.MsgBox DDH_PROMPT_ELTONDGM,16,DDH_TITLE_NOTALL&#xA;		else&#xA;			dim eltType: eltType = Info.get(&quot;Type&quot;).value&#xA;			if eltType = &quot;Package&quot; then&#xA;				' allowed&#xA;			elseif eltType = &quot;Diagram&quot; then&#xA;				' allowed&#xA;			else&#xA;				dim dgm: set dgm = GetCurrentDiagram()&#xA;				if(dgm is nothing) then exit function end if&#xA;				dim dgmStereo : dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;				if Left(dgmStereo,4) &lt;&gt; &quot;TFCS&quot; then	&#xA;					' allowed&#xA;					EAST.LogWarning(&quot;Diagram is non-TFCS =&gt; standard EA handling&quot;)&#xA;				else&#xA;					dim eltDropped: set eltDropped = GetElementByID(ID)&#xA;					dim eltStereo : eltStereo = eltDropped.Stereotype&#xA;					if eltStereo = &quot;&quot; or Left(eltStereo,4) &lt;&gt; &quot;TFCS&quot; then&#xA;						if eltType = &quot;Artifact&quot; _&#xA;							or eltType = &quot;Note&quot; _&#xA;							or eltType = &quot;Text&quot; _&#xA;							or eltType = &quot;Constraint&quot; _&#xA;							or eltType = &quot;Boundary&quot; _&#xA;							or eltType = &quot;Package&quot; _&#xA;							or eltType = &quot;UMLDiagram&quot; Then&#xA;							' Common basic types allowed, standard EA handling&#xA;							EAST.LogInfo(&quot;Drop of artifact,note,text,constraint,boundaries on TFCS dgm =&gt; OK&quot;)&#xA;						elseif eltType = &quot;&quot; then&#xA;							EAST.LogWarning(&quot;Inserting new element: elementtype missing (maybe copy-paste?) =&gt; silently ignored&quot;)&#xA;							EA_OnPreNewDiagramObject = false&#xA;						else&#xA;							EAST.LogInfo(&quot;Non-TFCS element '&quot;+eltType+&quot;' drop on TFCS diagram '&quot;+dgmStereo+&quot;' =&gt; not allowed &quot;)&#xA;							EA_OnPreNewDiagramObject = false&#xA;							EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;						end if&#xA;					else&#xA;						' TFCS element on TFCS diagram&#xA;						EA_OnPreNewDiagramObject = VerifyDropOnTFCSDiagram(dgmStereo,eltStereo) &#xA;					end if&#xA;				end if&#xA;			end if&#xA;		end if&#xA;	end if&#xA;end function&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Relationships between elements&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' Prevent creation of relations between TFCS and non-TFCS elements&#xA;Function EA_OnPreNewConnector( Info ) &#xA;	EA_OnPreNewConnector = true&#xA;	&#xA;	dim client as EA.Element&#xA;	set client = Repository.GetElementByID(CInt(Info.Get(&quot;ClientID&quot;)))&#xA;	dim supplier as EA.Element&#xA;	set supplier = Repository.GetElementByID(CInt(Info.Get(&quot;SupplierID&quot;)))&#xA;	dim cltIsTFCS : cltIsTFCS = (Left(client.Stereotype,5) = &quot;TFCS_&quot;)&#xA;	dim suppIsTFCS : suppIsTFCS = (Left(supplier.Stereotype,5) = &quot;TFCS_&quot;)&#xA;&#xA;	if((cltIsTFCS and not suppIsTFCS) or (suppIsTFCS and not cltIsTFCS)) then&#xA;		dim cltType : cltType = client.Type&#xA;		dim suppType : suppType = supplier.Type&#xA;		if cltType = &quot;Artifact&quot; or cltType = &quot;Note&quot; _&#xA;				or cltType = &quot;Text&quot; or cltType = &quot;Constraint&quot; or cltType = &quot;Boundary&quot; _&#xA;			or suppType = &quot;Artifact&quot; or suppType = &quot;Note&quot; _&#xA;				or suppType = &quot;Text&quot; or suppType = &quot;Constraint&quot; or suppType = &quot;Boundary&quot; Then&#xA;			' all is well&#xA;		else&#xA;			EAST.MsgBox &quot;Relaties tussen '&quot;+client.Name+&quot;' en '&quot;+supplier.Name+&quot;' zijn niet toegestaan&quot;,16,&quot;Model validatiefout&quot;&#xA;			EA_OnPreNewConnector = false&#xA;		end if&#xA;	end if&#xA;end Function&#xA;&#xA;' When creating a new flow connector, ask for a guard&#xA;Function EA_OnPostNewConnector(Info) &#xA;	EA_OnPostNewConnector = false ' no update &#xA;	&#xA;	dim answer&#xA;	dim conn as EA.Connector&#xA;	set conn = GetConnectorByID(Info.Get(&quot;ConnectorID&quot;))&#xA;	if conn.Type = &quot;ControlFlow&quot; or conn.Type = &quot;ObjectFlow&quot; then&#xA;		answer = EAST.InputBox(&quot;Conditie: &quot;,&quot;Toevoegen nieuwe relatie&quot;)&#xA;		if answer = empty or answer = &quot;&quot; then&#xA;			exit function&#xA;		end if&#xA;		Repository.Execute(&quot;update t_connector set pdata2 = '&quot;&amp;answer&amp;&quot;' where connector_id = &quot;&amp;conn.ConnectorID)&#xA;		EA_OnPostNewConnector = true&#xA;	elseif conn.Type = &quot;Association&quot; or conn.Type = &quot;Generalization&quot;  or conn.Type = &quot;Aggregation&quot;  then&#xA;		answer = EAST.InputBox(&quot;Naam: &quot;,&quot;Toevoegen nieuwe relatie&quot;)&#xA;		if answer = empty or answer = &quot;&quot; then&#xA;			exit function&#xA;		end if&#xA;		conn.name = answer&#xA;		conn.Update()&#xA;		EA_OnPostNewConnector = true&#xA;	end if&#xA;end function&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Diagram-related&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Helper functions&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' Verify if drop of TFCS element on TFCS diagrams is legal&#xA;' Basically: if the element isn't included in one of the diagram toolboxes, &#xA;' it's illegal to drop it on the diagram&#xA;function VerifyDropOnTFCSDiagram(dgmStereo,eltStereo)&#xA;	VerifyDropOnTFCSDiagram = true ' Default: drop is allowed&#xA;&#xA;	select case dgmStereo &#xA;		case &quot;TFCS::TFCS_FlowsDiagram&quot;&#xA;			if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;				&quot;,TFCS_Actor,TFCS_Workflow&quot; + _&#xA;				&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;				EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWSDGM),16,DDH_TITLE_NOTALL&#xA;				VerifyDropOnTFCSDiagram = false&#xA;			end if&#xA;		case &quot;TFCS::TFCS_FlowDefnDiagram&quot; &#xA;			if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;				&quot;,TFCS_Actor,TFCS_Workflow&quot; + _&#xA;				&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;				if InStr(&quot;TFCS_DomainObject,&quot;,eltStereo+&quot;,&quot;) &gt; 0 then&#xA;					EAST.MsgBox DDH_PROMPT_USE_TOOLBOX,16,DDH_TITLE_NOTALL&#xA;				else&#xA;					EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDEFDGM),16,DDH_TITLE_NOTALL&#xA;				end if&#xA;				VerifyDropOnTFCSDiagram = false&#xA;			end if&#xA;		case &quot;TFCS::TFCS_FlowDiagram&quot;&#xA;			if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;				&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;				if InStr(&quot;TFCS_Event,TFCS_MergeNode,TFCS_Decision,TFCS_IntermediateResult,TFCS_AtomicAction,TFCS_CompositeActivity&quot;+ _&#xA;					&quot;,TFCS_ActivityFinal,TFCS_ActivityInitial,TFCS_CompositeAction,TFCS_Workflow,TFCS_DomainObject&quot;+ _&#xA;					&quot;,TFCS_DomainInstance,TFCS_AuthorisationEffect,TFCS_Action,TFCS_Authorisation,TFCS_GUI,&quot;,eltStereo+&quot;,&quot;) &gt; 0 then&#xA;					EAST.MsgBox DDH_PROMPT_USE_TOOLBOX,16,DDH_TITLE_NOTALL&#xA;				else&#xA;					EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDGM),16,DDH_TITLE_NOTALL&#xA;				end if&#xA;				VerifyDropOnTFCSDiagram = false&#xA;			end if&#xA;		case &quot;TFCS::TFCS_DomainDiagram&quot; &#xA;			if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;				&quot;,TFCS_DomainObject,TFCS_DomainRule&quot; + _&#xA;				&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;				EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_DOMAINDGM),16,DDH_TITLE_NOTALL&#xA;				VerifyDropOnTFCSDiagram = false&#xA;			end if&#xA;		case &quot;TFCS::TFCS_RequirementsDiagram&quot;&#xA;			if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment&quot;+ _&#xA;				&quot;,TFCS_Requirement,TFCS_NFR,TFCS_Legislation,TFCS_Authorisation,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;				EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_REQDGM),16,DDH_TITLE_NOTALL&#xA;				VerifyDropOnTFCSDiagram = false&#xA;			end if&#xA;		case &quot;TFCS::TFCS_MaintenanceDiagram&quot; &#xA;			if InStr(&quot;TFCS_Issue,TFCS_Request,TFCS_TBD,TFCS_Ambiguity,TFCS_ReviewComment,&quot;,eltStereo+&quot;,&quot;) = 0 then&#xA;				EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_MNTDGM),16,DDH_TITLE_NOTALL&#xA;				VerifyDropOnTFCSDiagram = false&#xA;			end if&#xA;		case else&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;			VerifyDropOnTFCSDiagram = false&#xA;	end select&#xA;	&#xA;	if VerifyDropOnTFCSDiagram = false then&#xA;		EAST.LogInfo(&quot;Drop of '&quot;+eltStereo+&quot;' on TFCS diagram '&quot;+dgmStereo+&quot;' is not allowed&quot;)&#xA;	end if&#xA;	&#xA;end function&#xA;&#xA;&#xA;&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="408"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{E5F9585B-2DD4-4445-B968-17D32A8DC25C}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_ModelValidation&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Executes TFCS model validations in response to project/model validation/validate selected&#xA;' NOTE: although these EA validation events are used the events are not acutally triggered directly by EA&#xA;'       as this seems to lead to instability ulitmately leading EA to crash. &#xA;' 		To work around this EAST provides a method ValidateItem that will walk the tree of the selected element&#xA;'		and trigger the expected event. Results are displayed in a seperate output screen 'TFCS Guidance'   &#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;!INC TFCS_Support.TFCS_VALSQL&#xA;&#xA;const MNU_VALIDATESELECTED = &quot;Controleer tegen TFCS regels&quot;&#xA;&#xA;' =================================================================================================&#xA;' Handlers for events of interest&#xA;' =================================================================================================&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	if MenuLocation = &quot;TreeView&quot; and MenuName = MNU_TFCSMAIN then&#xA;		EA_GetMenuItems = MNU_VALIDATESELECTED&#xA;	end if&#xA;end Function&#xA;&#xA;Sub EA_MenuClick( MenuName , ItemName )&#xA;	if Menuname = MNU_TFCSMAIN and ItemName = MNU_VALIDATESELECTED then&#xA;		' This will walk the tree below the selected elementy in the project browser.&#xA;		EAST.ValidateItem(GetTreeSelectedObject())&#xA;	end if&#xA;end sub&#xA;&#xA;Sub EAST_ValidateElement(elt)&#xA;      EAST.LogInfo(&quot;****************** Validating... &quot;+elt.name+&quot; (&quot;+elt.stereotype+&quot;) ********************&quot;)&#xA;      if elt.Stereotype = &quot;&quot; or Left(elt.Stereotype,4) &lt;&gt; &quot;TFCS&quot; then&#xA;		' non-TFCS element found    &#xA;		dim eltType : eltType = elt.Type&#xA;		if eltType = &quot;Artifact&quot; _&#xA;			or eltType = &quot;Note&quot; _&#xA;			or eltType = &quot;Text&quot; _&#xA;			or eltType = &quot;Constraint&quot; _&#xA;			or eltType = &quot;Boundary&quot; _&#xA;			or eltType = &quot;Package&quot; _&#xA;			or eltType = &quot;UMLDiagram&quot; Then&#xA;			' Allowed (must match the list in TFCS_CreateFromToolbox)&#xA;		else&#xA;			PublishResult 1,VAL_NON_TFCS_ELEMENT,elt,empty&#xA;		end if&#xA;      else&#xA;		select case elt.Type&#xA;			case &quot;Issue&quot;&#xA;				ValidateIssue(elt)&#xA;			case &quot;Requirement&quot;&#xA;				if elt.Stereotype = &quot;TFCS_DomainRule&quot; then&#xA;					ValidateDomainRule(elt)&#xA;				elseif elt.Stereotype = &quot;TFCS_Authorisation&quot; then&#xA;					ValidateAutorisation(elt)&#xA;				else&#xA;					ValidateRequirement(elt)&#xA;				end if&#xA;			case else&#xA;				select case elt.Stereotype&#xA;					case &quot;TFCS_Activity&quot;					' container for specs relating to a workflow&#xA;						ValidateActivity(elt)&#xA;					case &quot;TFCS_GUI&quot;							' screen defn&#xA;							CheckOnNoDiagram elt,3,VAL_ACT_ON_DGM ' template, only allowed as classifier for elements on diagrams&#xA;							CheckHasNoRelationsOfType elt,3,VAL_NO_RELATIONS_ALLOWED_OFTYPE,&quot;'ControlFlow,ObjectFlow'&quot;&#xA;							CheckHasExactlyOneDiagram elt,3,VAL_MISSING_WF_DIAGRAM,&quot;TFCS_FlowDiagram&quot; &#xA;							CheckUsedAsClassifier elt,1,VAL_COMP_IS_NOT_USED ' is the template used?&#xA;							CheckHasNoRelations elt,0,VAL_NO_RELATIONS_ALLOWED&#xA;					case &quot;TFCS_Workflow&quot;					' UC element for workflow, container for WF realisation&#xA;							CheckHasWFDefnDiagram elt,3,VAL_WF_HAS_NO_UCDEFDGM&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckHasTagValueIn elt,3,VAL_WFTYPETAG_MISSING,&quot;WorkflowType&quot;,&quot;'UseCase','WerkInstructie','BedrijfsProces'&quot;&#xA;							CheckHasExactlyOneDiagram elt,3,VAL_MISSING_WF_DIAGRAM,&quot;TFCS_FlowDiagram&quot;&#xA;							CheckWFExtendsSameLevelWF elt,0,VAL_INVALID_WF_EXTENSION&#xA;							CheckWFIsUsed elt,1,VAL_WF_IS_NOT_USED ' is the activity acting as template for this workflow used?&#xA;							CheckIsOnDiagram elt,2,VAL_WF_NOT_ON_UCDGM,&quot;TFCS_FlowsDiagram&quot;&#xA;					case &quot;TFCS_CompositeActivity&quot;			' Component definition&#xA;							CheckOnNoDiagram elt,3,VAL_ACT_ON_DGM ' template, only allowed as classifier for elements on diagrams&#xA;							CheckHasNoRelations elt,3,VAL_NO_RELATIONS_ALLOWED&#xA;							CheckHasNoRelationsOfType elt,3,VAL_NO_RELATIONS_ALLOWED_OFTYPE,&quot;'ControlFlow,ObjectFlow'&quot;&#xA;							CheckHasExactlyOneDiagram elt,3,VAL_MISSING_WF_DIAGRAM,&quot;TFCS_FlowDiagram&quot;&#xA;							CheckUsedAsClassifier elt,1,VAL_COMP_IS_NOT_USED ' is the template used?&#xA;					case &quot;TFCS_Actor&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,1,VAL_ACTOR_NOT_ON_UCDEFDGM,&quot;TFCS_FlowDefnDiagram&quot;&#xA;							CheckIsOnDiagram elt,2,VAL_ACTOR_NOT_ON_UCDGM,&quot;TFCS_FlowsDiagram&quot;&#xA;							CheckReferences elt,0,VAL_ACTOR_UNUSED,&quot;'UseCase'&quot;,&quot;''&quot;&#xA;					case &quot;TFCS_DomainObject&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowDiagram,TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram&quot;&#xA;							CheckIsOnDiagram elt,1,VAL_ELT_NOT_ON_DIAGRAM,&quot;TFCS_DomainDiagram&quot;&#xA;					case &quot;TFCS_DomainInstance&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckHasClassifier elt,3,VAL_DOMAIN_MISSING_CLASSIFIER&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM,&quot;TFCS_FlowDiagram,TFCS_FlowDefnDiagram&quot;&#xA;							CheckHasRelation elt,0,VAL_ELT_NOT_USED,&quot;'ControlFlow,ObjectFlow,Dependency'&quot;,&quot;''&quot;&#xA;					case &quot;TFCS_AuthorisationEffect&quot;&#xA;							CheckHasClassifier elt,3,VAL_AUT_MISSING_CLASSIFIER&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckHasNoRelationsOfType elt,3,VAL_NO_RELATIONS_ALLOWED_OFTYPE,&quot;'ControlFlow,ObjectFlow'&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case &quot;TFCS_Action&quot;&#xA;							CheckHasClassifier elt,3,VAL_ACTION_MISSING_CLASSIFIER&#xA;							CheckHasTagValueIn elt,3,VAL_WFTYPETAG_MISSING,&quot;WorkflowType&quot;,&quot;'UseCase','WerkInstructie','BedrijfsProces'&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckWFStepNotInLowerWorkflow elt,3,VAL_WFSTEP_INVALID_IN_WORKFLOW&#xA;							CheckWFStepNotInComponent elt,3,VAL_WFSTEP_INVALID_IN_COMPONENT&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;							CheckHasRelation elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckActionTagSameAsWF elt&#xA;					case &quot;TFCS_AtomicAction&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;TFCS_FlowDiagram&quot;&#xA;							CheckHasRelation elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case &quot;TFCS_CompositeAction&quot;&#xA;							CheckHasClassifier elt,3,VAL_COMP_MISSING_CLASSIFIER&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;TFCS_FlowDiagram&quot;&#xA;							CheckHasRelation elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case &quot;TFCS_ActivityInitial&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;TFCS_FlowDiagram&quot;&#xA;							CheckReferences elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case &quot;TFCS_ActivityFinal&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;TFCS_FlowDiagram&quot;&#xA;							CheckReferencedBy elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case &quot;TFCS_Decision&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;TFCS_FlowDiagram&quot;&#xA;							CheckHasRelation elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case &quot;TFCS_MergeNode&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;TFCS_FlowDiagram&quot;&#xA;							CheckHasRelation elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case &quot;TFCS_Event&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;TFCS_FlowDiagram&quot;&#xA;							CheckReferences elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case &quot;TFCS_IntermediateResult&quot;&#xA;							CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM, &quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram,TFCS_DomainDiagram&quot;&#xA;							CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM, &quot;TFCS_FlowDiagram&quot;&#xA;							CheckHasRelation elt,0,VAL_ELT_NOT_PART_OF_FLOW,&quot;'ControlFlow,ObjectFlow'&quot;,&quot;''&quot;&#xA;							CheckElementOnlyUsedOnParent(elt)&#xA;					case else&#xA;						' Stereotype missing in model validation!	&#xA;						PublishResult 3,EAST.StrRep(VAL_UNKNOWN_STEREOTYPE,elt.stereotype),elt,empty&#xA;				end select&#xA;		end select&#xA;	end if&#xA;end sub&#xA;&#xA;Sub EAST_ValidateDiagram(dgm)&#xA;' - check for allowed elements are allowed elements&#xA;' - ucdef: includes must match the subflow actions on real dgm&#xA;' - ucdef: actors must match the actual related actors&#xA;	dim dgmStereo: dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;) &#xA;	if dgmStereo = &quot;&quot; or Left(dgmStereo,4) &lt;&gt; &quot;TFCS&quot; then &#xA;		' non-TFCS =&gt; not interested&#xA;		exit sub &#xA;	end if&#xA;	&#xA;	EAST.LogInfo(&quot;****************** Validating... &quot;+dgm.name+&quot; (&quot;+dgmStereo+&quot;) ********************&quot;)&#xA;	select case dgmStereo&#xA;		case &quot;TFCS::TFCS_FlowDiagram&quot;&#xA;				CheckDiagramHasParent dgm,&quot;'TFCS_Workflow','TFCS_GUI','TFCS_CompositeActivity'&quot;&#xA;				' not a rule but automatic synhronisation of flow relisation dgm with missing model relations&#xA;				SynchronizeWFWithModel(dgm)&#xA;				' not a rule but automatic synhronisation of flowdefinition dgm with flow realisation dgm&#xA;				SynchronizeWFDefWithFlow(dgm)&#xA;				CheckCompositeIncludesNoComposite 3,dgm&#xA;		case &quot;TFCS::TFCS_FlowDefnDiagram&quot;&#xA;				CheckDiagramHasParent dgm,&quot;'TFCS_Activity'&quot;&#xA;				' not a rule but automatic synhronisation of flowdefinition dgm with missing model relations&#xA;				SynchronizeWFDefWithModel(dgm)&#xA;				CheckParentWorkflowIncludesOrExtendsOthers 0,dgm&#xA;				CheckRequirementsAndIssuesAreImplementedOnFlow 0,dgm&#xA;				CheckAuthorisationsAreImplementedOnFlow 01,dgm&#xA;				CheckActorsAreRelatedToFlow 0,dgm&#xA;				CheckWFSAreUseInFlow 0,dgm&#xA;	end select&#xA;end sub&#xA;&#xA;&#xA;Sub EAST_ValidateConnector(conn)&#xA;     EAST.LogInfo(&quot;****************** Validating connector... ********************&quot;)&#xA;	&#xA;	dim eltFrom as EA.Element&#xA;	dim eltTo as EA.Element&#xA;&#xA;	set eltFrom = GetElementByID(conn.ClientID)&#xA;	set eltTo = GetElementByID(conn.SupplierID)&#xA;	if Left(eltFrom.Stereotype,4) &lt;&gt; &quot;TFCS&quot; or Left(eltTo.Stereotype,4) &lt;&gt; &quot;TFCS&quot; then&#xA;		' We only check 'pure TFCS' relations: between TFCS model elements&#xA;		exit sub&#xA;	end if&#xA;&#xA;		if conn.Direction = &quot;Destination -&gt; Source&quot; then&#xA;			' Preventing reverse direction connectors makes it easier to eg traverse control/object flows&#xA;			PublishResult 3,VAL_REVERSED_CONNECTOR,conn,empty&#xA;		else&#xA;			' Check if from/to element (stereo)types are valid for the type of relation&#xA;			' NOTE: validation that required relations are present is handled by element validation&#xA;			dim fromType: fromType = eltFrom.Type&#xA;			dim toType: toType = eltTo.Type&#xA;			dim toStereo: toStereo = eltTo.Stereotype&#xA;			dim fromStereo: fromStereo = eltFrom.Stereotype&#xA;			dim subType: subType = conn.Subtype&#xA;			select case  conn.Type&#xA;				case &quot;Dependency&quot;&#xA;					if fromType = &quot;Issue&quot; then exit sub end if&#xA;					if fromStereo = &quot;TFCS_AuthorisationEffect&quot; then exit sub end if&#xA;					if toType = &quot;Class&quot; and fromStereo = &quot;TFCS_DomainRule&quot; then exit sub end if&#xA;					if (fromType = &quot;UseCase&quot; and toStereo = &quot;TFCS_DomainInstance&quot;) _&#xA;						or (toType = &quot;UseCase&quot; and fromStereo = &quot;TFCS_DomainInstance&quot;) then &#xA;						&#xA;						' Check for valid stereotype&#xA;						if conn.Stereotype = &quot;input&quot; or conn.Stereotype = &quot;create&quot; _&#xA;							or conn.Stereotype = &quot;update&quot; or conn.Stereotype = &quot;delete&quot; or conn.Stereotype = &quot;&quot; then&#xA;						else&#xA;							PublishResult 3,EAST.StrRep(VAL_RELATIONSTEREO_NOT_VALID,conn.type&amp;&quot;|&quot;&amp;fromType&amp;&quot;|&quot;&amp;fromStereo&amp;&quot;|&quot;&amp;toType&amp;&quot;|&quot;&amp;toStereo&amp;&quot;|&quot;&amp;conn.Stereotype),conn,empty&#xA;						end if&#xA;						exit sub &#xA;					end if&#xA;				case &quot;UseCase&quot;&#xA;					if fromType = &quot;Actor&quot; and toType = &quot;UseCase&quot; then exit sub end if&#xA;					if toType = &quot;Actor&quot; and fromType = &quot;UseCase&quot; then exit sub end if&#xA;					if toType = &quot;UseCase&quot; and fromType = &quot;UseCase&quot; then exit sub end if&#xA;				case &quot;ControlFlow&quot;&#xA;					if fromStereo = &quot;TFCS_ActivityInitial&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromStereo = &quot;TFCS_ActivityInitial&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;					if fromType = &quot;Action&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;					if fromType = &quot;Action&quot; and toType = &quot;MergeNode&quot; then exit sub end if&#xA;					if fromType = &quot;Action&quot; and toStereo = &quot;TFCS_ActivityFinal&quot; then exit sub end if&#xA;					if fromType = &quot;Action&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromType = &quot;Decision&quot; and toType = &quot;MergeNode&quot; then exit sub end if&#xA;					if fromType = &quot;Decision&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromType = &quot;Decision&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;					if fromType = &quot;Decision&quot; and toStereo = &quot;TFCS_ActivityFinal&quot; then exit sub end if&#xA;					if fromType = &quot;MergeNode&quot; and toType = &quot;MergeNode&quot; then exit sub end if&#xA;					if fromType = &quot;MergeNode&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;					if fromType = &quot;MergeNode&quot; and toStereo = &quot;TFCS_ActivityFinal&quot; then exit sub end if&#xA;					if fromType = &quot;MergeNode&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromType = &quot;Event&quot; and toType = &quot;Action&quot; then exit sub end if&#xA;					if fromType = &quot;Event&quot; and toType = &quot;Decision&quot; then exit sub end if&#xA;				case &quot;ObjectFlow&quot;&#xA;					if fromType = &quot;Object&quot; and fromStereo = &quot;TFCS_DomainInstance&quot; then exit sub end if&#xA;					if fromType = &quot;Object&quot; and fromStereo = &quot;TFCS_IntermediateResult&quot; then exit sub end if&#xA;					if toType = &quot;Object&quot; and toStereo = &quot;TFCS_DomainInstance&quot; then exit sub end if&#xA;					if toType = &quot;Object&quot; and toStereo = &quot;TFCS_IntermediateResult&quot; then exit sub end if&#xA;				case &quot;Association&quot;&#xA;					if toType = &quot;Class&quot; and fromType = &quot;Class&quot; then exit sub end if&#xA;				case &quot;Generalization&quot;&#xA;					if toType = &quot;Class&quot; and fromType = &quot;Class&quot; then exit sub end if&#xA;					if toType = &quot;Actor&quot; and fromType = &quot;Actor&quot; then exit sub end if&#xA;				case &quot;Aggregation&quot;&#xA;					if toType = &quot;Class&quot; and fromType = &quot;Class&quot; then exit sub end if&#xA;				case &quot;Realisation&quot;&#xA;					if toType = &quot;Requirement&quot; then exit sub end if&#xA;			end select&#xA;			PublishResult 3,EAST.StrRep(VAL_RELATION_NOT_VALID,conn.type&amp;&quot;|&quot;&amp;fromType&amp;&quot;|&quot;&amp;fromStereo&amp;&quot;|&quot;&amp;toType&amp;&quot;|&quot;&amp;toStereo),conn,empty&#xA;		end if	&#xA;end sub&#xA;&#xA;' =================================================================================================&#xA;' Validation rules &#xA;' =================================================================================================&#xA;&#xA;' Validate all elements of type issue (TFCS_TBD, TFCS_ReviewComment,...)&#xA;sub ValidateIssue(elt)&#xA;		CheckIsOnDiagram elt,1,VAL_ELT_NOT_ON_DIAGRAM, _&#xA;			&quot;TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,&quot;+ _&#xA;			&quot;TFCS_RequirementsDiagram,TFCS_DomainDiagram,TFCS_FlowDiagram,TFCS_FlowsDiagram&quot;&#xA;		CheckReferences elt,1,VAL_ISSUE_NOT_REALISED,&quot;'Dependency'&quot;,&quot;''&quot;&#xA;end sub&#xA;&#xA;' Validate all elements of type requirement &#xA;sub ValidateRequirement(elt)&#xA;		CheckIsOnDiagram elt,1,VAL_ELT_NOT_ON_DIAGRAM, _&#xA;			&quot;TFCS_FlowDefnDiagram,&quot;+ _&#xA;			&quot;TFCS_RequirementsDiagram,TFCS_DomainDiagram,TFCS_FlowDiagram,TFCS_FlowsDiagram&quot;&#xA;		CheckReferencedBy elt,1,VAL_REQ_NOT_REALISED,&quot;'Realisation'&quot;,&quot;''&quot;&#xA;end sub&#xA;&#xA;sub ValidateDomainRule(elt)&#xA;		CheckIsNotOnDiagram elt,3,VAL_ELT_ON_INVALID_DGM,&quot;TFCS_FlowsDiagram,TFCS_FlowDefnDiagram,TFCS_MaintenanceDiagram,TFCS_RequirementsDiagram&quot;&#xA;		CheckIsOnDiagram elt,0,VAL_ELT_NOT_ON_DIAGRAM,&quot;TFCS_DomainDiagram,TFCS_FlowDiagram&quot;&#xA;		CheckReferences elt,0,VAL_DOMRULE_NOT_REALISED,&quot;'Dependency'&quot;,&quot;'TFCS_DomainObject'&quot;&#xA;end sub&#xA;				&#xA;sub ValidateAutorisation(elt)&#xA;		CheckUsedAsClassifier elt,1,VAL_AI_IS_NOT_USED ' has the AI any effects?&#xA;end sub&#xA;&#xA;sub ValidateActivity(elt)&#xA;' Activity must be present on flow realisation diagram of the workflow it rperesents so update rule:&#xA;'					CheckIsNotOnDiagram elt,3,VAL_ACT_ON_DGM,&quot;''&quot; ' template, only allowed as classifier for elements on diagrams&#xA;		CheckHasNoRelations elt,3,VAL_NO_RELATIONS_ALLOWED&#xA;		CheckHasExactlyOneDiagram elt,3,VAL_MISSING_WFDEFN_DIAGRAM,&quot;TFCS_FlowDefnDiagram&quot;&#xA;		&#xA;		' Must have a workflow element&#xA;		dim uc: set uc = GetElementByName(elt.Elements,elt.Name)&#xA;		if uc is nothing or uc.stereotype &lt;&gt; &quot;TFCS_Workflow&quot; then&#xA;			PublishResult 3,VAL_UC_MISSING_FOR_WF,elt,empty&#xA;		end if&#xA;end sub&#xA;&#xA;' Objects on diagrams should not be re-used on other diagrams&#xA;sub CheckElementOnlyUsedOnParent(elt)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_OTHER_DIAGRAMS_FOR_ELT,elt.ElementID)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;	dim i&#xA;		for i = 0 to result.count - 1&#xA;			PublishResult 0,VAL_ELT_ON_OTHER_DIAGRAM,elt,GetDiagramByID(result.item(i).Item(&quot;DIAGRAM_ID&quot;))&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element has no relations at all&#xA;sub CheckHasNoRelations(elt,severity,msg)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_RELATIONS_FOR_ELT,elt.ElementID&amp;&quot;|''&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;	dim i&#xA;		for i = 0 to result.count - 1&#xA;			PublishResult severity,msg,GetConnectorByID(result.item(i).Item(&quot;CONNECTOR_ID&quot;)),empty&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element has no relations of a specific type&#xA;sub CheckHasNoRelationsOfType(elt,severity,msg,connTypeList)&#xA; 	dim result: set result = EAST.ExecuteSQL(VAL_SQL_RELATIONS_FOR_ELT,elt.ElementID&amp;&quot;|&quot;&amp;connTypeList)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;	dim i&#xA;		for i = 0 to result.count - 1&#xA;			PublishResult severity,EAST.STRRep(msg,result.item(i).Item(&quot;CONNECTOR_TYPE&quot;)), _&#xA;				GetConnectorByID(result.item(i).Item(&quot;CONNECTOR_ID&quot;)),empty&#xA; 		next&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element has at least one relation of the specified type with elements of the specified type&#xA;sub CheckHasRelation(elt,severity,msg,connTypeList,stereoTypeList)&#xA;	dim result: set result = EAST.ExecuteSQL( _&#xA;		VAL_SQL_ELT_REFERENCED_BY,elt.ElementID&amp;&quot;|&quot;&amp;ucase(connTypeList)&amp;&quot;|&quot;&amp;ucase(stereoTypeList))&#xA;	if result is nothing then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckRelation&quot;),elt,empty&#xA;	elseif result.count = 0  then&#xA;		set result = EAST.ExecuteSQL( _&#xA;			VAL_SQL_ELT_REFERENCES,elt.ElementID&amp;&quot;|&quot;&amp;ucase(connTypeList)&amp;&quot;|&quot;&amp;ucase(stereoTypeList))&#xA;		if result is nothing then&#xA;			PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckRelation&quot;),elt,empty&#xA;		elseif result.count = 0  then&#xA;			PublishResult severity,msg,elt,empty&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;function RelationExists(eltFromID,connType,connSubType,eltToID)&#xA;	RelationExists = false&#xA;	&#xA;	dim result: result = EAST.ExecuteScalarSQL( VAL_SQL_ELT_REFERENCES_ELT, _&#xA;		eltFromID&amp;&quot;|&quot;&amp;connType&amp;&quot;|&quot;&amp;connSubType&amp;&quot;|&quot;&amp;eltToID)&#xA;	if Typename(result) &lt;&gt; &quot;Empty&quot; and CInt(result) &gt; 1 then&#xA;		RelationExists = true&#xA;	end if&#xA;end function&#xA;&#xA;' Checks if an element has a relation originating from an element with one of the specified stereotypes and relation type&#xA;sub CheckReferencedBy(ELT,severity,msg,connTypeList,stereoTypeList)&#xA;	dim result: set result = EAST.ExecuteSQL( _&#xA;		VAL_SQL_ELT_REFERENCED_BY,elt.ElementID&amp;&quot;|&quot;&amp;ucase(connTypeList)&amp;&quot;|&quot;&amp;ucase(stereoTypeList))&#xA;	if result is nothing then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckReferencedBy&quot;),elt,empty&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,msg,elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element has a relation to an element with one of the specified stereotypes and relation type&#xA;sub CheckReferences(ELT,severity,msg,connTypeList,stereoTypeList)&#xA;	dim result: set result = EAST.ExecuteSQL( _&#xA;		VAL_SQL_ELT_REFERENCES,elt.ElementID&amp;&quot;|&quot;&amp;ucase(connTypeList)&amp;&quot;|&quot;&amp;ucase(stereoTypeList))&#xA;	if result is nothing then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckReferences&quot;),elt,empty&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,msg,elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;' Checks if an element is present on at least one diagram of the specified (stereo)types&#xA;sub CheckIsOnDiagram(elt,severity,msg,dgmStereoTypeList)&#xA;	dim result,dgmStereo&#xA;	for each dgmStereo in Split(dgmStereoTypeList,&quot;,&quot;)&#xA;		set result = EAST.ExecuteSQL(VAL_SQL_DGMS_OF_TYPE_WITH_ELT,elt.ElementID&amp;&quot;|&quot;&amp;dgmStereo)&#xA;		if not result is nothing and result.count &gt;0 then &#xA;			exit sub&#xA;		end if&#xA;	next&#xA;	PublishResult severity,EAST.StrRep(msg,dgmStereoTypeList),elt,empty&#xA;end sub&#xA;&#xA;' Checks if an element is not present on any diagram of the specified (stereo)types&#xA;sub CheckIsNotOnDiagram(elt,severity,msg,dgmStereoTypeList)&#xA;	dim result,dgmStereo&#xA;	for each dgmStereo in Split(dgmStereoTypeList,&quot;,&quot;)&#xA;		set result = EAST.ExecuteSQL(VAL_SQL_DGMS_OF_TYPE_WITH_ELT,elt.ElementID&amp;&quot;|&quot;&amp;dgmStereo)&#xA;		if not result is nothing and result.count &gt;0 then &#xA;			dim i,row&#xA;			for i = 0 to result.count - 1&#xA;				set row = result.item(i)&#xA;				dim dgm: set dgm = GetDiagramByID(row.Item(&quot;DIAGRAM_ID&quot;))&#xA;				PublishResult severity, msg,elt,dgm&#xA;			next&#xA;		end if&#xA;	next&#xA;end sub&#xA;&#xA;' The element is parent for exacly one diagram, and this has the provided stereotype&#xA;sub CheckHasExactlyOneDiagram(elt,severity,msg,dgmStereoType)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_DGMSTEREO_FOR_ELT,elt.ElementID)&#xA;	if (result is nothing) then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckHasExactlyOneDiagram&quot;),elt,empty&#xA;	else&#xA;		if result.count = 0  then&#xA;			PublishResult severity,msg,elt,empty&#xA;		else&#xA;			dim i,row&#xA;			for i = 0 to result.count - 1&#xA;				set row = result.item(i)&#xA;				dim dgm as EA.Diagram: set dgm = GetDiagramByID(row.Item(&quot;DIAGRAM_ID&quot;))&#xA;				if GetStyleEx(dgm,&quot;MDGDgm&quot;) &lt;&gt; &quot;TFCS::&quot;+dgmStereoType then&#xA;					PublishResult severity,EAST.StrRep(VAL_DGM_NOT_ALLOWED_BELOW_ELT,elt.name),dgm,empty&#xA;				end if&#xA;			next&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckWFIsUsed(elt,severity,msg) &#xA;	' Note we use ParentID iso ElementID as steps on workflows are classified by the UC -activity- element&#xA;	' which is the parent of the UC element if the TFCS structure for workflows has been obeyed (this is&#xA;	' validated elsewhere)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_AS_CLASSIFIER,elt.ParentID)&#xA;	if result is nothing  then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckWFIsUsed&quot;),elt,empty&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,msg,elt,GetElementByID(elt.ParentID).CompositeDiagram&#xA;	end if&#xA;end sub&#xA;&#xA;' Element is not allowed on any TFCS diagram&#xA;sub CheckOnNoDiagram(elt,severity,msg)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_DGMS_WITH_ELT,elt.ElementID)&#xA;	if not result is nothing and result.count&gt;0 then&#xA;		dim i,row&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			dim dgm: set dgm = GetDiagramByID(row.Item(&quot;DIAGRAM_ID&quot;))&#xA;			PublishResult severity,msg,elt,dgm&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;' Workflow activity must own WFDefn diagram&#xA;sub CheckHasWFDefnDiagram(elt,severity,msg)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_WF_PARENT_DGM,elt.ElementID)&#xA;	if result is nothing or result.count=0 then&#xA;		PublishResult severity,msg,elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;' Element must have instances in the model&#xA;sub CheckUsedAsClassifier(elt,severity,msg) &#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_AS_CLASSIFIER,elt.ElementID)&#xA;	if result is nothing  then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckUsedAsClassifier&quot;),elt,empty&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,msg,elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;' An instance of an element must have the same tag value as the element&#xA;sub CheckTagSameAsClassifier(elt,severity,msg,tagName) &#xA;	dim eltTag  : eltTag = GetTagValByName(elt.TaggedValues,tagName)&#xA;	dim classifierTag  : classifierTag = GetTagValByName(GetElementByID(elt.classifierID).TaggedValues,tagName)&#xA;	if eltTag &lt;&gt; classifierTag then&#xA;		PublishResult severity,EAST.StrRep(msg,eltTag&amp;&quot;|&quot;&amp;classifierTag),elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckActionTagSameAsWF(elt)&#xA;	dim eltTag  : eltTag = GetTagValByName(elt.TaggedValues,&quot;WorkflowType&quot;)&#xA;	dim ucElt,actElt&#xA;	set actElt = GetElementByID(elt.ClassifierID)&#xA;	set ucElt = actElt.Elements.GetByName(actElt.Name)&#xA;	dim ucTag  : ucTag = GetTagValByName(ucElt.TaggedValues,&quot;WorkflowType&quot;)&#xA;	if eltTag &lt;&gt; ucTag then&#xA;		PublishResult 3,EAST.StrRep(VAL_WFTYPETAG_DIFFERS,eltTag&amp;&quot;|&quot;&amp;ucTag),elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckHasTagValueIn(elt,severity,msg,tagName,valueList) &#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_HAS_TAGVALUE,elt.ElementID&amp;&quot;|&quot;&amp;tagName&amp;&quot;|&quot;&amp;valueList)&#xA;	if result is nothing then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckHasTagValueIn&quot;),elt,empty&#xA;	elseif result.count = 0  then&#xA;		PublishResult severity,EAST.StrRep(msg,valueList),elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckWFExtendsSameLevelWF(elt,severity,msg)&#xA;	dim eltWFType: eltWFType = GetTagValByName(elt.taggedValues,&quot;WorkflowType&quot;)&#xA;	dim result: result = EAST.ExecuteScalarSQL( _&#xA;		VAL_SQL_WF_EXTENDS_OTHERLEVEL,elt.ElementID&amp;&quot;|&quot;&amp;eltWFType)&#xA;	if TypeName(result) = &quot;Empty&quot;  then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckWFExtendsSameLevelWF&quot;),elt,empty&#xA;	elseif result &gt; 0  then&#xA;		PublishResult severity,EAST.StrRep(msg,eltWFType),elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckWFStepNotInLowerWorkflow(elt,severity,msg)&#xA;	' Determine invalid flow types&#xA;	dim subflowType : subflowType = GetTagValByName(elt.TaggedValues,&quot;WorkflowType&quot;)&#xA;	dim disAllowedTypes : disAllowedTypes = &quot;'UseCase','WerkInstructie'&quot;&#xA;	select case subflowType&#xA;		case &quot;UseCase&quot;&#xA;			disAllowedTypes = &quot;'xxx'&quot;&#xA;		case &quot;WerkInstructie&quot;&#xA;			disAllowedTypes = &quot;'UseCase'&quot;&#xA;	end select&#xA;&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_WF_OFTYPE,elt.ElementID&amp;&quot;|&quot;&amp;disAllowedTypes)&#xA;	if not result is nothing  and result.count&gt;0  then&#xA;		dim i,row&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			dim dgm: set dgm = GetDiagramByID(row.Item(&quot;DIAGRAM_ID&quot;))&#xA;			PublishResult severity,EAST.StrRep(msg,subflowType&amp;&quot;|&quot;&amp;row.Item(&quot;WORKFLOWTYPE&quot;)),elt,dgm&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;' Subflow of type workflow not allowed in composite or screen flows&#xA;sub CheckWFStepNotInComponent(elt,severity,msg)&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_COMP,elt.ElementID)&#xA;	if not result is nothing  and result.count&gt;0  then&#xA;		dim i,row&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			dim dgm: set dgm = GetDiagramByID(row.Item(&quot;DIAGRAM_ID&quot;))&#xA;			PublishResult severity,msg,elt,dgm&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckDiagramHasParent(dgm,validStereoList)&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_PARENT_STEREOTYPE,dgm.DiagramID&amp;&quot;|&quot;&amp;validStereoList)&#xA;	if TypeName(result) = &quot;Empty&quot; then&#xA;		PublishResult 3,EAST.StrRep(VAL_PROGRAM_FAILURE,&quot;CheckDiagramHasParent&quot;),elt,dgm&#xA;	elseif result &gt; 0 then&#xA;		PublishResult 3,EAST.StrRep(VAL_DGM_INVALID_PARENT,validStereoList),elt,dgm&#xA;	end if&#xA;end sub&#xA;&#xA;sub CheckHasClassifier(elt,severity,msg)&#xA;	if elt.classifierID = 0  then&#xA;		PublishResult severity,msg,elt,empty&#xA;	end if&#xA;end sub&#xA;&#xA;' Workflows included on a WF definition diagram should be included or extended by&#xA;' the parent workflow&#xA;sub CheckParentWorkflowIncludesOrExtendsOthers(severity,dgm)&#xA;	dim result, row, elt,i&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_INCLUDES_EXTENDS,dgm.DiagramID)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			PublishResult severity,EAST.StrRep(VAL_MISSING_INCLUDES_EXTENDS,elt.Name&amp;&quot;|&quot;&amp;row.Item(&quot;PARENTWORKFLOW&quot;)),elt,dgm&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;' Composite actions are not allowed on a flowrealisation diagram of another composite activity or screen&#xA;' (composite activities are only allowed 1 level deep)&#xA;sub CheckCompositeIncludesNoComposite(severity,dgm)&#xA;	dim elt: set elt = GetElementByID(dgm.ParentID)&#xA;	if elt.Stereotype &lt;&gt; &quot;TFCS_Workflow&quot; then&#xA;		' Its a composite or screen&#xA;		dim result: set result = EAST.ExecuteSQL(VAL_SQL_COMP_ON_COMPDGM,dgm.DiagramID)&#xA;		if not result is nothing and result.count &gt;0  then&#xA;			for i = 0 to result.count - 1&#xA;				set row = result.item(i)&#xA;				dim cmp: set cmp = GetElementByID(result.item(0).item(&quot;OBJECT_ID&quot;))&#xA;				PublishResult severity,VAL_COMP_ON_COMPDGM,cmp,dgm&#xA;			next&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;' Requirements and issues on a WF definition diagram that are not directly related to the workflow element&#xA;' must be included in the WF realisation. &#xA;' (can happen when removing an element from the flow but forgetting to remove it &#xA;' from the definition as well)&#xA;sub CheckRequirementsAndIssuesAreImplementedOnFlow(severity,wfDefDgm)&#xA;&#xA;	' Get all elements on the WF definition diagram that are not directly connected to the workflow (TFCS_Workflow)&#xA;	dim result, row, elt,i&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_ELT_UNRELATED_TO_PARENT,wfDefDgm.DiagramID&amp; _&#xA;		&quot;|'TFCS_Issue','TFCS_Request','TFCS_TBD','TFCS_Ambiguity','TFCS_ReviewComment','TFCS_Legislation','TFCS_Requirement','TFCS_NFR'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		dim wfRealDgmID: wfRealDgmID = result.item(0).Item(&quot;WFREAL_DIAGRAM_ID&quot;)&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			dim wfRealDgm: set wfRealDgm = GetDiagramByID(wfRealDgmID)&#xA;			if DoCheckElementIncluded(wfRealDgmID,elt) = false then&#xA;				PublishResult severity,EAST.StrRep(VAL_ELT_UNRELATED_TO_WF,wfRealDgm.Name),elt,wfDefDgm&#xA;			end if&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;' Authorisations on a WF definition diagram that are not directly related to the workflow element&#xA;' must be included in the WF realisation. &#xA;' (can happen when removing an element from the flow but forgetting to remove it &#xA;' from the definition as well)&#xA;sub CheckAuthorisationsAreImplementedOnFlow(severity,wfDefDgm)&#xA;&#xA;	' Get all elements on the WF definition diagram that are not directly connected to the workflow (TFCS_Workflow)&#xA;	dim result, row, elt,i&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_ELT_UNRELATED_TO_PARENT,wfDefDgm.DiagramID&amp; _&#xA;		&quot;|'TFCS_Authorisation'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		dim wfRealDgmID: wfRealDgmID = result.item(0).Item(&quot;WFREAL_DIAGRAM_ID&quot;)&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			if DoCheckElementIncludedAsClassifier(wfRealDgmID,elt) = false then&#xA;				dim wfRealDgm: set wfRealDgm = GetDiagramByID(wfRealDgmID)&#xA;				PublishResult severity,EAST.StrRep(VAL_AUT_UNRELATED_TO_WF,wfRealDgm.Name),elt,wfDefDgm&#xA;			end if&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;&#xA;' Actors on a WF definition diagram must be linked to the workflow&#xA;sub CheckActorsAreRelatedToFlow(severity,wfDefDgm)&#xA;&#xA;	' Get all elements on the WF definition diagram that are not directly connected to the workflow (TFCS_Workflow)&#xA;	dim result, row, elt,i&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_ELT_UNRELATED_TO_PARENT,wfDefDgm.DiagramID&amp; _&#xA;		&quot;|'TFCS_Actor'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			PublishResult severity,VAL_ACT_UNRELATED_TO_WF,elt,wfDefDgm&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;' WF's on a WF definition diagram must be used in the workflow&#xA;sub CheckWFSAreUseInFlow(severity,wfDefDgm)&#xA;&#xA;	' Get all related WF's on the WF definition diagram (TFCS_Workflow)&#xA;	dim result, row, elt,i&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_WFS_ON_UCDEF,wfDefDgm.DiagramID)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		dim wfRealDgmID: wfRealDgmID = result.item(0).Item(&quot;WFREAL_DIAGRAM_ID&quot;)&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;ACTIVITY_ID&quot;))&#xA;			if DoCheckElementIncludedAsClassifier(wfRealDgmID,elt) = false then&#xA;				dim wfRealDgm: set wfRealDgm = GetDiagramByID(wfRealDgmID)&#xA;				PublishResult severity,EAST.StrRep(VAL_WF_UNRELATED_TO_WF,wfRealDgm.Name),GetElementByID(row.Item(&quot;OBJECT_ID&quot;)),wfDefDgm&#xA;			end if&#xA;		next&#xA;	end if&#xA;end sub&#xA;&#xA;' =================================================================================================&#xA;' Helpers&#xA;' =================================================================================================&#xA;&#xA;' Check if an element is used in the flow, or one of its subflows&#xA;function DoCheckElementIncluded(dgmID,elt)&#xA;	DoCheckElementIncluded = false 'not implemented =&gt; warn user&#xA;&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_ELT_ON_DGM,dgmID&amp;&quot;|&quot;&amp;elt.ElementID)&#xA;	if TypeName(result) &lt;&gt; &quot;Empty&quot;  and CInt(result) &gt; 0  then&#xA;		DoCheckElementIncluded = true&#xA;		exit function&#xA;	end if&#xA;&#xA;	' No luck here =&gt; check subflows&#xA;	EAST.LogInfo(&quot;DoCheckElementIncluded - Recursively checking component &amp; screen diagrams... &quot;)&#xA;	dim subComps: Set subComps =  EAST.ExecuteSQL(GEN_SQL_DGM_COMPLEXSTEPS,dgmID)&#xA;	if not subComps is nothing then&#xA;		dim subComp&#xA;		dim compDgmID&#xA;		for each subComp in subComps.Items&#xA;			compDgmID = subComp.item(&quot;DIAGRAM_ID&quot;)&#xA;			if DoCheckElementIncluded(compDgmID,elt) then&#xA;				DoCheckElementIncluded = true&#xA;				exit function&#xA;			end if&#xA;		next&#xA;	end if&#xA;&#xA;end function&#xA;&#xA;' Check if an element is used in the flow -as classifier-, or one of its subflows&#xA;function DoCheckElementIncludedAsClassifier(dgmID,elt)&#xA;	DoCheckElementIncludedAsClassifier = false 'not implemented =&gt; warn user&#xA;	&#xA;	dim result: result = EAST.ExecuteScalarSQL(VAL_SQL_ELT_AS_CLASSIFIER_ON_DGM,dgmID&amp;&quot;|&quot;&amp;elt.ElementID)&#xA;	if TypeName(result) &lt;&gt; &quot;Empty&quot;  and CInt(result) &gt; 0  then&#xA;		DoCheckElementIncludedAsClassifier = true&#xA;		exit function&#xA;	end if&#xA;&#xA;	' No luck here =&gt; check subflows&#xA;	EAST.LogInfo(&quot;DoCheckElementIncludedAsClassifier - Recursively checking component &amp; screen diagrams... &quot;)&#xA;	dim subComps: Set subComps =  EAST.ExecuteSQL(GEN_SQL_DGM_COMPLEXSTEPS,dgmID)&#xA;	if not subComps is nothing then&#xA;		dim subComp&#xA;		dim compDgmID&#xA;		for each subComp in subComps.Items&#xA;			compDgmID = subComp.item(&quot;DIAGRAM_ID&quot;)&#xA;			if DoCheckElementIncludedAsClassifier(compDgmID,elt) then&#xA;				DoCheckElementIncludedAsClassifier = true&#xA;				exit function&#xA;			end if&#xA;		next&#xA;	end if&#xA;&#xA;end function&#xA;&#xA;&#xA;' =================================================================================================&#xA;' Synchronisations &#xA;' =================================================================================================&#xA;&#xA;' Ensure that model elements explicitly related to an element on a workflow realisation diagram &#xA;' are included on that workflow realisation diagram  &#xA;dim offset: offset = 0&#xA;sub SynchronizeWFWithModel(dgm)&#xA;	offset = 0&#xA;	DoSynchronizeWFWithModel(dgm)&#xA;end sub&#xA;&#xA;sub DoSynchronizeWFWithModel(dgm)&#xA;	dim reload: reload = false 'will be set of something was added&#xA;	dim i,row,classifier&#xA;	dim elt as EA.Element&#xA;	dim diagramObject as EA.DiagramObject&#xA;	&#xA;	dim result: set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_ELEMENTS_FROM_WFREAL,dgm.DiagramID&amp; _&#xA;			&quot;|'TFCS_Issue','TFCS_Request','TFCS_TBD','TFCS_Ambiguity','TFCS_ReviewComment',&quot;+ _&#xA;			&quot;'TFCS_Legislation','TFCS_Requirement','TFCS_NFR'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		reload = true&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			set diagramObject = addEltToDiagram (elt,dgm,100+offset,100+offset)&#xA;			offset = offset + 10&#xA;			PublishResult 2,VAL_INFO_ADDED_MISSING_ELEMENT_TO_WFREAL,elt,dgm&#xA;		next&#xA;	end if&#xA;	&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_ELEMENTS_TO_WFREAL,dgm.DiagramID&amp; _&#xA;			&quot;|'TFCS_Issue','TFCS_Request','TFCS_TBD','TFCS_Ambiguity','TFCS_ReviewComment',&quot;+ _&#xA;			&quot;'TFCS_Legislation','TFCS_Requirement','TFCS_NFR'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		reload = true&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			set diagramObject = addEltToDiagram (elt,dgm,100+offset,100+offset)&#xA;			offset = offset + 10&#xA;			PublishResult 2,VAL_INFO_ADDED_MISSING_ELEMENT_TO_WFREAL,elt,dgm&#xA;		next&#xA;	end if&#xA;	&#xA;	if(reload)then&#xA;		'Something was added =&gt; reload&#xA;		ReloadDiagram(dgm.DiagramID)&#xA;	end if&#xA;	&#xA;	' Recursively check subflows&#xA;	EAST.LogInfo(&quot;SynchronizeWFWithModel - Recursively checking component &amp; screen diagrams... &quot;)&#xA;	dim subComps: Set subComps =  EAST.ExecuteSQL(GEN_SQL_DGM_COMPLEXSTEPS,dgm.DiagramID)&#xA;	if not subComps is nothing then&#xA;		dim subComp&#xA;		dim compDgm as EA.Diagram&#xA;		for each subComp in subComps.Items&#xA;			set compDgm = GetDiagramByID(subComp.item(&quot;DIAGRAM_ID&quot;))&#xA;			DoSynchronizeWFWithModel(compDgm)&#xA;		next&#xA;	end if&#xA;&#xA;end sub&#xA;&#xA;&#xA;&#xA;' Ensure that all model elements explicitly related to a Workflow element are included &#xA;' in its WF definition diagram &#xA;sub SynchronizeWFDefWithModel(dgm)&#xA;&#xA;	dim reload: reload = false 'will be set of something was added&#xA;	dim offset: offset = 0&#xA;	dim i,row,classifier&#xA;	dim elt as EA.Element&#xA;	dim offA: offA = 0&#xA;	dim offWF: offWF = 0&#xA;	dim offREQ: offREQ = 0&#xA;	dim offISS: offISS = 0&#xA;	&#xA;	dim result&#xA;	dim diagramObject as EA.DiagramObject&#xA;&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_RELATIONS_FROM_WF,dgm.DiagramID)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		reload = true&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Stereotype&#xA;				case &quot;TFCS_Workflow&quot;&#xA;					set diagramObject = addEltToDiagram (elt,dgm,800+offWF,300+offWF)&#xA;					offWF = offWF + 10&#xA;				case &quot;TFCS_Actor&quot;&#xA;					set diagramObject = addEltToDiagram (elt,dgm,800+offA,150+offA)&#xA;					offA = offA + 10&#xA;				case else&#xA;					if  elt.Type = &quot;Requirement&quot; then&#xA;						set diagramObject = addEltToDiagram (elt,dgm,800+offREQ,800+offREQ)&#xA;						offREQ = offREQ + 10&#xA;					else&#xA;						set diagramObject = addEltToDiagram (elt,dgm,800+offISS,1000+offISS)&#xA;						offISS = offISS + 10&#xA;					end if&#xA;			end select&#xA;			PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_RELATED_TO_WFDEFN,elt.Name),elt,dgm&#xA;		next&#xA;	end if&#xA;	&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_RELATIONS_TO_WF,dgm.DiagramID)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		reload = true&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Stereotype&#xA;				case &quot;TFCS_Actor&quot;&#xA;					set diagramObject = addEltToDiagram (elt,dgm,800+offA,150+offA)&#xA;					offA = offA + 10&#xA;				case else&#xA;					if  elt.Type = &quot;Requirement&quot; then&#xA;						set diagramObject = addEltToDiagram (elt,dgm,800+offREQ,800+offREQ)&#xA;						offREQ = offREQ + 10&#xA;					else&#xA;						set diagramObject = addEltToDiagram (elt,dgm,800+offISS,1000+offISS)&#xA;						offISS = offISS + 10&#xA;					end if&#xA;			end select&#xA;			PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_RELATED_TO_WFDEFN,elt.Name),elt,dgm&#xA;		next&#xA;	end if&#xA;	&#xA;	if(reload)then&#xA;		'Something was added =&gt; reload&#xA;		ReloadDiagram(dgm.DiagramID)&#xA;	end if&#xA;&#xA;end sub&#xA;&#xA;' Relative offsets for placing new elements on a WF definition diagram&#xA;dim offAI: offAI = 0&#xA;dim offDO: offDO = 0&#xA;dim offREQ: offREQ = 0&#xA;dim offISS: offISS = 0&#xA;dim offWF: offWF = 0&#xA;	&#xA;' Add all elements used in the flow, or any of its subflows, that are missing in its flow definition diagram &#xA;sub SynchronizeWFDefWithFlow(dgm)&#xA;&#xA;	dim wf: set wf = GetElementByID(dgm.ParentID)&#xA;	if wf.Stereotype = &quot;TFCS_Workflow&quot; then&#xA;		' It is flow realisation for a workflow&#xA;		dim wfActivity as EA.Element&#xA;		set wfActivity = GetElementByID(wf.ParentID)&#xA;		dim defDgm: set defDgm = wfActivity.CompositeDiagram&#xA;&#xA;		offAI = 0&#xA;		offDO = 0&#xA;		offREQ = 0&#xA;		offISS = 0&#xA;		offWF = 0&#xA;&#xA;		if(DoSynchronizeWFDefWithFlow(dgm,defDgm) = true) then&#xA;			'Something was added =&gt; reload&#xA;			ReloadDiagram(defDgm.DiagramID)&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;&#xA;function DoSynchronizeWFDefWithFlow(dgm,defDgm)&#xA;	DoSynchronizeWFDefWithFlow = false 'no elements added =&gt; no refresh needed&#xA;	&#xA;	dim i,row,elt,eltInst,conn,wf&#xA;	dim result&#xA;	dim diagramObject as EA.DiagramObject&#xA;	&#xA;	' Add all Authorisationitems that have effects on the flow but have not been included in the WF definition diagram&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_CLASSIFIERS_ON_WFDEFN,dgm.DiagramID&amp;&quot;|&quot;&amp;defDgm.DiagramID&amp;&quot;|'TFCS_Authorisation'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Stereotype&#xA;				case &quot;TFCS_Authorisation&quot;&#xA;					set diagramObject = addEltToDiagram (elt,defDgm,800+offAI,600+offAI)&#xA;					PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_AI_TO_WFDEFN,elt.name),elt,defDgm&#xA;					offAI = offAI + 10&#xA;				case else&#xA;			end select&#xA;		next&#xA;		DoSynchronizeWFDefWithFlow = true&#xA;	end if&#xA;&#xA;	' Add an instance for each domainobject included (as instance) in the flow but not on the WF definition diagram&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_INST_ON_WFDEFN,dgm.DiagramID&amp;&quot;|&quot;&amp;defDgm.DiagramID&amp;&quot;|'TFCS_DomainObject'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Stereotype&#xA;				case &quot;TFCS_DomainObject&quot;&#xA;					set eltInst= GetElementByID(defDgm.ParentID).Elements.AddNew(&quot;&quot;,&quot;TFCS::TFCS_DomainInstance&quot;)&#xA;					eltInst.ClassifierID = elt.ElementID&#xA;					eltInst.ClassifierName = elt.Name&#xA;					eltInst.Update()&#xA;					set diagramObject = addEltToDiagram (eltInst,defDgm,800+offDO,400+offDO)&#xA;					PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_DO_TO_WFDEFN,elt.name),elt,defDgm&#xA;					offDO = offDO + 10&#xA;				case else&#xA;			end select&#xA;		next&#xA;		DoSynchronizeWFDefWithFlow = true&#xA;	end if&#xA;&#xA;	' Add all subflows that have not been included in the WF definition diagram&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_WORKFLOWS_ON_WFDEFN,dgm.DiagramID&amp;&quot;|&quot;&amp;defDgm.DiagramID)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			&#xA;			' If an include relation does not yet exist, create it now&#xA;			' set wf = GetElementByID(result.item(0).item(&quot;WF_ID&quot;))&#xA;'			if not RelationExists(wf.ElementID,&quot;'UseCase'&quot;,&quot;'Includes'&quot;,elt.ElementID) then&#xA;'				set conn = wf.Connectors.AddNew(&quot;&quot;, &quot;UseCase&quot;)&#xA;'				conn.SupplierID = elt.ElementID&#xA;'				conn.SubType=&quot;Includes&quot;&#xA;'				conn.alias=&quot;&lt;&lt;includes&gt;&gt;&quot;&#xA;'				conn.Update()&#xA;'			end if&#xA;			set diagramObject = addEltToDiagram (elt,defDgm,800+offWF,300+offWF)&#xA;			PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_WF_TO_WFDEFN,elt.name),elt,defDgm&#xA;			offWF = offWF + 10&#xA;		next&#xA;		DoSynchronizeWFDefWithFlow = true&#xA;	end if&#xA;	&#xA;	' Add all remaining elements included in the flow but not in the WF definition diagram&#xA;	set result = EAST.ExecuteSQL(VAL_SQL_GET_MISSING_ELTS_ON_WFDEFN,dgm.DiagramID&amp;&quot;|&quot;&amp;defDgm.DiagramID&amp; _&#xA;		&quot;|'TFCS_Legislation','TFCS_Requirement','TFCS_NFR',&quot; + _&#xA;		&quot;'TFCS_Request','TFCS_ReviewComment','TFCS_Ambiguity','TFCS_TBD','TFCS_Issue'&quot;)&#xA;	if not result is nothing and result.count &gt;0  then&#xA;		for i = 0 to result.count - 1&#xA;			set row = result.item(i)&#xA;			set elt = GetElementByID(row.Item(&quot;OBJECT_ID&quot;))&#xA;			select case elt.Type&#xA;				case &quot;Requirement&quot;&#xA;					set diagramObject = addEltToDiagram (elt,defDgm,800+offREQ,800+offREQ)&#xA;					PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_REQ_TO_WFDEFN,elt.name),elt,defDgm&#xA;					offREQ = offREQ + 10&#xA;				case else&#xA;					set diagramObject = addEltToDiagram (elt,defDgm,800+offISS,1000+offISS)&#xA;					PublishResult 2,EAST.StrRep(VAL_INFO_ADDED_ELT_TO_WFDEFN,elt.Name),elt,defDgm&#xA;					offISS = offISS + 10&#xA;			end select&#xA;		next&#xA;		DoSynchronizeWFDefWithFlow = true&#xA;	end if&#xA;	&#xA;	' Recursively check subflows&#xA;	EAST.LogInfo(&quot;DoSynchronizeWFDefWithFlow - Recursively checking component &amp; screen diagrams... &quot;)&#xA;	dim subComps: Set subComps =  EAST.ExecuteSQL(GEN_SQL_DGM_COMPLEXSTEPS,dgm.DiagramID)&#xA;	if not subComps is nothing then&#xA;		dim subComp&#xA;		dim compDgm as EA.Diagram&#xA;		for each subComp in subComps.Items&#xA;			set compDgm = GetDiagramByID(subComp.item(&quot;DIAGRAM_ID&quot;))&#xA;			if DoSynchronizeWFDefWithFlow(compDgm,defDgm) then&#xA;				DoSynchronizeWFDefWithFlow = true&#xA;			end if&#xA;		next&#xA;	end if&#xA;end function&#xA;&#xA;&#xA;' =================================================================================================&#xA;' Reporting interface&#xA;' =================================================================================================&#xA;&#xA;'WARNING LEVELS&#xA;'mvError 						= 0&#xA;'mvWarning 						= 1&#xA;'mvInformation 					= 2&#xA;'mvErrorCritical 				= 3 &#xA;sub PublishResult(severity,msg,elt,dgm)&#xA;	EAST.PublishValidationResult severity,msg,elt,dgm&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="409"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{D113CB7C-DAE3-4c25-8768-FE4122810123}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_commons&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Module containing general utility methods.&#xA;' &#xA;' This module contains no event handlers only supporting functions, so registration with EAST is indirect, through&#xA;' inclusion within other modules&#xA;'&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' Retrieves the named element from the user temp package (userdir.temp)&#xA;' If the user temp package does not yet exist, its created.&#xA;' If the temp element does not yet exist, its created (always type 'Class') including the note as explanation.&#xA;function GetTempElement(name,notes)&#xA;	dim pck: set pck = EAST.GetPackageByFQN(GEN__WORKSPACE+&quot;.&quot;+EAST.UserName()+&quot;.temp&quot;,true)&#xA;	on error resume next&#xA;	dim elt: set elt = pck.Elements.GetByName(name)&#xA;	if elt is nothing then&#xA;		set elt = pck.Elements.AddNew(&quot;&quot;,&quot;Class&quot;)&#xA;		elt.name = name&#xA;		elt.Notes = notes&#xA;		elt.Update()&#xA;	end if&#xA;	set GetTempElement = elt&#xA;end function&#xA;&#xA;function GetPrivatePackage(model,name)&#xA;	set GetPrivatePackage = nothing&#xA;	&#xA; 	' Get the private workspace for the current user&#xA;	dim workspacePath: workspacePath = GEN__WORKSPACE+&quot;.&quot;+EAST.UserName()&#xA;	dim workspace as EA.Package&#xA;	on error resume next&#xA;	set workspace = EAST.GetPackageByFQN(workspacePath) &#xA;	if err.number &lt;&gt; 0 then&#xA;		EAST.MsgBox EAST.StrRep(MSG_WORKSPACE_MISSING,workspacePath),16,COMM_NEW_WORKFLOW&#xA;		exit function&#xA;	end if&#xA;	on error goto 0&#xA;&#xA;	' Get the package (create if not available)&#xA;	if(name &lt;&gt; &quot;&quot;) then&#xA;		name = &quot;.&quot;+name&#xA;	end if&#xA;	if model = GEN__WORKSPACE then&#xA;		' No model selected: drop in private workspace root&#xA;		set GetPrivatePackage = EAST.GetPackageByFQN(workspacePath+name, true)&#xA;	else&#xA;		set GetPrivatePackage = EAST.GetPackageByFQN(workspacePath+&quot;.&quot;+model+name, true) &#xA;	end if&#xA;&#xA;end function&#xA;&#xA;' Add an action for the supplied workflow activity to the diagram at the indicated position&#xA;' Returns the action element that was created&#xA;&#xA;'-----------------------------------------------------------------------------------&#xA;' Generic diagram &amp; element &#xA;'-----------------------------------------------------------------------------------&#xA;&#xA;' Tree selection dialog - all elements in repository, current model is default open Returns GUID of selected dgm&#xA;function SelectDiagramFromTree(title,stereotype,stereotypeName,modelDefault,allowNew)&#xA;	SelectDiagramFromTree = &quot;&quot;&#xA;&#xA;	' Data to pass to the dialog&#xA;	dim dict : set dict = CreateObject(&quot;Scripting.Dictionary&quot;)&#xA;	dim rows : set rows = EAST.ExecuteSQL(COMM_SQL_DGMSBYSTEREO,ucase(stereotype))	&#xA;	dim rootModels : set rootModels = EAST.ExecuteSQL(COMM_SQL_GETMODELS,&quot;&quot;)	&#xA;	dict.add &quot;DFLT_MDL&quot;,modelDefault &#xA;	if(allowNew) then&#xA;		dict.add &quot;ALLOWNEW&quot;,stereotypeName&#xA;	end if&#xA;	dict.add &quot;ROWS&quot;,rows&#xA;	dict.add &quot;MODELS&quot;, rootModels&#xA;	&#xA;	EAST.OpenDialog &quot;tfcsSelectTree.html&quot;,title,dict&#xA;	EAST.LogDebug(&quot;SelectDiagramFromTree: &quot;+dict.item(&quot;RESULT&quot;))&#xA;	SelectDiagramFromTree = dict.item(&quot;RESULT&quot;)&#xA;end function&#xA;&#xA;' Tree selection dialog - all elements in repository, current model is default open. Returns GUID of selected elt&#xA;function SelectElementFromTree(title,stereotype,stereotypeName,modelDefault,allowNew,hideElement)&#xA;	SelectElementFromTree = &quot;&quot;&#xA;&#xA;	' Data to pass to the dialog&#xA;	dim dict : set dict = CreateObject(&quot;Scripting.Dictionary&quot;)&#xA;	dim hideID: hideID = 0&#xA;	if not hideElement is nothing then&#xA;		hideID = hideElement.ElementID&#xA;	end if&#xA;	dim rows : set rows = EAST.ExecuteSQL(COMM_SQL_ELTSBYSTEREO,stereotype&amp;&quot;|&quot;&amp;hideID)	&#xA;	dim rootModels : set rootModels = EAST.ExecuteSQL(COMM_SQL_GETMODELS,&quot;&quot;)	&#xA;	dict.add &quot;DFLT_MDL&quot;,modelDefault &#xA;	if(allowNew) then&#xA;		dict.add &quot;ALLOWNEW&quot;,stereotypeName&#xA;	end if&#xA;	dict.add &quot;ROWS&quot;,rows&#xA;	dict.add &quot;MODELS&quot;, rootModels&#xA;	&#xA;	EAST.OpenDialog &quot;tfcsSelectTree.html&quot;,title,dict&#xA;	EAST.LogDebug(&quot;SelectElementFromTree: &quot;+dict.item(&quot;RESULT&quot;))&#xA;	SelectElementFromTree = dict.item(&quot;RESULT&quot;)&#xA;end function&#xA;&#xA;' Tree selection dialog - all elements in repository with specific tag values, default tag open .Returns GUID of selected elt&#xA;function SelectElementTagFromTree(title,stereotype,tagName,tagValues,modelDefault,tagDefault,allowNew)&#xA;	SelectElementTagFromTree = &quot;&quot;&#xA;&#xA;	' Data to pass to the dialog&#xA;	dim dict : set dict = CreateObject(&quot;Scripting.Dictionary&quot;)&#xA;	dim rows : set rows = EAST.ExecuteSQL(COMM_SQL_ELTSBYSTEREO_AND_TAG,stereotype+&quot;|&quot;+tagName+&quot;|&quot;+ucase(tagValues))	&#xA;	dim rootModels : set rootModels = EAST.ExecuteSQL(COMM_SQL_GETMODELS,&quot;&quot;)	&#xA;	dict.add &quot;DFLT_MDL&quot;,modelDefault &#xA;	dict.add &quot;DFLT_TAG&quot;,tagDefault&#xA;	if allowNew then&#xA;		dict.add &quot;ALLOWNEW&quot;,tagValues&#xA;	end if&#xA;	dict.add &quot;ROWS&quot;,rows&#xA;	dict.add &quot;MODELS&quot;, rootModels&#xA;	&#xA;	EAST.OpenDialog &quot;tfcsSelectTree.html&quot;,title,dict&#xA;	EAST.LogDebug(&quot;SelectElementTagFromTree: &quot;+dict.item(&quot;RESULT&quot;))&#xA;	SelectElementTagFromTree = dict.item(&quot;RESULT&quot;)&#xA;end function&#xA;&#xA;&#xA;' Returns true if an object is present on a specific diagram&#xA;function ObjectIsOnDiagram(objID,dgm)&#xA;	ObjectIsOnDiagram = false&#xA;	dim dgmObject as EA.DiagramObject&#xA;	for each dgmObject in dgm.DiagramObjects&#xA;		if dgmObject.ElementID = objID then&#xA;			ObjectIsOnDiagram = true&#xA;			exit function&#xA;		end if&#xA;	next&#xA;end function&#xA;&#xA;' Add an element as link to the diagram, return the created diagram object&#xA;function addEltToDiagram(elt, dgm, left, top)&#xA;	EAST.LogStart(&quot;addEltToDiagram&quot;)&#xA;	dim width: width = 20&#xA;	dim height: height = 30&#xA;	' TBD: Why is _sizeX/Y not working?&#xA;	select case elt.Type&#xA;	case &quot;Issue&quot;&#xA;		width = 200&#xA;	case &quot;Requirement&quot;&#xA;		width = 200&#xA;	case &quot;Object&quot;&#xA;		width = 150&#xA;		height = 50&#xA;	case &quot;Class&quot;&#xA;		width = 200&#xA;		height = 100&#xA;	case &quot;Decision&quot;&#xA;		width = 26&#xA;		height = 34&#xA;	case &quot;MergeNode&quot;&#xA;		width = 26&#xA;		height = 34&#xA;	case &quot;Actor&quot;&#xA;		width = 40&#xA;		height = 60&#xA;	case &quot;UseCase&quot;&#xA;		width = 100&#xA;		height = 70&#xA;	case &quot;Activity&quot;&#xA;		width = 80&#xA;		height = 60&#xA;	case &quot;Action&quot;&#xA;		width = 100&#xA;		if(elt.Stereotype = &quot;TFCS_CompositeAction&quot;) then&#xA;			height = 60&#xA;		else&#xA;			height = 30&#xA;		end if&#xA;	case else&#xA;	end select&#xA;	dim right: right = left + width&#xA;	dim bottom: bottom = top + height&#xA;	dim dgmObject: set dgmObject = dgm.diagramObjects.AddNew(&quot;l=&quot;&amp;left&amp;&quot;;r=&quot;&amp;right&amp;&quot;;t=&quot;&amp;top&amp;&quot;;b=&quot;&amp;bottom&amp;&quot;;&quot;, &quot;&quot; )&#xA;	dgm.DiagramObjects.Refresh()&#xA;	dgmObject.ElementID = elt.ElementID &#xA;	dgmObject.Update()&#xA;&#xA;	set addEltToDiagram = dgmObject&#xA;	EAST.LogInfo(&quot;Added element to '&quot;&amp;dgm.name&amp;&quot;' at (&quot;&amp;left&amp;&quot;,&quot;&amp;top&amp;&quot;)-(&quot;&amp;right&amp;&quot;,&quot;&amp;bottom&amp;&quot;)&quot;)&#xA;	EAST.LogEnd(&quot;addEltToDiagram&quot;)&#xA;end function&#xA;&#xA;' Adds a post-it to a diagram&#xA;' loc has the format: &quot;l=10;t=10;r=800;b=100;&quot; (#pixels left-top-right-bottom)&#xA;function addPostIt(elt,dgm,loc,notes)&#xA;&#xA;	dim dgmElement as EA.Element&#xA;	dim dgmObject as EA.DiagramObject&#xA;	&#xA;	set dgmElement = elt.Elements.AddNew(&quot;&quot;,&quot;Note&quot;)&#xA;	dgmElement.Notes = notes&#xA;	dgmElement.Update()&#xA;	&#xA;	set dgmObject = dgm.diagramObjects.AddNew(loc,&quot;&quot;)&#xA;	dgmObject.ElementID = dgmElement.ElementID&#xA;	dgmObject.Style = &quot;BCol=65535;NSL=0&quot;&#xA;	dgmObject.Update()&#xA;	&#xA;	set addPostIt = dgmObject&#xA;end function&#xA;&#xA;' Adds a boundary to a diagram&#xA;' loc has the format: &quot;l=10;t=10;r=800;b=100;&quot; (#pixels left-top-right-bottom)&#xA;' nonSelectable: 1: niet selecteerbaar, 0: wel&#xA;function addBoundary(elt,dgm,loc,notes,nonSelectable)&#xA;&#xA;	dim dgmElement as EA.Element&#xA;	dim dgmObject as EA.DiagramObject&#xA;	&#xA;	set dgmElement = elt.Elements.AddNew(&quot;&quot;,&quot;Boundary&quot;)&#xA;	dgmElement.Name = notes&#xA;	dgmElement.Update()&#xA;	&#xA;	set dgmObject = dgm.diagramObjects.AddNew(loc,&quot;&quot;)&#xA;	dgmObject.ElementID = dgmElement.ElementID&#xA;	dgmObject.Style = &quot;font=Arial;fontsz=100;bold=1;italic=0;ul=0;charset=0;pitch=34;NSL=&quot;&amp;nonSelectable&#xA;	dgmObject.Update()&#xA;	&#xA;	set addBoundary = dgmObject&#xA;end function&#xA;&#xA;Function GetStyleEx(byref dgm, srch)&#xA;	GetStyleEx = &quot;&quot;&#xA;	&#xA;	Dim style: style = dgm.StyleEx&#xA;    Dim sPos: sPos = InStr(1, style, srch+&quot;=&quot;)&#xA;    If sPos &gt; 0 Then&#xA;        Dim ePos: ePos = InStr(sPos, style, &quot;;&quot;)&#xA;        GetStyleEx = Mid(style, sPos+len(srch)+1, ePos-sPos-len(srch)-1)&#xA;    End If&#xA;End Function&#xA;&#xA;sub SetStyleEx(byref dgm, srch, value)&#xA;	&#xA;	Dim style: style = dgm.StyleEx&#xA;    Dim sPos: sPos = InStr(1, style, srch+&quot;=&quot;)&#xA;    If sPos = 0 Then&#xA;		style = style+srch+&quot;=&quot;+value+&quot;;&quot;&#xA;	else&#xA;	    Dim ePos: ePos = InStr(sPos, style, &quot;;&quot;)&#xA;		style = Left(style,sPos+len(srch)+1)+value+Mid(style, ePos)&#xA;	end if&#xA;	dgm.StyleEx = style&#xA;	dgm.update()&#xA;End sub&#xA;&#xA;Function GetTagByName(tags, name)&#xA;&#xA;	Dim i&#xA;	Dim tag As EA.TaggedValue&#xA;	Set tag = Nothing&#xA;	If Not tags Is Nothing Then&#xA;		For i = 0 To tags.Count - 1&#xA;			If tags.GetAt(i).Name = name Then&#xA;				Set tag = tags.GetAt(i)&#xA;				Exit For&#xA;			End If&#xA;		Next&#xA;	End If&#xA;	Set GetTagByName = tag&#xA;&#xA;End Function&#xA;&#xA;Function GetTagValByName(tags, name)&#xA;&#xA;	Dim ret&#xA;	ret = &quot;&quot;&#xA;&#xA;	If Not tags Is Nothing Then&#xA;		Dim i&#xA;		Dim tag As EA.TaggedValue&#xA;'		Set tag = tags.GetByName(name)&#xA;		For i = 0 To tags.Count - 1&#xA;			If tags.GetAt(i).Name = name Then&#xA;				ret = tags.GetAt(i).Value&#xA;				Exit For&#xA;			End If&#xA;		Next&#xA;	End If&#xA;&#xA;	GetTagValByName = ret&#xA;&#xA;End Function&#xA;&#xA;&#xA;Sub SetTagValByName(tags, name, val, notes)&#xA;&#xA;	If Not tags Is Nothing And Len(name) &gt; 0 Then&#xA;		Dim tag As EA.TaggedValue&#xA;'		Set tag = tags.GetByName(name)&#xA;		Set tag = GetTagByName(tags, name)&#xA;		If Not tag Is Nothing Then&#xA;			tag.Value = val&#xA;			tag.Notes = notes&#xA;			tag.Update&#xA;			tags.Refresh&#xA;		Else&#xA;			Set tag = tags.AddNew(name, val)&#xA;			tag.notes = notes&#xA;			tag.Update&#xA;			tags.Refresh&#xA;		End If&#xA;	End If&#xA;&#xA;End Sub&#xA;&#xA;function GetElementByName(eltList,name)&#xA;	set GetElementByName = nothing&#xA;	&#xA;	dim elt&#xA;	for each elt in eltList&#xA;		if elt.name = name then &#xA;			set GetElementByName = elt&#xA;			exit function&#xA;		end if&#xA;	next&#xA;end function&#xA;&#xA;' Adds a property to an element&#xA;' Carefull: no check if the property already exists!&#xA;sub AddProperty(eltGUID,pName,pType,pValue,pComment)&#xA;	dim props: set props = EAST.ExecuteSQL(SQL_GET_OBJECTPROPERTIES,eltGUID)&#xA;	if props is nothing or props.count = 0  then&#xA;		' create the very first property in the set&#xA;		dim guid: guid = EAST.GenerateGUID()&#xA;		dim SQL: SWL = EAST.StrRep(SQL_INS_OBJECTPROPERTIES, _&#xA;			guid+&quot;|&quot;+eltGUID+&quot;|&quot;+pName+&quot;|&quot;+pType+&quot;|&quot;+pValue+&quot;|&quot;+pComment )&#xA;		Repository.Execute(SQL)&#xA;	else&#xA;		dim ID : ID = props.item(0).item(&quot;XREFID&quot;)&#xA;		dim DESC : DESC = props.item(0).item(&quot;DESCRIPTION&quot;)&#xA;		DESC = DESC + EAST.StrRep(&quot;@PROP=@NAME={0}@ENDNAME;@TYPE={1}@ENDTYPE;@VALU={2}@ENDVALU;@PRMT={3}@ENDPRMT;@ENDPROP;&quot;, _&#xA;			pName+&quot;|&quot;+pType+&quot;|&quot;+pValue+&quot;|&quot;+pComment )&#xA;		Repository.Execute(EAST.StrRep(SQL_UPD_OBJECTPROPERTIES, ID+&quot;|&quot;+DESC)) &#xA;	end if&#xA;end sub&#xA;&#xA;' Remove an element from the model&#xA;sub DeleteElementFromModel(elt)		&#xA;	dim elements, i&#xA;	if elt.ParentID = 0 then&#xA;		set elements = GetPackageByID(elt.PackageID).elements&#xA;	else &#xA;		set elements = GetElementByID(elt.ParentID).elements&#xA;	end if&#xA;&#xA;	for i = 0 to elements.Count - 1&#xA;		if elements.GetAt(i).ElementID = elt.ElementID then&#xA;			elements.DeleteAt i, false&#xA;			Elements.Refresh()&#xA;			EAST.LogInfo(&quot;Deleted &quot;&amp;elt.ElementID)&#xA;			exit sub&#xA;		end if&#xA;	next&#xA;end sub"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="410"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{BD160839-751B-4ea5-874E-580BDBC87F5D}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_GenerateDocContext&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Generate a document containing all diagrams that include an element (context)&#xA;'&#xA;' NOTE: the generated document is in RTF which doesn't compress images very well/at all, so the RTF  &#xA;' should be converted to word after generation.&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;!INC TFCS_Support.TFCS_DocumentGeneration&#xA;&#xA;' Generating element context&#xA;const ELTX_CONTEXT_MASTER = &quot;TFCS_ContextMaster&quot;&#xA;const ELTX_CONTEXT_DIAGRAM = &quot;TFCS_ContextDiagram&quot;&#xA;&#xA;' Add a menuitem to the project browser context menu&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	if MenuLocation = &quot;TreeView&quot; and MenuName = MNU_TFCSMAIN then&#xA;		dim item: set item = GetTreeSelectedObject()&#xA;		Select Case item.ObjectType&#xA;			Case 4&#xA;				EA_GetMenuItems = MNU_GENERATECONTEXTRTF&#xA;			Case 5 &#xA;				EA_GetMenuItems = MNU_GENERATECONTEXTRTF&#xA;			Case Else&#xA;				' No context-specific items&#xA;		end select&#xA;	end if&#xA;end Function&#xA;&#xA;' Handle click event&#xA;'dim oWord,oFSO&#xA;Sub EA_MenuClick( MenuName , ItemName )&#xA;	if Menuname = MNU_TFCSMAIN and itemName = MNU_GENERATECONTEXTRTF then&#xA;		dim path: path = EAST.FolderBrowserDialog(DOCGEN_OUTPUT_LOCATION)&#xA;		if path &lt;&gt; &quot;&quot; then&#xA;			dim item: set item = GetTreeSelectedObject()&#xA;'			Set oWord = CreateObject(&quot;Word.Application&quot;)&#xA;'			Set oFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xA;'			oWord.Visible = True&#xA;			GenerateContextDocumentRTF item,path&#xA;'			oWord.Quit&#xA;'			set oWord = nothing&#xA;'			set oFSO = nothing&#xA;			EAST.MsgBox &quot;Context is opgenomen onder &quot;+ _&#xA;				vbCRLF+path+vbCRLF+vbCRLF+&quot;LET OP de documenten zijn in RTF formaat.&quot;+vbCRLF+ _&#xA;				&quot;Gebruik MSWord om elk document om te zetten in Word formaat.&quot;,0,&quot;Genereren context documentatie&quot;&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;' Generate a document containing all diagrams that include a specific element&#xA;' IN: an EA.Element and location for output&#xA;' NOTES: &#xA;'	- Uses templates ELTX_ContextPreface for general document layout and ELTX_ContextDiagram for each diagram found&#xA;sub GenerateContextDocumentRTF(item,rootPath)&#xA;	EAST.LogStart &quot;GenerateContextDocumentRTF(&quot;&amp;item.Name&amp;&quot;)&quot;&#xA;&#xA;	dim elt as EA.Element&#xA;	set elt = item&#xA;&#xA;	dim path: path = rootPath+&quot;/Context_&quot;&amp;elt.Name&amp;&quot;.rtf&quot;&#xA;	&#xA;	dim gen as EA.DocumentGenerator&#xA;	set gen = Repository.CreateDocumentGenerator()&#xA; &#xA;	if not gen.NewDocument(&quot;&quot;) then&#xA;		EAST.LogError &quot;Unable to create a new document: &quot; + gen.GetLastError()&#xA;		EAST.LogEnd &quot;GenerateContextDocumentRTF&quot;&#xA;		exit sub&#xA;	end if&#xA;	&#xA;	' If the element has a linked document, use that as a template for the main body of the document&#xA;	' If not use a standard template 'ELTX_ContextPreface'&#xA;	if not gen.InsertLinkedDocument(elt.ElementGUID) then&#xA;		EAST.LogWarning &quot;Element has no linked document or unable to load a linked document, defaulting to standard template 'ELTX_CTXT_PREFACE'&quot;&#xA;		if not gen.DocumentElement(elt.ElementID,0,ELTX_CONTEXT_MASTER) then&#xA;			EAST.LogError &quot;Unable to generate preface (is 'ELTX_CTXT_PREFACE' missing?): &quot; + gen.GetLastError()&#xA;		end if&#xA;	end if&#xA;	&#xA;	dim name: name = elt.Name&#xA;	if name = &quot;&quot; then name = &quot;&lt;omschrijving ontbreekt&gt;&quot; end if&#xA;&#xA;	' Document all diagrams including this element&#xA;	dim diagrams: Set diagrams =  EAST.ExecuteSQL(DOCGEN_SQL_DIAGRAMSWITHELT,elt.ElementGUID)&#xA;	if diagrams.count &gt; 0 then&#xA;		gen.InsertText &quot;Directe verwijzingen '&quot;+name+&quot;'&quot;+vbCRLF,&quot;Heading 2&quot;&#xA;	end if&#xA;	dim	diagram&#xA;	for each diagram in diagrams.Items	&#xA;		dim DiagramGUID: DiagramGUID = diagram.item(&quot;EA_GUID&quot;)&#xA;		EAST.LogInfo(&quot;Adding diagram: &quot;&amp;DiagramGUID)&#xA;		If not gen.DocumentDiagram(diagram.item(&quot;ID&quot;),0,ELTX_CONTEXT_DIAGRAM) then&#xA;			gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_CONTEXT_DIAGRAM+&quot;' for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;			EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_CONTEXT_DIAGRAM+&quot;' for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;		end if&#xA;	next&#xA;&#xA;	' Document all diagrams including this element - as classifier-&#xA;	Set diagrams = EAST.ExecuteSQL(DOCGEN_SQL_DIAGRAMSWITHELTASCLASSIFIER,elt.ElementGUID)&#xA;	if diagrams.count &gt; 0 then&#xA;		gen.InsertText &quot;Indirecte verwijzingen '&quot;+name+&quot;'&quot;+vbCRLF,&quot;Heading 2&quot;&#xA;	end if&#xA;	for each diagram in diagrams.Items	&#xA;		DiagramGUID = diagram.item(&quot;EA_GUID&quot;)&#xA;		EAST.LogInfo(&quot;Adding diagram: &quot;&amp;DiagramGUID)&#xA;		If not gen.DocumentDiagram(diagram.item(&quot;ID&quot;),0,ELTX_CONTEXT_DIAGRAM) then&#xA;			gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_CONTEXT_DIAGRAM+&quot;' for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;			EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_CONTEXT_DIAGRAM+&quot;' for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;		end if&#xA;	next&#xA;	&#xA;	if not gen.ReplaceField(SYSTEM,EAST.GetModelForPackage(item.packageID).name) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+SYSTEM+&quot;' with value '&quot;+EAST.GetModelForPackage(item.packageID).name+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	if not gen.ReplaceField(AUTEUR,EAST.UserName()) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+AUTEUR+&quot;' with value '&quot;+EAST.UserName()+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	if not gen.SaveDocument(path,0) then&#xA;		EAST.LogError &quot;Unable to save document to '&quot;+path+&quot;': &quot; + gen.GetLastError()&#xA;	else&#xA;		EAST.LogInfo &quot;Generated '&quot;+path+&quot;' for element '&quot; + elt.Name+&quot;'&quot;&#xA;	end if&#xA;&#xA;	EAST.LogEnd &quot;GenerateContextDocumentRTF&quot;&#xA;end sub&#xA;&#xA;sub DocumentRemarks(gen,DiagramGUID)&#xA;	dim notes: Set notes =  EAST.ExecuteSQL(DOCGEN_SQL_DGM_REMARKSFORDGM,DiagramGUID)&#xA;	if notes is nothing then&#xA;		gen.InsertText &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; ,&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; &#xA;	else&#xA;		if notes.count &gt; 0 then&#xA;			gen.InsertText &quot;Toelichting bij de flow&quot;+vbCrlf,&quot;Strong&quot;&#xA;			dim eltRTF as EA.Element&#xA;			dim note&#xA;			for each note in notes.Items&#xA;				set eltRTF = GetElementByID(note.item(&quot;OBJECT_ID&quot;))&#xA;				if not gen.DocumentElement(eltRTF.ElementID,0,ELTX_WFSPEC_FLOWREMARKS) then&#xA;					EAST.LogError &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;				end if&#xA;			next&#xA;		end if&#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="411"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{72C04D72-8B9E-47a5-B115-791084D9DCF5}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_DocumentGeneration&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Module containing helper methods for document generation&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;const SYSTEM = &quot;SYSTEM&quot;&#xA;const AUTEUR = &quot;AUTEUR&quot;&#xA;&#xA;' Include notes from all elements in a specific diagram within a boundary 'Toelichting'&#xA;' in the document currently being generated.&#xA;sub DocumentRemarks(gen,DiagramGUID,template)&#xA;	dim notes: Set notes =  EAST.ExecuteSQL(DOCGEN_SQL_DGM_REMARKSFORDGM,DiagramGUID)&#xA;	if notes is nothing then&#xA;		gen.InsertText &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; ,&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;'&quot; &#xA;	else&#xA;		if notes.count &gt; 0 then&#xA;			gen.InsertText &quot;Toelichting bij de flow&quot;+vbCrlf,&quot;Strong&quot;&#xA;			dim eltRTF as EA.Element&#xA;			dim note&#xA;			for each note in notes.Items&#xA;				set eltRTF = GetElementByID(note.item(&quot;OBJECT_ID&quot;))&#xA;				if not gen.DocumentElement(eltRTF.ElementID,0,template) then&#xA;					EAST.LogError &quot;Unable to generate notes for diagram GUID='&quot;+DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;				end if&#xA;			next&#xA;		end if&#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="412"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{C1E97F55-F518-47bc-A766-6CE3EE012AC6}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_ExecuteScript&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Executes a script when double-clicking on an element&#xA;'&#xA;' The element must have a stereotype of SCRIPT&#xA;' The contents of the NOTES field are executed as VBscript&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;const ES_TITLE_SCRIPTDELETE = &quot;Verwijderen modelelement&quot;&#xA;dim ES_PROMPT_SCRIPTDELETE : ES_PROMPT_SCRIPTDELETE = _&#xA;	&quot;Dit element kan pas verwijderd worden nadat.&quot;+ _&#xA;	vbCRLF+&quot;het stereotype SCRIPT bij dit element is verwijderd&quot;&#xA;&#xA;' If element has stereotype SCRIPT =&gt; execute notes content as VBscript&#xA;Function EA_OnContextItemDoubleClicked(GUID,ot)&#xA;	EA_OnContextItemDoubleClicked = false ' Continue calling other handlers&#xA;	if ot = 4 then&#xA;		dim elt as EA.Element&#xA;		set elt = GetElementByGuid(GUID)&#xA;		if elt.Stereotype = &quot;SCRIPT&quot; then&#xA;			EAST.RunScript &quot;VBSCRIPT&quot;,GetFormatFromField(&quot;TXT&quot;,elt.Notes)&#xA;			EA_OnContextItemDoubleClicked = true&#xA;		end if&#xA;	end if&#xA;end function&#xA;&#xA;' if element has stereotype SCRIPT =&gt; prevent deletion&#xA;Function EA_OnPreDeleteDiagramObject( Info ) &#xA;	EA_OnPreDeleteDiagramObject = true ' Continue calling other handlers&#xA;&#xA;	dim elt: set elt = GetElementByID(Info.get(&quot;ID&quot;).Value)&#xA;	if elt.Stereotype = &quot;SCRIPT&quot; then&#xA;		EAST.MsgBox ES_PROMPT_SCRIPTDELETE,16,ES_TITLE_SCRIPTDELETE&#xA;		EA_OnPreDeleteDiagramObject = false&#xA;	end if&#xA;end Function&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="413"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{D32B49D7-40BF-4eb1-840E-47BA632EEB44}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_GenerateDocWFSpec&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Generate a complete specification for a workflow (suitable for approval)&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;!INC TFCS_Support.TFCS_DocumentGeneration&#xA;&#xA;' Generating WF spec&#xA;const ELTX_WFSPEC_MASTER = &quot;TFCS_WFSpecMaster&quot;&#xA;const ELTX_WFSPEC_FLOWDGM = &quot;TFCS_WFSpecFlowDiagram&quot;&#xA;const ELTX_WFSPEC_FLOWREMARKS = &quot;TFCS_WFSpecFlowRemarks&quot;&#xA;const ELTX_WFSPEC_COMPDGM = &quot;TFCS_WFSpecCompFlowDiagram&quot;&#xA;&#xA;' Add a menuitem to the project browser context menu&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	if MenuLocation = &quot;TreeView&quot; and MenuName = MNU_TFCSMAIN then&#xA;		dim result(1)&#xA;		result(0) = &quot;-&quot;&#xA;		result(1) = MNU_GENERATE_WFSPEC&#xA;		dim item: set item = GetTreeSelectedObject()&#xA;		Select Case item.ObjectType&#xA;			Case 4&#xA;				if(item.Stereotype = &quot;TFCS_Activity&quot; or item.Stereotype = &quot;TFCS_Workflow&quot;) then&#xA;					EA_GetMenuItems = result&#xA;				end if&#xA;			Case 5 &#xA;				EA_GetMenuItems = result&#xA;			Case Else&#xA;				' No context-specific items&#xA;		end select&#xA;	end if&#xA;end Function&#xA;&#xA;' Handle click event&#xA;dim oWord,oFSO&#xA;Sub EA_MenuClick( MenuName , ItemName )&#xA;	if Menuname = MNU_TFCSMAIN and itemName = MNU_GENERATE_WFSPEC then&#xA;		dim path: path = EAST.FolderBrowserDialog(DOCGEN_OUTPUT_LOCATION)&#xA;		if path &lt;&gt; &quot;&quot; then&#xA;			dim item: set item = GetTreeSelectedObject()&#xA;			if item.ObjectType = 4 then&#xA;				if item.Stereotype = &quot;TFCS_Workflow&quot; then&#xA;					' The generator expects an element of type TFCS_Activity&#xA;					item = GetElementByID(item.ParentID) &#xA;				end if&#xA;			end if&#xA;			Set oWord = CreateObject(&quot;Word.Application&quot;)&#xA;			Set oFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xA;			oWord.Visible = True&#xA;			GenerateWFSpecificationRTF item,path&#xA;			oWord.Quit&#xA;			set oWord = nothing&#xA;			set oFSO = nothing&#xA;			EAST.MsgBox &quot;Specificaties zijn opgenomen onder &quot;+ _&#xA;				vbCRLF+path+vbCRLF+vbCRLF+&quot;LET OP de documenten zijn in RTF formaat.&quot;+vbCRLF+ _&#xA;				&quot;Gebruik MSWord om elk document om te zetten in Word formaat.&quot;,0,&quot;Genereren documentatie&quot;&#xA;		end if&#xA;	end if&#xA;end sub&#xA;&#xA;&#xA;' Generate a workflow specification document for the element/elements within a package&#xA;' IN: item = an EA.Element of type TFCS_Activity, or a package&#xA;'     path = location for generated files&#xA;' NOTES:&#xA;'	- Uses templates ELTX_WFSpecPreface for general document layout and ELT_WFSpecDiagram for each diagram found&#xA;'	- Pakages are searched recursively for elements of type 'TFC_Activity'&#xA;function GenerateWFSpecificationRTF(item,rootPath)&#xA;	EAST.LogStart &quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;&#xA;	GenerateWFSpecificationRTF = false&#xA;	&#xA;	dim pck&#xA;	Select Case item.ObjectType&#xA;		case 5&#xA;			' Recursively handle packages&#xA;			dim elt&#xA;			for each elt in item.Elements&#xA;				if elt.Stereotype = &quot;TFCS_Activity&quot; then&#xA;					GenerateWFSpecificationRTF elt,rootPath&#xA;				end if&#xA;			next&#xA;			for each pck in item.Packages&#xA;				GenerateWFSpecificationRTF pck,rootPath&#xA;			next&#xA;			EAST.LogEnd(&quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;)&#xA;			exit function&#xA;	end select&#xA;	&#xA;	dim ucAct as EA.Element&#xA;	set ucAct = item ' ... just so we can use inellisense support of the EA script editor (item is not typed)&#xA;&#xA;	' Handle a single element&#xA;	dim fileName: fileName = Replace(ucAct.Name,&quot;/&quot;,&quot;&amp;&quot;)&#xA;	fileName = Replace(fileName,&quot;\&quot;,&quot;_&quot;)&#xA;	dim path: path = rootPath+&quot;/Spec_&quot;+fileName&#xA;	&#xA;	' Prepare: get all involved model elements&#xA;	dim dgmSpec as EA.Diagram&#xA;	set dgmSpec = ucAct.CompositeDiagram&#xA;&#xA;	dim uc as EA.Element&#xA;	dim dgmFlow as EA.Diagram&#xA;	set uc = ucAct.Elements.GetByName(ucAct.Name)&#xA;	set dgmFlow = uc.CompositeDiagram&#xA;&#xA;	dim gen as EA.DocumentGenerator&#xA;	set gen = Repository.CreateDocumentGenerator()&#xA; &#xA;	if not gen.NewDocument(&quot;&quot;) then&#xA;		EAST.LogError &quot;Unable to create a new document: &quot; + gen.GetLastError()&#xA;		EAST.LogEnd &quot;GenerateWFSpecificationRTF&quot;&#xA;		exit function&#xA;	end if&#xA;&#xA;	if not gen.DocumentElement(ucAct.ElementID,0,ELTX_WFSPEC_MASTER) then&#xA;		EAST.LogError &quot;Unable to generate document from template '&quot;+ELTX_WFSPEC_MASTER+&quot;': &quot; + gen.GetLastError()&#xA;	end if&#xA;&#xA;	EAST.LogInfo(&quot;Adding UC flow diagram: &quot;&amp;dgmFlow.DiagramGUID)&#xA;	DocumentFlowDetails gen, dgmFlow&#xA;&#xA;	if not gen.ReplaceField(SYSTEM,EAST.GetModelForPackage(uc.packageID).name) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+SYSTEM+&quot;' with value '&quot;+EAST.GetModelForPackage(uc.packageID).name+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	if not gen.ReplaceField(AUTEUR,EAST.UserName()) then&#xA;		EAST.LogError &quot;Unable to replae field '&quot;+AUTEUR+&quot;' with value '&quot;+EAST.UserName()+&quot;': &quot;+ gen.GetLastError()&#xA;	end if&#xA;&#xA;	if not gen.SaveDocument(path+&quot;.rtf&quot;,0) then&#xA;		EAST.LogError &quot;Unable to save document to '&quot;+path+&quot;.rtf': &quot; + gen.GetLastError()&#xA;	else&#xA;		EAST.LogInfo &quot;Generated '&quot;+path+&quot;.rtf' for element '&quot; + item.Name+&quot;'&quot;&#xA;	end if&#xA;&#xA;	' Convert the generated RTF to word format (this also greatly reduces the size of the document)&#xA;	dim oDoc : set oDoc = oWord.Documents.Open(path+&quot;.rtf&quot;)&#xA;	oDoc.Repaginate&#xA;	oDoc.SaveAs path+&quot;.doc&quot;,0&#xA;	oDoc.Close()&#xA;	oFSO.DeleteFile(path+&quot;.rtf&quot;)&#xA;	&#xA;	EAST.LogEnd &quot;GenerateWFSpecificationRTF(&quot;&amp;item.Name&amp;&quot;)&quot;&#xA;end function&#xA;&#xA;sub DocumentFlowDetails(gen,dgm)&#xA;	If not gen.DocumentDiagram(dgm.DiagramID,0,ELTX_WFSPEC_FLOWDGM) then&#xA;		gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_FLOWDGM+&quot;' for diagram GUID='&quot;+dgm.DiagramGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_FLOWDGM+&quot;' for diagram GUID='&quot;+dgm.DiagramGUID+&quot;': &quot; + gen.GetLastError()&#xA;	end if&#xA;	&#xA;	DocumentRemarks gen,dgm.DiagramGUID,ELTX_WFSPEC_FLOWREMARKS&#xA;	&#xA;	EAST.LogInfo(&quot;Recursively adding component &amp; screen diagrams... &quot;)&#xA;	dim comps: Set comps =  EAST.ExecuteSQL(GEN_SQL_DGM_COMPLEXSTEPS,dgm.DiagramID)&#xA;	if not comps is nothing then&#xA;		if comps.count &gt; 0 then&#xA;			gen.InsertText &quot;Componenten en schermen&quot;+vbCRLF,&quot;Heading 2&quot;&#xA;		end if&#xA;		dim comp&#xA;		for each comp in comps.Items&#xA;			DocumentComponent gen,comp,3&#xA;		next&#xA;	end if&#xA;&#xA;end sub&#xA;&#xA;sub DocumentComponent(gen,comp,level)&#xA;	dim compDgmID: compDgmID = comp.item(&quot;DIAGRAM_ID&quot;)&#xA;	dim name: name = comp.item(&quot;NAME&quot;)&#xA;	if name = &quot;&quot; then name = &quot;&lt;omschrijving ontbreekt&gt;&quot; end if&#xA;	&#xA;	gen.InsertText name&amp;vbCRLF,&quot;Heading &quot;&amp;level&#xA;	&#xA;	If not gen.DocumentDiagram(compDgmID,0,ELTX_WFSPEC_COMPDGM) then&#xA;		gen.InsertText &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_COMPDGM+&quot;' for diagram GUID='&quot;+compDgmGUID+&quot;': &quot; + gen.GetLastError(),&quot;Strong&quot;&#xA;		EAST.LogWarning &quot;Unable to generate from template '&quot;+ELTX_WFSPEC_COMPDGM+&quot;' for diagram GUID='&quot;+compDgmGUID+&quot;': &quot; + gen.GetLastError()&#xA;	end if&#xA;	DocumentRemarks gen,compDgmGUID,ELTX_WFSPEC_FLOWREMARKS&#xA;&#xA;	EAST.LogInfo(&quot;Recursively adding component &amp; screen diagrams... &quot;)&#xA;	dim subComps: Set subComps =  EAST.ExecuteSQL(GEN_SQL_DGM_COMPLEXSTEPS,compDgmID)&#xA;	if not subComps is nothing then&#xA;		if subComps.count&gt;0 then&#xA;			gen.InsertText &quot;Subcomponenten&quot;&amp;vbCRLF,&quot;Heading &quot;&amp;level+1&#xA;		end if&#xA;		dim subComp&#xA;		for each subComp in subComps.Items&#xA;			DocumentComponent gen,subComp,level+2&#xA;		next&#xA;	end if&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="414"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{95899319-791B-46bc-A6E6-A4122451DB62}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="EAST"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="415"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{37959A18-BFFF-4c13-B7FF-477956CE62F3}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_Guidance&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Can be used within SCRIPT elements to display specific video&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;!INC TFCS_Support.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_commons&#xA;&#xA;' Open TFCS guidance video in IE, attach to running video if possible&#xA;sub ShowHelp(fileName)&#xA;	&#xA;	' Find a running instance for TFCS guidance, if not found, create one&#xA;	dim objIE:	set objIE = nothing&#xA;	dim wsh: set wsh = createObject(&quot;Shell.Application&quot;)&#xA;	Dim guidanceDir: guidanceDir = ucase(TFCSBASEDIR+&quot;/instructions/&quot; )&#xA;	dim ie&#xA;    For Each ie In wsh.Windows&#xA;		if InStr(ucase(ie.LocationURL),&quot;FILE:///&quot;+guidanceDir)&gt;0 then&#xA;			' How to make windows but the running IE instance to the foreground, on -all- platforms???&#xA;			set objIE = ie&#xA;			dim title: title = Replace(Replace(Mid(ie.LocationURL,9),&quot;/&quot;,&quot;\&quot;),&quot;%20&quot;,&quot; &quot;)&#xA;			dim ssh: set ssh = CreateObject(&quot;Wscript.Shell&quot;)&#xA;			ssh.AppActivate(title+&quot; - Windows Internet Explorer&quot;)&#xA;			ssh.AppActivate(title+&quot; - Microsoft Internet Explorer&quot;)&#xA;		end if&#xA;	next&#xA;&#xA;	if objIE is nothing then&#xA;		set objIE =CreateObject(&quot;InternetExplorer.Application&quot;)&#xA;		objIE.toolbar = 0&#xA;		objIE.StatusBar = 0&#xA;		objIE.Top = 5&#xA;		objIE.Height = 950&#xA;		objIE.Width = 1470&#xA;	end if&#xA; 	objIE.Navigate guidanceDir+fileName&#xA;	do while objIE.Busy or objIE.ReadyState &lt;&gt; 4&#xA;		EAST.sleep 100 &#xA;	loop&#xA;	objIE.Visible = 1&#xA;end sub"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="416"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="TFCS_EventHandlers"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="417"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{028AB4F2-1657-4cd8-8C47-127E758C19D3}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_CreateFromToolbox&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' The core of TFCS: creation of new model elements using the diagram toolboxes&#xA;'&#xA;' The component checks if a dropped element &#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_constants&#xA;!INC TFCS_Support.TFCS_SQL&#xA;!INC TFCS_Support.TFCS_TEXTS&#xA;!INC TFCS_Support.TFCS_commons&#xA;!INC TFCS_Support.TFCS_WorkflowCreation&#xA;&#xA;' Location in private workspace to put new elements  &#xA;const GEN__WORKSPACE = &quot;Onderhanden&quot; &#xA;const GEN__PCK_ACTORS = &quot;Actoren&quot;&#xA;const GEN__PCK_REQUIREMENTS = &quot;Requirements&quot;&#xA;const GEN__PCK_TODO = &quot;Nog oppakken&quot;&#xA;const GEN__PCK_DOMAIN = &quot;Domein&quot;&#xA;const GEN__PCK_SCREENS =&quot;Schermen&quot;&#xA;const GEN__PCK_COMPONENTS = &quot;Componenten&quot;&#xA;const GEN__PCK_AUTHORISATIONS =&quot;Authorisaties&quot;&#xA;const GEN__PCK_WORKFLOWS =&quot;Workflows&quot;&#xA;&#xA;' Automatically creates a workspace for a new user&#xA;' The workspace is used to store newly created diagrams and model elements.&#xA;Sub EA_FileOpen()&#xA;	if EAST.GetPackageByFQN(GEN__WORKSPACE+&quot;.&quot;+EAST.UserName()) is nothing then&#xA;		dim pck as EA.Package&#xA;		set pck = EAST.GetPackageByFQN(GEN__WORKSPACE+&quot;.&quot;+EAST.UserName(),true)&#xA;		dim dgm as EA.Diagram&#xA;		set dgm = pck.Diagrams.AddNew(&quot;&quot;,&quot;TFCS::TFCS_FlowsDiagram&quot;)&#xA;		dgm.Name = &quot;Workflow kladblok&quot;&#xA;		dgm.update()&#xA;		set dgm = pck.Diagrams.AddNew(&quot;&quot;,&quot;TFCS::TFCS_DomainDiagram&quot;)&#xA;		dgm.Name = &quot;Domeinmodel kladblok&quot;&#xA;		dgm.update()&#xA;		set dgm = pck.Diagrams.AddNew (&quot;&quot;,&quot;TFCS::TFCS_RequirementsDiagram&quot;)&#xA;		dgm.Name = &quot;Requirements kladblok&quot;&#xA;		dgm.update()&#xA;		set dgm = pck.Diagrams.AddNew (&quot;&quot;,&quot;TFCS::TFCS_MaintenanceDiagram&quot;)&#xA;		dgm.Name = &quot;TODO lijst kladblok&quot;&#xA;		dgm.update()&#xA;		pck.Diagrams.Refresh()&#xA;	end if&#xA;end sub&#xA;&#xA;' Handle post-creation steps for complex TFCS elements&#xA;Function EA_OnPostNewElement( Info ) &#xA;	EAST.LogStart(&quot;EA_OnPostNewElement&quot;)&#xA;	EA_OnPostNewElement = false	' Default: no changes to new element&#xA;	&#xA;	dim dgm: set dgm = GetCurrentDiagram() ' &#xA;	if(dgm is nothing) then &#xA;		' Just a precaution: TFCS_DragDropValidator ensures there's always a diagram present&#xA;		exit function &#xA;	end if&#xA;	&#xA;	dim dgmStereo : dgmStereo = GetStyleEx(dgm,&quot;MDGDgm&quot;)&#xA;	if Left(dgmStereo,4) &lt;&gt; &quot;TFCS&quot; then	&#xA;		' Not dropped on a TFCS diagram =&gt; don't care!&#xA;		EAST.LogInfo(&quot;Diagram is non-TFCS =&gt; standard EA handling&quot;)&#xA;	else&#xA;		dim eltDropped : set eltDropped = GetElementByID(Info.get(&quot;ElementID&quot;).value)&#xA;		dim eltStereo : eltStereo = eltDropped.Stereotype&#xA;		if eltStereo = &quot;&quot; or Left(eltStereo,4) &lt;&gt; &quot;TFCS&quot; then&#xA;			' Droppng non-TFCS element =&gt; no special logic required&#xA;		else&#xA;			EA_OnPostNewElement = OnDropElement(dgm,dgmStereo,eltDropped)&#xA;		end if&#xA;	end if&#xA;		&#xA;	EAST.LogEnd(&quot;EA_OnPostNewElement&quot;)&#xA;end function&#xA;&#xA;dim replaceDroppedBy&#xA;Function OnDropElement(dgm,dgmStereo,eltDropped ) &#xA;	EAST.LogStart(&quot;OnDropElement&quot;)&#xA;	OnDropElement = false&#xA;	&#xA;	set replaceDroppedBy = eltDropped&#xA;&#xA;	HandleDropElement dgm,dgmStereo,eltDropped&#xA;	&#xA;	if replaceDroppedBy is nothing then&#xA;		EAST.LogInfo(&quot;Dropped element removed...&quot;)&#xA;		DeleteElementFromModel(eltDropped)&#xA;	elseif replaceDroppedBy.ElementID &lt;&gt; eltDropped.ElementID then&#xA;		if ObjectIsOnDiagram(replaceDroppedBy.ElementID,dgm) then&#xA;			EAST.LogInfo(&quot;Object already on diagram =&gt; not allowed&quot;)&#xA;			DeleteElementFromModel(eltDropped)&#xA;			EAST.MsgBox DDH_PROMPT_ELTONDGM,16,DDH_TITLE_ELTONDGM&#xA;		else&#xA;			EAST.LogInfo(&quot;Replacing dropped element with '&quot;+replaceDroppedBy.name+&quot;' type &quot;+replaceDroppedBy.Type+&quot;{&quot;++replaceDroppedBy.Stereotype+&quot;)&quot;)&#xA;			dim posX, posY&#xA;			GetCoordinates dgm,eltDropped,posX,posY&#xA;			DeleteElementFromModel(eltDropped)&#xA;			addEltToDiagram replaceDroppedBy, dgm, posX, posY&#xA;			ReloadDiagram(dgm.DiagramID)&#xA;		end if&#xA;	end if&#xA;&#xA;	OnDropElement = true &#xA;	EAST.LogEnd(&quot;OnDropElement&quot;)&#xA;end function&#xA;&#xA;' Get coordinates of the dropped element: this should be the element currently selected&#xA;sub GetCoordinates(dgm,eltDropped,posX,posY)&#xA;	dim result: set result = EAST.ExecuteSQL(SQL_GET_DIAGRAMOBJECT_RECT,dgm.diagramID&amp;&quot;|&quot;&amp;eltdropped.elementid)&#xA;	posX = 200&#xA;	posY = 200&#xA;	if not result is nothing and result.count &gt;= 1 then&#xA;		posX = result.item(0).item(&quot;RECTLEFT&quot;)&#xA;		PosY = -result.item(0).item(&quot;RECTTOP&quot;)&#xA;	end if&#xA;end sub&#xA;&#xA;sub HandleDropElement(dgm,dgmStereo,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropElement&quot;)&#xA;&#xA;	SuppressEADialogs = true &#xA;	if (dgmStereo = &quot;TFCS::TFCS_FlowsDiagram&quot;) then&#xA;		HandleDropOnFlowsDgm dgm,eltDropped &#xA;	elseif (dgmStereo = &quot;TFCS::TFCS_FlowDefnDiagram&quot;) then&#xA;		HandleDropOnFlowDefnDgm dgm,eltDropped &#xA;	elseif (dgmStereo = &quot;TFCS::TFCS_FlowDiagram&quot;) then&#xA;		HandleDropOnFlowDgm dgm,eltDropped &#xA;	elseif (dgmStereo = &quot;TFCS::TFCS_DomainDiagram&quot;) then&#xA;		HandleDropOnDomainDgm dgm,eltDropped &#xA;	elseif (dgmStereo = &quot;TFCS::TFCS_RequirementsDiagram&quot;) then&#xA;		HandleDropOnReqDgm dgm,eltDropped &#xA;	elseif (dgmStereo = &quot;TFCS::TFCS_MaintenanceDiagram&quot;) then&#xA;		HandleDropOnMntDgm dgm,eltDropped &#xA;	else&#xA;		EAST.LogInfo(&quot;Drops on TFCS diagram type '&quot;+dgmStereo+&quot;' not yet defined =&gt; not allowed&quot;)&#xA;		EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_GENERICTYPE),16,DDH_TITLE_NOTALL&#xA;		set replaceDroppedBy = nothing&#xA;		EAST.LogEnd(&quot;HandleDropElement&quot;)&#xA;		exit sub&#xA;	end if&#xA;&#xA;	EAST.LogEnd(&quot;HandleDropElement&quot;)&#xA;end sub&#xA;&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Handlers for specific TFCS diagrams&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;sub HandleDropOnFlowsDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnFlowsDgm&quot;)&#xA;	&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Actor&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Actor&quot;,GEN__PCK_ACTORS)&#xA;		case &quot;TFCS_Workflow&quot; &#xA;			set replaceDroppedBy = SelectWorkflow (dgm,&quot;UseCase,WerkInstructie,BedrijfsProces&quot;,&quot;&quot;)&#xA;		case &quot;TFCS_Requirement&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case else&#xA;			EAST.LogWarning(&quot;not allowed &quot;)&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWSDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnFlowsDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnFlowDefnDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnFlowDefnDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Actor&quot;&#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Actor&quot;,GEN__PCK_ACTORS)&#xA;		case &quot;TFCS_Workflow&quot; &#xA;			dim wfAct : set wfAct = Repository.GetElementByID(dgm.ParentID)&#xA;			dim wfUC : Set wfUC = wfAct.Elements.GetByName(wfAct.Name)&#xA;			dim defaultType : defaultType = GetTagValByName(wfUC.TaggedValues,&quot;WorkflowType&quot;)&#xA;			dim allowedTypes : allowedTypes = defaultType&#xA;			if defaultType = &quot;BedrijfsProces&quot; then&#xA;				allowedTypes = &quot;UseCase,WerkInstructie,BedrijfsProces&quot;&#xA;			elseif defaultType = &quot;WerkInstructie&quot; then&#xA;				allowedTypes = &quot;UseCase,WerkInstructie&quot;&#xA;			end if&#xA;			set replaceDroppedBy = SelectWorkflow (dgm,allowedTypes,defaultType)&#xA;		case &quot;TFCS_DomainInstance&quot; &#xA;			CreateDomainInstance dgm,eltDropped &#xA;		case &quot;TFCS_Requirement&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case else&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDEFDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnFlowDefnDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnFlowDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnFlowDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Action&quot; &#xA;			CreateWorkflowInstance dgm,eltDropped&#xA;		case &quot;TFCS_AuthorisationEffect&quot; &#xA;			CreateAuthorisationEffect dgm,eltDropped &#xA;		case &quot;TFCS_DomainInstance&quot; &#xA;			CreateDomainInstance dgm,eltDropped &#xA;	'	case &quot;TFCS_DomainRule&quot; &#xA;	'		SelectElementForDropOnDiagram  dgm,eltDropped,&quot;Domeinregel&quot;,GEN__PCK_DOMAIN)&#xA;	'	case &quot;TFCS_Sketch&quot; &#xA;	'		CreateCompActionInstance( dgm,elt,&quot;Schermvoorbeeld&quot;)&#xA;		case &quot;TFCS_CompositeAction&quot; &#xA;			dim compType: compType = GetTagValByName(eltDropped.TaggedValues,&quot;CompositeActionType&quot;)&#xA;			if compType = &quot;Scherm&quot; then&#xA;				CreateCompActionInstance dgm,eltDropped,&quot;Scherm&quot; &#xA;			else&#xA;				CreateCompActionInstance dgm,eltDropped,&quot;Component&quot; &#xA;			end if&#xA;		case &quot;TFCS_Requirement&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ActivityInitial&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_ActivityFinal&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_AtomicAction&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_IntermediateResult&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_Decision&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_MergeNode&quot; &#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case &quot;TFCS_Event&quot;&#xA;			UpdateDroppedElement dgm,eltDropped&#xA;		case else &#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_FLOWDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnFlowDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnDomainDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnDomainDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_DomainObject&quot;&#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram  (dgm,eltDropped,eltStereo,&quot;Domeinobject&quot;,GEN__PCK_DOMAIN)&#xA;		case &quot;TFCS_DomainRule&quot; &#xA;			SelectElementForDropOnDiagram  dgm,eltDropped,eltStereo,&quot;Domeinregel&quot;,GEN__PCK_DOMAIN&#xA;		case &quot;TFCS_Requirement&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case else&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_DOMAINDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnDomainDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnReqDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnReqDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.StereoType&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Requirement&quot;&#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_NFR&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Niet-functionele eis&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Legislation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wetgeving&quot;,GEN__PCK_REQUIREMENTS )&#xA;		case &quot;TFCS_Authorisation&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Autorisatie&quot;,GEN__PCK_AUTHORISATIONS )&#xA;		case else&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_REQDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnReqDgm&quot;)&#xA;end sub&#xA;&#xA;sub HandleDropOnMntDgm(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;HandleDropOnMntDgm&quot;)&#xA;	dim eltStereo: eltStereo = eltDropped.Stereotype&#xA;	select case eltStereo &#xA;		case &quot;TFCS_Issue&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Bevinding&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Request&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Wens&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_TBD&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Open punt&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_Ambiguity&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Onduidelijkheid&quot;,GEN__PCK_TODO)&#xA;		case &quot;TFCS_ReviewComment&quot; &#xA;			set replaceDroppedBy = SelectElementForDropOnDiagram (dgm,eltDropped,eltStereo,&quot;Reviewcommentaar&quot;,GEN__PCK_TODO)&#xA;		case else&#xA;			EAST.MsgBox EAST.StrRep(DDH_PROMT_NOTALL,DDH_NOTALL_MNTDGM),16,DDH_TITLE_NOTALL&#xA;			set replaceDroppedBy = nothing&#xA;	end select&#xA;	EAST.LogEnd(&quot;HandleDropOnMntDgm&quot;)&#xA;end sub&#xA;&#xA;' Create a composite action instance in the model to be placed on a diagram&#xA;sub CreateCompActionInstance(dgm,eltDropped,compositeActionType)&#xA;	EAST.LogStart(&quot;CreateCompActionInstance&quot;)&#xA;	dim classifier&#xA;	if (compositeActionType = &quot;Scherm&quot;) then&#xA;		set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_GUI&quot;,&quot;Scherm&quot;,GEN__PCK_SCREENS)&#xA;	elseif (compositeActionType = &quot;Schermvoorbeeld&quot;) then&#xA;		set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_GUI&quot;,&quot;Schermvoorbeeld&quot;,GEN__PCK_SCREENS )&#xA;	elseif (compositeActionType = &quot;Component&quot;) then&#xA;		set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_CompositeActivity&quot;,&quot;Component&quot;,GEN__PCK_COMPONENTS)&#xA;	else&#xA;		EAST.LogInfo(&quot;Unsupported composite action type: &quot;+compositeActionType)&#xA;		EAST.MsgBox &quot;Unsupported composite action type: &quot;+compositeActionType,16,&quot;Creating composite activity&quot;&#xA;		set replaceDroppedBy = nothing&#xA;		EAST.LogEnd(&quot;CreateCompActionInstance&quot;)&#xA;		exit sub&#xA;	end if&#xA;&#xA;	if classifier is nothing then &#xA;		EAST.LogEnd(&quot;CreateCompActionInstance&quot;)&#xA;		exit sub &#xA;	end if&#xA;	&#xA;	' Get the name for the new element&#xA;	dim Name: Name = EAST.InputBox(&quot;Naam: &quot;,&quot;Toevoegen &quot;+compositeActionType,&quot;Mijn &quot;+compositeActionType)&#xA;	if Name = &quot;&quot; then &#xA;		EAST.LogInfo(&quot;User cancelled creation of new &quot;+compositeActionType)&#xA;		EAST.LogEnd(&quot;CreateCompActionInstance&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit sub &#xA;	end if&#xA;	&#xA;	' Link the classifier to the dropped element&#xA;	eltDropped.ClassifierID = classifier.ElementID&#xA;	eltDropped.ClassifierName = classifier.Name&#xA;	eltDropped.Name = Name&#xA;	SetTagValByName eltDropped.TaggedValues,&quot;CompositeActionType&quot;,compositeActionType,&quot;&quot;&#xA;	eltDropped.Update()&#xA;&#xA;	' Set the behaviour (not supported by 9.3 automation API)&#xA;	AddProperty eltDropped.ElementGUID,&quot;kind&quot;,&quot;ActionKind&quot;,&quot;CallBehavior&quot;,&quot;&quot;&#xA;	&#xA;	EAST.LogEnd(&quot;CreateCompActionInstance&quot;)&#xA;end sub&#xA;&#xA;' Create a domainobject instance in the model to be placed on a diagram&#xA;sub CreateDomainInstance(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;CreateDomainInstance&quot;)&#xA;	dim classifier&#xA;	set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_DomainObject&quot;,&quot;Domeinobject&quot;,GEN__PCK_DOMAIN)&#xA;	if classifier is nothing then &#xA;		EAST.LogInfo(&quot;User cancelled (no domainobject selected)&quot;)&#xA;		EAST.LogEnd(&quot;CreateDomainInstance&quot;)&#xA;		exit sub &#xA;	end if&#xA;	&#xA;	' Most of the time the domaininstance is not given a name so don't ask for it&#xA;	' User can always add one later&#xA;	eltDropped.ClassifierID = classifier.ElementID&#xA;	eltDropped.ClassifierName = classifier.Name&#xA;	eltDropped.Name = &quot;&quot;&#xA;	eltDropped.Update()&#xA;	EAST.LogInfo(&quot;Updated dropped element with selected classifier ('&quot;+classifier.Name+&quot;')&quot;)&#xA;	EAST.LogEnd(&quot;CreateDomainInstance&quot;)&#xA;end sub&#xA;&#xA;' Create an authorisation effect in the model to be placed on a diagram&#xA;sub CreateAuthorisationEffect(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;CreateAuthorisationEffect&quot;)&#xA;	dim classifier&#xA;	set classifier = AddClassifierToDropOnDiagram (dgm,eltDropped,&quot;TFCS_Authorisation&quot;,&quot;Authorisatie&quot;,GEN__PCK_AUTHORISATIONS)&#xA;	if classifier is nothing then &#xA;		EAST.LogInfo(&quot;User cancelled (no authorisation selected)&quot;)&#xA;		EAST.LogEnd(&quot;CreateAuthorisationEffect&quot;)&#xA;		exit sub &#xA;	end if&#xA;&#xA;	' The effect of an AI from a user perspective: eg, data become visible, additional action can be performed, ...&#xA;	dim effect: effect = EAST.InputBox(&quot;Het effect van autorisatie '&quot;+classifier.Name+&quot;'&quot;+vbCRLF+ _&#xA;		&quot;op deze plaats is dat: &quot;,&quot;Nieuw autorisatie effect&quot;,&quot;&quot;)&#xA;	if effect = &quot;&quot; then &#xA;		EAST.LogInfo(&quot;User cancelled creation of autorisationitem effect&quot;)&#xA;		EAST.LogEnd(&quot;CreateAuthorisationEffect&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit sub &#xA;	end if&#xA;&#xA;	eltDropped.Notes = effect&#xA;	eltDropped.ClassifierID = classifier.ElementID&#xA;	eltDropped.ClassifierName = classifier.Name&#xA;	eltDropped.Update()&#xA;	EAST.LogInfo(&quot;Updated dropped element with selected classifier ('&quot;+classifier.Name+&quot;')&quot;)&#xA;	EAST.LogEnd(&quot;CreateAuthorisationEffect&quot;)&#xA;end sub&#xA;&#xA;' Create an workflow instance in the model to be placed on a diagram&#xA;sub CreateWorkflowInstance(dgm,eltDropped)&#xA;	EAST.LogStart(&quot;CreateWorkflowInstance&quot;)&#xA;&#xA;	' New subflows must obey the rule: only same or lower level&#xA;	dim wfUC : set wfUC = Repository.GetElementByID(dgm.ParentID)&#xA;	dim defaultType : defaultType = GetTagValByName(wfUC.TaggedValues,&quot;WorkflowType&quot;)&#xA;	dim allowedTypes : allowedTypes = defaultType&#xA;	if defaultType = &quot;BedrijfsProces&quot; then&#xA;		allowedTypes = &quot;UseCase,WerkInstructie,BedrijfsProces&quot;&#xA;	elseif defaultType = &quot;WerkInstructie&quot; then&#xA;		allowedTypes = &quot;UseCase,WerkInstructie&quot;&#xA;	end if&#xA;	&#xA;	' Additional complexity: flowtype tag, and &#xA;	' classifier for the action is not the workflow (usecase) but its parent (activity)&#xA;	dim wf : set wf = SelectWorkflow(dgm,allowedTypes,defaultType)&#xA;	if wf is nothing then &#xA;		EAST.LogInfo(&quot;User cancelled (no workflow selected)&quot;)&#xA;		EAST.LogEnd(&quot;CreateWorkflowInstance&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit sub &#xA;	end if&#xA;&#xA;	dim classifier: set classifier = GetElementByID(wf.ParentID)&#xA;	dim flowType : flowType = GetTagValByName(wf.TaggedValues,&quot;WorkflowType&quot;)&#xA;	&#xA;	dim name: name = EAST.InputBox(&quot;Uit te voeren handeling:&quot;,&quot;Nieuwe stap (subflow)&quot;,eltDropped.name)&#xA;	eltDropped.Name = name&#xA;&#xA;	eltDropped.ClassifierID = classifier.ElementID&#xA;	eltDropped.ClassifierName = classifier.Name&#xA;	SetTagValByName eltDropped.TaggedValues,&quot;WorkflowType&quot;,flowtype,&quot;&quot;&#xA;	eltDropped.Update()&#xA;&#xA;	' Set the behaviour (not supported directly by 9.3 API)&#xA;	AddProperty eltDropped.ElementGUID,&quot;kind&quot;,&quot;ActionKind&quot;,&quot;CallBehavior&quot;,&quot;&quot;&#xA;&#xA;	EAST.LogInfo(&quot;Updated dropped element with selected workflow ('&quot;+classifier.Name+&quot;')&quot;)&#xA;	EAST.LogEnd(&quot;CreateWorkflowInstance&quot;)&#xA;end sub&#xA;&#xA;' Create a workflow in the model to be placed on a diagram&#xA;function SelectWorkflow(dgm,tagValues,dfltTagValue)&#xA;	EAST.LogStart(&quot;SelectWorkflow&quot;)&#xA;	set SelectWorkflow = nothing&#xA;&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;&#xA;	' Let the user select one of the existing UC-es or create a new one.&#xA;	dim userSelection : userSelection = SelectElementTagFromTree( _&#xA;		&quot;Selecteer een workflow&quot;,&quot;TFCS_Workflow&quot;, _&#xA;		&quot;WorkflowType&quot;,tagValues,model.Name,dfltTagValue,True)&#xA;	if userSelection = &quot;&quot;  then &#xA;		EAST.LogInfo(&quot;User cancelled selection&quot;)&#xA;		EAST.LogEnd(&quot;SelectWorkflow&quot;)&#xA;		exit function &#xA;	end if&#xA;	&#xA;	dim uc, ucActivity&#xA;	if left(userSelection,3) = &quot;NEW&quot; then&#xA;		' User opted to create a new workflow =&gt; userselection is in format: NEW&lt;model&gt;.&lt;workflowtype&gt;)&#xA;		dim pos : pos=InStrRev(userSelection,&quot;.&quot;)&#xA;		dim dropFlowType : dropFlowType = Mid(userSelection,pos+1)&#xA;		dim modelName : modelName= Mid(userSelection,4,pos-4)&#xA;		Set ucActivity = CreateWorkFlowForModel(dgm,dropFlowType,getWorkflowPrefix(dropFlowType),modelName)&#xA;		if ucActivity is nothing then &#xA;			EAST.LogInfo(&quot;User cancelled creation of new workflow&quot;)&#xA;			EAST.LogEnd(&quot;SelectWorkflow&quot;)&#xA;			exit function &#xA;		end if&#xA;		EAST.LogInfo(&quot;Created new workflow ('&quot;+ucActivity.Name+&quot;')&quot;)&#xA;		Set SelectWorkflow = ucActivity.Elements.GetByName(ucActivity.Name)&#xA;	else					&#xA;		' User selected existing workflow&#xA;		EAST.LogInfo(&quot;User selected existing workflow&quot;)&#xA;		set SelectWorkflow = GetElementByGUID(userSelection)&#xA;	end if&#xA;	EAST.LogEnd(&quot;SelectWorkflow&quot;)&#xA;end function&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Let the user select/create an element to drop on the diagram&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;function SelectElementForDropOnDiagram (dgm,eltDropped,stereoType,stereotypeName,packageName)&#xA;	EAST.LogStart(&quot;SelectElementForDropOnDiagram&quot;)&#xA;	set SelectElementForDropOnDiagram = nothing&#xA;&#xA;	' In the selectiontree dialog, open the model the diagram belongs to &#xA;	' (this is most likely the model the user wishes to select/create elements in)&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;	&#xA;	' Let the use make his choice&#xA;	dim userSelection : userSelection = SelectElementFromTree( _&#xA;		&quot;Selecteer een &quot;+stereotypeName,stereotype,stereotypeName, _&#xA;		model.Name,True,eltDropped)&#xA;	if userSelection = &quot;&quot;  then &#xA;		EAST.LogInfo(&quot;User cancelled selection&quot;)&#xA;		EAST.LogEnd(&quot;SelectElementForDropOnDiagram&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit function &#xA;	end if&#xA;	&#xA;	if left(userSelection,3) = &quot;NEW&quot; then&#xA;		' User opted to create a new element&#xA;		' userselection is in format: NEW&lt;model&gt;.&lt;element type&gt;)&#xA;		dim pos : pos=InStrRev(userSelection,&quot;.&quot;)&#xA;		dim modelName : modelName= Mid(userSelection,4,pos-4)&#xA;		&#xA;		' Iso creating a new element move the dropped one&#xA;		dim thePackage as EA.Package&#xA;		set thePackage = GetPrivatePackage(modelName,packageName)&#xA;&#xA;		' Get the name for the new element&#xA;		dim Name: Name = EAST.InputBox(&quot;Omschrijving &quot;+stereotypeName+&quot; : &quot;,&quot;Toevoegen &quot;+stereotypeName,&quot;Mijn &quot;+stereotypeName)&#xA;		if Name = &quot;&quot; then &#xA;			EAST.LogInfo(&quot;User cancelled creation of new &quot;+stereotypeName)&#xA;			EAST.LogEnd(&quot;SelectElementForDropOnDiagram&quot;)&#xA;			set replaceDroppedBy = nothing&#xA;			exit function &#xA;		end if&#xA;		&#xA;		eltDropped.Name = Name&#xA;		eltDropped.PackageID = thePackage.PackageID&#xA;		eltDropped.ParentID = 0&#xA;		thePackage.Elements.Refresh()&#xA;		eltDropped.Update()&#xA;		EAST.LogInfo(&quot;Created new &quot;+stereotypeName)&#xA;		set SelectElementForDropOnDiagram = eltDropped&#xA;	else					&#xA;		' User selected existing &#xA;		EAST.LogInfo(&quot;User selected existing &quot;+stereotypeName)&#xA;		set SelectElementForDropOnDiagram = GetElementByGUID(userSelection)&#xA;		EAST.LogInfo(&quot;Need to replace dropped element with new one&quot;)&#xA;	end if&#xA;	EAST.LogEnd(&quot;SelectElementForDropOnDiagram&quot;)&#xA;end function&#xA;&#xA;function AddClassifierToDropOnDiagram (dgm,eltDropped,stereoType,stereotypeName,packageName)&#xA;	EAST.LogStart(&quot;AddClassifierToDropOnDiagram&quot;)&#xA;	set AddClassifierToDropOnDiagram = nothing&#xA;&#xA;	' In the selectiontree dialog, open the model the diagram belongs to &#xA;	' (this is most likely the model the user wishes to select/create elements in)&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;	&#xA;	' Let the use make his choice&#xA;	dim userSelection : userSelection = SelectElementFromTree( _&#xA;		&quot;Selecteer een &quot;+stereotypeName,stereotype,stereotypeName, _&#xA;		model.Name,True,nothing)&#xA;	if userSelection = &quot;&quot;  then &#xA;		EAST.LogInfo(&quot;User cancelled selection&quot;)&#xA;		EAST.LogEnd(&quot;AddClassifierToDropOnDiagram&quot;)&#xA;		set replaceDroppedBy = nothing&#xA;		exit function &#xA;	end if&#xA;	&#xA;	if left(userSelection,3) = &quot;NEW&quot; then&#xA;		' User opted to create a new element&#xA;		' userselection is in format: NEW&lt;model&gt;.&lt;element type&gt;)&#xA;		dim pos : pos=InStrRev(userSelection,&quot;.&quot;)&#xA;		dim modelName : modelName= Mid(userSelection,4,pos-4)&#xA;		&#xA;		' Iso creating a new element move the dropped one&#xA;		dim thePackage as EA.Package&#xA;		set thePackage = GetPrivatePackage(modelName,packageName)&#xA;&#xA;		' Get the name for the new element&#xA;		dim Name: Name = EAST.InputBox(&quot;Omschrijving &quot;+stereotypeName+&quot; : &quot;,&quot;Toevoegen &quot;+stereotypeName,&quot;Mijn &quot;+stereotypeName)&#xA;		if Name = &quot;&quot; then &#xA;			EAST.LogInfo(&quot;User cancelled creation of new &quot;+stereotypeName)&#xA;			EAST.LogEnd(&quot;AddClassifierToDropOnDiagram&quot;)&#xA;			exit function &#xA;		end if&#xA;		&#xA;		dim classifier as EA.Element&#xA;		set classifier = thePackage.elements.AddNew(&quot;&quot;, &quot;TFCS::&quot;+stereotype ) &#xA;		classifier.Name = Name&#xA;		thePackage.Elements.Refresh()&#xA;		if classifier.isComposite then&#xA;			dim compDgm as EA.Diagram&#xA;			set compDgm = classifier.CompositeDiagram&#xA;			compDgm.Name = Name&#xA;			compDgm.update()&#xA;		end if&#xA;		classifier.Update()&#xA;		&#xA;		EAST.LogInfo(&quot;Created new &quot;+stereotypeName)&#xA;		set AddClassifierToDropOnDiagram = classifier&#xA;	else					&#xA;		' User selected existing &#xA;		EAST.LogInfo(&quot;User selected existing &quot;+stereotypeName)&#xA;		set AddClassifierToDropOnDiagram = GetElementByGUID(userSelection)&#xA;		EAST.LogInfo(&quot;Need to replace dropped element with new one&quot;)&#xA;	end if&#xA;	EAST.LogEnd(&quot;AddClassifierToDropOnDiagram&quot;)&#xA;end function&#xA;&#xA;function UpdateDroppedElement(dgm, eltDropped)&#xA;	EAST.LogStart(&quot;UpdateDroppedElement&quot;)&#xA;	set UpdateDroppedElement = nothing&#xA;	&#xA;	dim model : set model = EAST.GetModelForPackage(dgm.PackageID)&#xA;	dim answer&#xA;	dim parent: set parent = GetElementByID(dgm.ParentID)&#xA;	select case eltDropped.StereoType &#xA;		case &quot;TFCS_ActivityInitial&quot;&#xA;			eltDropped.Name = &quot;&quot;&#xA;			EAST.LogInfo(&quot;TFCS_ActivityInitial =&gt; cleared text&quot;)&#xA;		case &quot;TFCS_ActivityFinal&quot; &#xA;			eltDropped.Name = &quot;&quot;&#xA;			EAST.LogInfo(&quot;TFCS_ActivityFinal =&gt; cleared text&quot;)&#xA;		case &quot;TFCS_Event&quot; &#xA;			answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuw event&quot;,eltDropped.name)&#xA;			if answer = empty or answer = &quot;&quot; then &#xA;				EAST.LogInfo(&quot;user cancelled&quot;)&#xA;				EAST.LogEnd(&quot;UpdateDroppedElement&quot;)&#xA;				set replaceDroppedBy = nothing&#xA;				exit function &#xA;			end if&#xA;			eltDropped.Name = answer&#xA;			EAST.LogInfo(&quot;TFCS_Event =&gt; added text&quot;)&#xA;'		case &quot;TFCS_Actor&quot; &#xA;'			answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuwe actor&quot;,eltDropped.name)&#xA;'			if answer = empty or answer = &quot;&quot; then exit function end if&#xA;'			dim thePackage : set thePackage = GetPrivatePackage(model.Name,GEN__PCK_ACTORS)&#xA;'			eltDropped.ParentID = thePackage.PackageID&#xA;'			eltDropped.PackageID = thePackage.PackageID&#xA;'			eltDropped.Name = answer&#xA;'			thepackage.elements.refresh()&#xA;		case &quot;TFCS_IntermediateResult&quot; &#xA;			answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuw tussenresultaat&quot;,eltDropped.name)&#xA;			if answer = empty or answer = &quot;&quot; then &#xA;				EAST.LogInfo(&quot;user cancelled&quot;)&#xA;				EAST.LogEnd(&quot;UpdateDroppedElement&quot;)&#xA;				set replaceDroppedBy = nothing&#xA;				exit function &#xA;			end if&#xA;			eltDropped.Name = answer&#xA;			EAST.LogInfo(&quot;TFCS_IntermediateResult =&gt; added text&quot;)&#xA;		case &quot;TFCS_AtomicAction&quot; &#xA;			answer = EAST.InputBox(&quot;Naam&quot;,&quot;Nieuwe stap&quot;,eltDropped.name)&#xA;			if answer = empty or answer = &quot;&quot; then &#xA;				EAST.LogInfo(&quot;user cancelled&quot;)&#xA;				EAST.LogEnd(&quot;UpdateDroppedElement&quot;)&#xA;				set replaceDroppedBy = nothing&#xA;				exit function &#xA;			end if&#xA;			eltDropped.Name = answer&#xA;			EAST.LogInfo(&quot;TFCS_AtomicAction =&gt; added text&quot;)&#xA;		case else&#xA;			EAST.LogInfo(eltDropped.StereoType+&quot; =&gt; unaltered&quot;)&#xA;	end select&#xA;&#xA;	eltDropped.Update()&#xA;		&#xA;	set UpdateDroppedElement = eltDropped&#xA;	EAST.LogEnd(&quot;UpdateDroppedElement&quot;)&#xA;end function&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="418"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="TFCS_Support"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="419"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{8A28179C-6AE4-4ea0-8E2D-3D67E152B24D}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_VALSQL&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="' =================================================================================================&#xA;' SQL statements used for model validation&#xA;' =================================================================================================&#xA;' Check if a relation exists&#xA;dim VAL_SQL_ELT_REFERENCES_ELT : VAL_SQL_ELT_REFERENCES_ELT = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot; from (( t_object oFrom inner join t_connector conn on oFrom.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			inner  join t_object  oTo on oTo.object_id = conn.end_object_id)&quot; + _&#xA; &quot; where oFrom.object_id = {0} &quot; + _&#xA; &quot; 		and (conn.connector_type = {1} or {1}='')&quot; + _&#xA; &quot; 		and (conn.subtype = {2} or {2}='')&quot; + _&#xA; &quot;		and oTo.object_id = {3}&quot;&#xA; &#xA;' Get all references to objects of a specific type, by a specific relationtype&#xA;dim VAL_SQL_ELT_REFERENCES : VAL_SQL_ELT_REFERENCES = _&#xA; &quot; select oTo.object_id as ID&quot; + _&#xA; &quot; from (( t_object oFrom inner join t_connector conn on oFrom.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			inner  join t_object  oTo on oTo.object_id = conn.end_object_id)&quot; + _&#xA; &quot; where oFrom.object_id = {0} &quot; + _&#xA; &quot; 		and (&quot;+xUCASEx+&quot;({1}) like '&quot;+xWCx+&quot;'+&quot;+xUCASEx+&quot;(conn.connector_type)+'&quot;+xWCx+&quot;' or {1} = '')&quot; + _&#xA; &quot;		and (&quot;+xUCASEx+&quot;({2}) like '&quot;+xWCx+&quot;'+&quot;+xUCASEx+&quot;(oTo.Stereotype)+'&quot;+xWCx+&quot;' or {2} = '')&quot;&#xA; &#xA;' Get all objects of a specific type referencing this object, by a specific relationtype&#xA;dim VAL_SQL_ELT_REFERENCED_BY : VAL_SQL_ELT_REFERENCED_BY = _&#xA; &quot; select oFrom.object_id as ID&quot; + _&#xA; &quot; from (( t_object oFrom inner join t_connector conn on oFrom.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			inner  join t_object  oTo on oTo.object_id = conn.end_object_id)&quot; + _&#xA; &quot; where oTo.object_id = {0} &quot; + _&#xA; &quot; 		and (&quot;+xUCASEx+&quot;({1}) like '&quot;+xWCx+&quot;'+&quot;+xUCASEx+&quot;(conn.connector_type)+'&quot;+xWCx+&quot;' or {1} = '')&quot; + _&#xA; &quot;		and (&quot;+xUCASEx+&quot;({2}) like '&quot;+xWCx+&quot;'+&quot;+xUCASEx+&quot;(oFrom.Stereotype)+'&quot;+xWCx+&quot;' or {2} = '')&quot;&#xA;&#xA;' Counts all relations to/from an element&#xA; dim VAL_SQL_RELATIONS_FOR_ELT: VAL_SQL_RELATIONS_FOR_ELT = _&#xA; &quot; select conn.connector_id, conn.connector_type&quot; + _&#xA; &quot; from t_object o, t_connector conn where  o.object_id = {0} and (o.object_id = conn.start_object_id&quot; + _&#xA; &quot; 			or o.object_id = conn.end_object_id)&quot;  + _&#xA; &quot;          and (&quot;+xUCASEx+&quot;({1}) like '&quot;+xWCx+&quot;'+&quot;+xUCASEx+&quot;(conn.connector_type)+'&quot;+xWCx+&quot;' or {1} = '')&quot;&#xA;&#xA;' Returns diagrams of a specified stereotype contianing the element&#xA;dim VAL_SQL_DGMS_OF_TYPE_WITH_ELT : VAL_SQL_DGMS_OF_TYPE_WITH_ELT = _&#xA; &quot; select d.diagram_id&quot; + _&#xA; &quot; from t_diagramobjects do&quot; + _&#xA; &quot; 	,t_diagram d&quot; + _&#xA; &quot; where do.diagram_id = d.diagram_id&quot; + _&#xA; &quot; 	and do.object_id = {0}&quot; + _&#xA; &quot;  and &quot;+xMEMOx+&quot;instr(d.StyleEx,'MDGDgm=TFCS::{1}')&gt;0&quot;&#xA; &#xA; ' Returns TFCS diagrams containing the element&#xA;dim VAL_SQL_DGMS_WITH_ELT : VAL_SQL_DGMS_WITH_ELT = _&#xA; &quot; select d.diagram_id&quot; + _&#xA; &quot; from t_diagramobjects do&quot; + _&#xA; &quot; 	,t_diagram d&quot; + _&#xA; &quot; where do.diagram_id = d.diagram_id&quot; + _&#xA; &quot; 	and do.object_id = {0}&quot; + _&#xA; &quot;  and &quot;+xMEMOx+&quot;instr(d.StyleEx,'MDGDgm=TFCS::')&gt;0&quot;&#xA; &#xA;&#xA; ' Check if an element is included in any other diagram than the one below its parent&#xA;' (note: check if parent has only one diagram is done elsewhere)&#xA;dim VAL_SQL_GET_OTHER_DIAGRAMS_FOR_ELT : VAL_SQL_GET_OTHER_DIAGRAMS_FOR_ELT = _&#xA; &quot; select d.diagram_id&quot; + _&#xA; &quot; from t_object o, t_diagramobjects do&quot; + _&#xA; &quot; 	,t_diagram d&quot; + _&#xA; &quot; where o.object_id = do.object_id and do.diagram_id = d.diagram_id&quot; + _&#xA; &quot;  and d.parentid &lt;&gt; o.parentid &quot; + _&#xA; &quot; 	and o.object_id = {0}&quot; &#xA; &#xA; ' Element contained on a diagram for a GUI or component element&#xA; dim VAL_SQL_CONTAINED_IN_COMP : VAL_SQL_CONTAINED_IN_COMP = _&#xA; &quot;  select count(*) as RESULT&quot; + _&#xA; &quot;  from t_diagram d&quot; + _&#xA; &quot; 		,t_diagramobjects do&quot; + _&#xA; &quot;  	,t_object o&quot; + _&#xA; &quot; 		,t_object p&quot; + _&#xA; &quot;  where o.object_id = {0}&quot; + _&#xA; &quot; 		and do.object_id = o.object_id&quot; + _&#xA; &quot; 		and do.diagram_id = d.diagram_id&quot; + _&#xA; &quot; 		and d.parentid = p.object_id&quot; + _&#xA; &quot; 		and p.stereotype in ('TFCS_GUI','TFCS_CompositeActivity')&quot;&#xA; &#xA; ' Get stereotype of the parent of a diagram ('Package' if not an element)&#xA; dim VAL_SQL_PARENT_STEREOTYPE : VAL_SQL_PARENT_STEREOTYPE = _&#xA; &quot;  select  count(*) as RESULT&quot; + _&#xA; &quot; from t_diagram d, t_object o&quot; + _&#xA; &quot; where d.parentID = o.object_id&quot; + _&#xA; &quot; and d.diagram_id = {0} and o.stereotype not in ({1})&quot;&#xA;  &#xA;' Get diagrams owned by an element&#xA;const VAL_SQL_DGMSTEREO_FOR_ELT = &quot;select d.DIAGRAM_ID from t_diagram d where d.parentid = {0}&quot; &#xA;&#xA;' Get the elements that have an element as classifier&#xA;const VAL_SQL_GET_AS_CLASSIFIER = &quot;select o.object_ID from t_object o where o.classifier = {0}&quot;&#xA;&#xA;' Get the workflow definition diagram for a element (must be a workflow)&#xA;dim VAL_SQL_GET_WF_PARENT_DGM : VAL_SQL_GET_WF_PARENT_DGM = _&#xA;	 &quot; select d.diagram_id&quot; + _&#xA;	 &quot; from t_diagram d, t_diagramobjects do, t_object o&quot; + _&#xA;	 &quot; where d.parentID = o.parentid&quot; + _&#xA;	 &quot; and o.object_id = {0} and do.object_id = o.object_id and do.diagram_id = d.diagram_id&quot;&#xA;				 &#xA; ' Select all UC activity elements for workflows on a workflow definition diagram&#xA; ' other than the owning workflow&#xA; dim VAL_SQL_WFS_ON_UCDEF : VAL_SQL_WFS_ON_UCDEF = _&#xA; &quot;  select o.object_id,o.parentid as activity_id, fdd.diagram_id as WFREAL_DIAGRAM_ID &quot; + _&#xA; &quot;     from t_diagram d &quot; + _&#xA; &quot; 		,t_object uc&quot; + _&#xA; &quot;		,t_diagram fdd&quot; + _&#xA; &quot; 		,t_diagramobjects do &quot; + _&#xA; &quot;   	,t_object o &quot; + _&#xA; &quot;     where  d.diagram_id = {0}&quot; + _&#xA; &quot;			and uc.parentid = d.parentid and uc.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;			and uc.object_id = fdd.parentid&quot; + _&#xA; &quot;    		and do.diagram_id = d.diagram_id  &quot; + _&#xA; &quot;   		and do.object_id = o.object_id &quot; + _&#xA; &quot; 		and o.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot; 		and o.object_id &lt;&gt; uc.object_id&quot;&#xA;		&#xA; ' All instances of a WF must have the same value for 'WorkflowType' as the WF itself&#xA; dim VAL_SQL_CHECK_INST_HASSAMETAG : VAL_SQL_CHECK_INST_HASSAMETAG = _&#xA; &quot; select tv.value&quot; + _&#xA; &quot;   from t_object o, t_objectproperties tv &quot; + _&#xA; &quot;   where  o.classifier = {0}&quot;  + _&#xA; &quot;   	and o.object_id = tv.object_id &quot;  + _&#xA; &quot; 		and &quot;+xUCASEx+&quot;(tv.property) = &quot;+xUCASEx+&quot;('{1}') &quot; + _&#xA; &quot; 		and tv.value in ({2})  &quot;&#xA;&#xA;dim VAL_SQL_GET_WF_OFTYPE : VAL_SQL_GET_WF_OFTYPE = _&#xA; &quot; select d.diagram_id, tv.value as WORKFLOWTYPE&quot; + _&#xA; &quot;   from t_diagramobjects do, t_diagram d, t_objectproperties tv &quot; + _&#xA; &quot;   where  do.object_id = {0} and do.diagram_id = d.diagram_id &quot;  + _&#xA; &quot;   	and d.parentid = tv.object_id &quot;  + _&#xA; &quot; 		and tv.property = 'WorkflowType'&quot; + _&#xA; &quot; 		and tv.value in ({1})&quot;&#xA;&#xA;'Check if an element has valid tagvalue&#xA;dim VAL_SQL_HAS_TAGVALUE : VAL_SQL_HAS_TAGVALUE = _&#xA; &quot; select tv.value&quot; + _&#xA; &quot;   from t_objectproperties tv &quot; + _&#xA; &quot;   where tv.object_id = {0} &quot;  + _&#xA; &quot; 		and &quot;+xUCASEx+&quot;(tv.property) = &quot;+xUCASEx+&quot;('{1}') &quot; + _&#xA; &quot; 		and tv.value in ({2})  &quot;&#xA;&#xA;' Get the compnent flows that include this element as subflow&#xA;dim VAL_SQL_GET_COMP : VAL_SQL_GET_COMP = _&#xA;&quot; select d.diagram_id&quot; + _&#xA; &quot; from (t_diagramobjects do inner join t_diagram d on do.diagram_id = d.diagram_id)  &quot; + _&#xA; &quot; where  do.object_id = {0} &quot; + _&#xA; &quot; 	and not exists &quot; + _&#xA; &quot;     (select tv.property from t_objectproperties tv  &quot; + _&#xA; &quot;      where  d.parentid = tv.object_id and tv.property = 'WorkflowType' )&quot; &#xA;&#xA;&#xA;dim VAL_SQL_WF_EXTENDS_OTHERLEVEL : VAL_SQL_WF_EXTENDS_OTHERLEVEL = _&#xA; &quot; select count(*) as RESULT&quot; + _&#xA; &quot; from ((( t_object oFrom inner join t_connector conn on oFrom.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			inner  join t_object oTo on oTo.object_id = conn.end_object_id)&quot; + _&#xA; &quot; 			inner  join t_objectproperties tv on oTo.object_id = tv.object_id)&quot; + _&#xA; &quot; where oFrom.object_id = {0}&quot; + _&#xA; &quot; 		and conn.connector_type = 'UseCase'&quot; + _&#xA; &quot;		and conn.SubType = 'Extends'&quot; + _&#xA; &quot;		and tv.property = 'WorkflowType'&quot; + _&#xA; &quot;		and tv.value &lt;&gt; '{1}'&quot;&#xA;&#xA;' Get all elements of a specific stereotype used&#xA;' in a flowrealisation but have not been included in the flowdefinition&#xA;dim VAL_SQL_GET_MISSING_ELTS_ON_WFDEFN : VAL_SQL_GET_MISSING_ELTS_ON_WFDEFN = _&#xA; &quot;	select distinct fo.object_id&quot; + _&#xA; &quot;	from t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;	where fdo.diagram_id = {0}&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.stereotype in ({2})&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where ddo.diagram_id = {1}&quot; + _&#xA; &quot;					and fo.object_id = ddo.object_id) &quot;&#xA; &#xA;' Get all elements of a specific stereotype used -as classifiers- &#xA;' in a flowrealisation but have not been included in the flowdefinition&#xA;dim VAL_SQL_GET_MISSING_CLASSIFIERS_ON_WFDEFN : VAL_SQL_GET_MISSING_CLASSIFIERS_ON_WFDEFN = _&#xA; &quot;	select distinct c.object_id &quot; + _&#xA; &quot;	from t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where fdo.diagram_id = {0}&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = c.object_id&quot; + _&#xA; &quot;		and c.stereotype in ({2})&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where ddo.diagram_id = {1}&quot; + _&#xA; &quot;					and c.object_id = ddo.object_id) &quot;&#xA;&#xA;' Get all elements of a specific stereotype used -as classifier- &#xA;' in a flowrealisation but have not been included -as classifier- in the flowdefinition&#xA;dim VAL_SQL_GET_MISSING_INST_ON_WFDEFN: VAL_SQL_GET_MISSING_INST_ON_WFDEFN = _&#xA; &quot;	select distinct c.object_id &quot; + _&#xA; &quot;	from t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where fdo.diagram_id = {0}&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = c.object_id&quot; + _&#xA; &quot;		and c.stereotype in ({2})&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo, t_object o &quot; + _&#xA; &quot;				where ddo.diagram_id = {1} and ddo.object_id = o.object_id&quot; + _&#xA; &quot;					and c.object_id = o.classifier) &quot;&#xA;&#xA;' Get all subflows on a workflow realisation that are missing on the workflow definition&#xA;dim VAL_SQL_GET_MISSING_WORKFLOWS_ON_WFDEFN : VAL_SQL_GET_MISSING_WORKFLOWS_ON_WFDEFN = _&#xA; &quot;	select distinct c.object_id &quot; + _&#xA; &quot;	from t_diagramobjects fdo&quot; + _&#xA; &quot;		,t_object fo&quot; + _&#xA; &quot;		,t_object ac&quot; + _&#xA; &quot;		,t_object c&quot; + _&#xA; &quot;	where fdo.diagram_id = {0}&quot; + _&#xA; &quot;		and fdo.object_id = fo.object_id&quot; + _&#xA; &quot;		and fo.classifier = ac.object_id&quot; + _&#xA; &quot;		and ac.stereotype = 'TFCS_Activity'&quot; + _&#xA; &quot;		and c.parentid = ac.object_id&quot; + _&#xA; &quot;		and c.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where ddo.diagram_id = {1} &quot; + _&#xA; &quot;					and c.object_id = ddo.object_id) &quot;&#xA;&#xA;' Get elements related TO workflow missing on its WF definition diagram&#xA;dim VAL_SQL_GET_MISSING_RELATIONS_TO_WF : VAL_SQL_GET_MISSING_RELATIONS_TO_WF = _&#xA; &quot;	select r.object_id &quot; + _&#xA; &quot;	from t_diagram dd&quot; + _&#xA; &quot;		,t_object uc&quot; + _&#xA; &quot;		,t_connector conn&quot; + _&#xA; &quot;		,t_object r&quot; + _&#xA; &quot;	where dd.diagram_ID = {0} &quot; + _&#xA; &quot;		and uc.parentid = dd.parentid&quot; + _&#xA; &quot;		and uc.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;		and r.stereotype &lt;&gt; 'TFCS_Workflow'&quot; + _&#xA; &quot;		and ((uc.object_id = conn.end_object_id and r.object_id = conn.start_object_id))&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where  ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and r.object_id = ddo.object_id)&quot;&#xA; &#xA; ' Get elements related FROM workflow missing on its workflow definition diagram&#xA;dim VAL_SQL_GET_MISSING_RELATIONS_FROM_WF : VAL_SQL_GET_MISSING_RELATIONS_FROM_WF = _&#xA; &quot;	select r.object_id &quot; + _&#xA; &quot;	from t_diagram dd&quot; + _&#xA; &quot;		,t_object uc&quot; + _&#xA; &quot;		,t_connector conn&quot; + _&#xA; &quot;		,t_object r&quot; + _&#xA; &quot;	where dd.diagram_ID = {0} &quot; + _&#xA; &quot;		and uc.parentid = dd.parentid&quot; + _&#xA; &quot;		and uc.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;		and ((uc.object_id = conn.start_object_id and r.object_id = conn.end_object_id))&quot; + _&#xA; &quot;		and dd.diagram_ID = {0}&quot; + _&#xA; &quot;		and not exists&quot; + _&#xA; &quot;			(select ddo.object_id &quot; + _&#xA; &quot;				from t_diagramobjects ddo &quot; + _&#xA; &quot;				where  ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot;					and r.object_id = ddo.object_id)&quot;&#xA; &#xA; ' Get workflow elements on a workflow definition diagram not extended or included by the workflow&#xA; dim VAL_SQL_GET_MISSING_INCLUDES_EXTENDS : VAL_SQL_GET_MISSING_INCLUDES_EXTENDS = _&#xA;&quot; select r.object_id, uc.name as PARENTWORKFLOW&quot; + _&#xA; &quot;	from t_diagram dd&quot; + _&#xA; &quot;		,t_object uc&quot; + _&#xA; &quot;		,t_diagramobjects ddo&quot; + _&#xA; &quot;		,t_object r&quot; + _&#xA; &quot;	where dd.diagram_ID = {0} &quot; + _&#xA; &quot;		and uc.parentid = dd.parentid&quot; + _&#xA; &quot;		and uc.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;		and ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot; 		and ddo.object_id = r.object_id&quot; + _&#xA; &quot;		and r.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;		and not exists (&quot; + _&#xA; &quot;			select Connector_ID from t_connector conn &quot; + _&#xA; &quot;			where (uc.object_id = conn.start_object_id and r.object_id = conn.end_object_id)&quot; + _&#xA; &quot;				and conn.stereotype in ('extend','include'))&quot; + _&#xA; &quot;		and uc.object_id &lt;&gt; r.object_id&quot;&#xA;&#xA;' Selcts all action instances of a composite activity or screen on diagram&#xA;dim VAL_SQL_COMP_ON_COMPDGM : VAL_SQL_COMP_ON_COMPDGM = _&#xA; &quot;  select o.object_id&quot; + _&#xA; &quot;		from t_diagramobjects ddo&quot; + _&#xA; &quot;			,t_object o&quot; + _&#xA; &quot;		where ddo.diagram_id = {0}&quot; + _&#xA; &quot;			and o.object_id = ddo.object_id&quot; + _&#xA; &quot;			and o.stereotype = 'TFCS_CompositeAction'&quot;&#xA; &#xA; ' Get all elements of a specific stereotype on a diagram that &#xA; ' have no relation with the parent element of that diagram&#xA;  dim VAL_SQL_GET_ELT_UNRELATED_TO_PARENT: VAL_SQL_GET_ELT_UNRELATED_TO_PARENT = _&#xA; &quot;select fdd.diagram_id as WFREAL_DIAGRAM_ID&quot; + _&#xA; &quot;	, o.object_id&quot; + _&#xA; &quot; 	from t_diagram dd&quot; + _&#xA; &quot;		, t_object uc&quot; + _&#xA; &quot;		, t_diagram fdd&quot; + _&#xA; &quot; 		, t_diagramobjects ddo&quot; + _&#xA; &quot;		, t_object o&quot; + _&#xA; &quot;	where dd.diagram_id = {0} and uc.parentid = dd.parentid&quot; + _&#xA; &quot; 		and uc.stereotype = 'TFCS_Workflow'&quot; + _&#xA; &quot;		and uc.object_id = fdd.parentid&quot; + _&#xA; &quot;		and ddo.diagram_id = dd.diagram_id&quot; + _&#xA; &quot; 		and ddo.object_id = o.object_id&quot; + _&#xA; &quot;		and o.object_id &lt;&gt; uc.object_id&quot; + _&#xA; &quot;		and o.Stereotype in ({1})&quot; + _&#xA; &quot;		and not exists (select Connector_ID from t_connector conn &quot; + _&#xA; &quot;			where uc.object_id = conn.end_object_id and o.object_id = conn.start_object_id)&quot; + _&#xA; &quot;		and not exists (	select Connector_ID from t_connector conn &quot; + _&#xA; &quot;			where uc.object_id = conn.start_object_id and o.object_id = conn.end_object_id)&quot;&#xA; &#xA; ' Elements related FROM element missing on diagram&#xA; dim VAL_SQL_GET_MISSING_ELEMENTS_FROM_WFREAL: VAL_SQL_GET_MISSING_ELEMENTS_FROM_WFREAL = _&#xA; &quot;  select r.object_ID &quot; + _&#xA; &quot;     from t_diagramobjects do &quot; + _&#xA; &quot;   	,t_connector conn &quot; + _&#xA; &quot;   	,t_object r &quot; + _&#xA; &quot;     where  do.diagram_id = {0}&quot; + _&#xA; &quot;   		and (do.object_id = conn.end_object_id and r.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			and r.stereotype in ({1})&quot;  + _&#xA; &quot;			and not exists (select rdo.object_id from t_diagramobjects rdo &quot;+ _&#xA; &quot;				where rdo.diagram_id = do.diagram_id and rdo.object_id = r.object_id)&quot;&#xA;&#xA; &#xA; ' Elements related TO element missing on diagram&#xA; dim VAL_SQL_GET_MISSING_ELEMENTS_TO_WFREAL: VAL_SQL_GET_MISSING_ELEMENTS_TO_WFREAL = _&#xA; &quot;  select r.object_ID &quot; + _&#xA; &quot;     from t_diagramobjects do &quot; + _&#xA; &quot;   	,t_connector conn &quot; + _&#xA; &quot;   	,t_object r &quot; + _&#xA; &quot;     where  do.diagram_id = {0}&quot; + _&#xA; &quot;   		and (do.object_id = conn.end_object_id and r.object_id = conn.start_object_id)&quot; + _&#xA; &quot; 			and r.stereotype in ({1})&quot;  + _&#xA; &quot;			and not exists (select rdo.object_id from t_diagramobjects rdo &quot;+ _&#xA; &quot;				where rdo.diagram_id = do.diagram_id and rdo.object_id = r.object_id)&quot;&#xA; dim VAL_SQL_ELT_ON_DGM : VAL_SQL_ELT_ON_DGM = _&#xA; &quot; select count(*) as RESULT  from t_diagramobjects where diagram_id = {0} and object_id = {1}&quot;&#xA; &#xA;  dim VAL_SQL_ELT_AS_CLASSIFIER_ON_DGM : VAL_SQL_ELT_AS_CLASSIFIER_ON_DGM = _&#xA; &quot; select count(*) as RESULT  from t_diagramobjects do, t_object o where do.diagram_id = {0} and do.object_id = o.object_id and o.classifier = {1}&quot;&#xA; &#xA; "/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="420"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{24C0D6E9-51BC-47ed-9228-0BAE2E8AB014}"/>
			<Column name="ScriptAuthor" value="{95899319-791B-46bc-A6E6-A4122451DB62}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;EAST management&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' EAST initialisation routines for loading and initializing TFCS&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_Constants&#xA;&#xA;' Register the scripts that contain handler methods for EA events&#xA;sub EAST_RegisterEventHandlers&#xA;&#xA;	' NOTE: eventhandlers are executed in the order of registration&#xA;	EAST.AddEventhandler(&quot;TFCS_MainMenu&quot;)					' Creates a menu item TFCS to the EA context menu's.&#xA;	EAST.AddEventhandler(&quot;TFCS_Reports&quot;)					' Reports on relationships (main menu item 'Rapportages')&#xA;	EAST.AddEventhandler(&quot;TFCS_ExecuteScript&quot;)				' Executes a script when double-clicking on an element&#xA;	EAST.AddEventhandler(&quot;TFCS_CreateFromToolbox&quot;)			' Creation of new model elements using the diagram toolboxes&#xA;	EAST.AddEventhandler(&quot;TFCS_GUIConstraints&quot;)				' Deviations from/constaints on the standard GUI of EA&#xA;	EAST.AddEventhandler(&quot;TFCS_DeleteHandler&quot;)				' Fires when deleting an object on a diagram&#xA;	EAST.AddEventhandler(&quot;TFCS_ModelValidation&quot;)			' Checks if the model is internally conistent with the TFCS metamodel&#xA;	EAST.AddEventhandler(&quot;TFCS_GenerateDocWFSpec&quot;)			' Generate a complete specification for a workflow suitable for approval&#xA;	EAST.AddEventhandler(&quot;TFCS_GenerateDocContext&quot;)			' Generate a document containing all diagrams that include an element (context)&#xA;end sub&#xA;&#xA;' Provide EAST with the location of screen definitions and temp dir (dev dir)&#xA;sub EAST_Init()&#xA;	EAST.SetDevDir(TFCSBASEDIR+&quot;/dev&quot;)&#xA;	EAST.SetDialogDir(TFCSBASEDIR+&quot;/dialogs/&quot;)&#xA;end sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="421"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{C5359E5F-41C6-4ea4-9FC6-A784F927D238}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_SQL&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Module containing all SQL statements used.&#xA;' SQL is grouped on referencing module and prefixed with part of the name of that module to prevent name clashes&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' Returns all diagrams behind composite steps on a specific diagram&#xA;Dim GEN_SQL_DGM_COMPLEXSTEPS: GEN_SQL_DGM_COMPLEXSTEPS = _&#xA;&quot; select d.diagram_id, d.ea_guid,o.name &quot; &amp;_&#xA;&quot; from t_diagram p, t_diagramobjects do&quot; &amp;_&#xA;&quot;	 ,t_object o&quot; &amp;_&#xA;&quot;	 ,t_object c&quot; &amp;_&#xA;&quot;	 ,t_diagram d&quot; &amp;_&#xA;&quot; where p.diagram_id = {0} and p.diagram_id = do.diagram_id&quot; &amp;_&#xA;&quot;	 and do.object_id = o.object_id&quot; &amp;_&#xA;&quot;	 and o.classifier = c.object_id&quot; &amp;_&#xA;&quot;	 and o.stereotype = 'TFCS_CompositeAction'&quot; &amp;_&#xA;&quot;	 and d.parentid = c.object_id&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_ModelValidation&#xA;' =============================================================================&#xA;' Since there are quite a few: left in (the head of) the script file&#xA;&#xA;' =============================================================================&#xA;' TFCS_DragDropHandler&#xA;' =============================================================================&#xA;dim SQL_GET_DIAGRAMOBJECT_RECT : SQL_GET_DIAGRAMOBJECT_RECT = _&#xA;	&quot;select rectleft,recttop,rectright,rectbottom from t_diagramobjects where diagram_id = {0} and object_id = {1}&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_DocumentGeneration&#xA;' =============================================================================&#xA;&#xA;' Returns all diagrams that contain a specific object (element)&#xA;Dim DOCGEN_SQL_DIAGRAMSWITHELT: DOCGEN_SQL_DIAGRAMSWITHELT = _&#xA;&quot; select d.ea_guid as EA_GUID&quot; &amp;_&#xA;&quot;    ,d.diagram_id as ID&quot; &amp;_&#xA;&quot; from t_diagram d&quot; &amp;_&#xA;&quot;	 ,t_diagramobjects do&quot; &amp;_&#xA;&quot;	 ,t_object o&quot; &amp;_&#xA;&quot; where d.diagram_id = do.diagram_id&quot; &amp;_&#xA;&quot;	 and do.object_id = o.object_id&quot; &amp;_&#xA;&quot;	 and o.ea_guid = '{0}' order by d.name&quot;&#xA;&#xA;' Returns all diagrams that contain a specific object (element) -as classifier-&#xA;dim DOCGEN_SQL_DIAGRAMSWITHELTASCLASSIFIER: DOCGEN_SQL_DIAGRAMSWITHELTASCLASSIFIER = _&#xA;&quot; select d.ea_guid as EA_GUID&quot; &amp;_&#xA;&quot;    ,d.diagram_id as ID&quot; &amp;_&#xA;&quot; from t_diagram d&quot; &amp;_&#xA;&quot;	 ,t_diagramobjects do&quot; &amp;_&#xA;&quot;	 ,t_object o, t_object c&quot; &amp;_&#xA;&quot; where d.diagram_id = do.diagram_id&quot; &amp;_&#xA;&quot;	 and do.object_id = o.object_id and o.classifier = c.object_id&quot; &amp;_&#xA;&quot;	 and c.ea_guid = '{0}' order by  d.name&quot;&#xA;&#xA;' Returns all elements (either notes or plain text) that are contained in boundary with name 'Toelichting'&#xA;Dim DOCGEN_SQL_DGM_REMARKSFORDGM: DOCGEN_SQL_DGM_REMARKSFORDGM = _&#xA;&quot; select tlo.object_id &quot; &amp;_&#xA;&quot; from t_diagram d&quot; &amp;_&#xA;&quot;		,t_diagramobjects do&quot; &amp;_&#xA;&quot;		,t_object o&quot; &amp;_&#xA;&quot;		,t_diagramobjects tl&quot; &amp;_&#xA;&quot;		,t_object tlo&quot; &amp;_&#xA;&quot; where  tlo.object_id = tl.Object_ID&quot; &amp;_&#xA;&quot;		and tl.diagram_id = d.diagram_id&quot; &amp;_&#xA;&quot;		and o.object_id = do.object_id&quot; &amp;_&#xA;&quot;		and do.diagram_id = d.diagram_id&quot; &amp;_&#xA;&quot;		and &quot;+xUCASEx+&quot;(o.Name) = 'TOELICHTING' and o.object_type = 'Boundary'&quot; &amp;_&#xA;&quot;		and tlo.object_type in ('Note','Text')&quot; &amp;_&#xA;&quot;		and tl.RectTop &lt;= do.RectTop &quot; &amp;_&#xA;&quot;		and tl.RectLeft &gt;= do.RectLeft&quot; &amp;_&#xA;&quot;		and tl.RectRight &lt;= do.RectRight&quot; &amp;_&#xA;&quot;		and tl.RectBottom &gt;= do.RectBottom&quot; &amp;_&#xA;&quot;		and d.ea_guid = '{0}'&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_Commons&#xA;' =============================================================================&#xA;dim SQL_GET_OBJECTPROPERTIES: SQL_GET_OBJECTPROPERTIES= _&#xA;	&quot;select XRefID,description as RESULT from t_xref where description like '@PROP&quot;+xWCx+&quot;' and client='{0}'&quot;&#xA;&#xA;const SQL_UPD_OBJECTPROPERTIES = &quot;update t_xref set description = '{1}' where XRefID = '{0}'&quot;&#xA;dim SQL_INS_OBJECTPROPERTIES: SQL_INS_OBJECTPROPERTIES = &quot;insert into t_xref &quot;&amp;_&#xA;		&quot; (XRefID,name,type,visibility,Namespace,Requirement,Constraint,Behavior,partition,description,client,supplier,link)&quot; &amp;_&#xA;		&quot; values ('{0}','CustomProperties', 'element property', 'Public','','','','', 0, &quot; &amp;_&#xA;		&quot; '@PROP=@NAME={2}@ENDNAME;@TYPE={3}@ENDTYPE;@VALU={4}@ENDVALU;@PRMT={5}@ENDPRMT;@ENDPROP;', &quot;&amp;_&#xA;		&quot; '{1}','&lt;none&gt;','')&quot;&#xA;		&#xA;dim COMM_SQL_DGMSBYSTEREO : COMM_SQL_DGMSBYSTEREO = _&#xA;  &quot; select &quot;+xIfNullx(&quot;pck4.name&quot;,xIfNullx(&quot;pck3.name&quot;,xIfNullx(&quot;pck2.name&quot;, _&#xA;	xIfNullx(&quot;pck1.name&quot;,&quot;pck0.name&quot;)))) +&quot; &quot;+&quot;as&quot;+&quot; model &quot; _&#xA;+ &quot; , d.name &quot; _&#xA;+ &quot; , d.ea_guid &quot; _&#xA;+ &quot; from ((((((t_diagram d  ) &quot; _&#xA;+ &quot; inner join t_package pck0 on d.package_id = pck0.package_id) &quot; _&#xA;+ &quot; left join t_package pck1 on pck1.package_id = pck0.parent_id) &quot; _&#xA;+ &quot; left join t_package pck2 on pck2.package_id = pck1.parent_id) &quot; _&#xA;+ &quot; left join t_package pck3 on pck3.package_id = pck2.parent_id) &quot; _&#xA;+ &quot; left join t_package pck4 on pck4.package_id = pck3.parent_id) &quot; _&#xA;+ &quot; where d.StyleEx like '&quot;+xWCx+&quot;MDGDgm=TFCS::{0}&quot;+xWCx+&quot;' &quot; _&#xA;+ &quot; order by &quot;+xIfNullx(&quot;pck4.name&quot;,xIfNullx(&quot;pck3.name&quot;,xIfNullx(&quot;pck2.name&quot;, _&#xA;	xIfNullx(&quot;pck1.name&quot;,&quot;pck0.name&quot;))))+&quot;, d.name&quot;&#xA;	&#xA;dim COMM_SQL_ELTSBYSTEREO_AND_TAG : COMM_SQL_ELTSBYSTEREO_AND_TAG = _&#xA; &quot; select &quot;+xIfNullx(&quot;pck4.name&quot;,xIfNullx(&quot;pck3.name&quot;,xIfNullx(&quot;pck2.name&quot;, _&#xA;	xIfNullx(&quot;pck1.name&quot;,&quot;pck0.name&quot;)))) +&quot; &quot;+&quot;as&quot;+&quot; model &quot; _&#xA;+ &quot; , tv.value &quot; _&#xA;+ &quot; , o.name &quot; _&#xA;+ &quot; , o.ea_guid &quot; _&#xA;+ &quot; from ((((((t_object o inner join t_objectproperties tv on tv.object_id = o.object_id  ) &quot; _&#xA;+ &quot; inner join t_package pck0 on o.package_id = pck0.package_id) &quot; _&#xA;+ &quot; left join t_package pck1 on pck1.package_id = pck0.parent_id) &quot; _&#xA;+ &quot; left join t_package pck2 on pck2.package_id = pck1.parent_id) &quot; _&#xA;+ &quot; left join t_package pck3 on pck3.package_id = pck2.parent_id) &quot; _&#xA;+ &quot; left join t_package pck4 on pck4.package_id = pck3.parent_id) &quot; _&#xA;+ &quot; where &quot;+xUCASEx+&quot;(o.Stereotype) = &quot;+xUCASEx+&quot;('{0}') &quot; _&#xA;+ &quot; 	and &quot;+xUCASEx+&quot;(tv.property) = &quot;+xUCASEx+&quot;('{1}') and &quot; _&#xA;+xUCASEx+&quot;('{2}') like '&quot;+xWCx+&quot;'+&quot;+xUCASEx+&quot;(tv.value)+'&quot;+xWCx+&quot;' and tv.value is not null&quot; _&#xA;+ &quot; order by &quot;+xIfNullx(&quot;pck4.name&quot;,xIfNullx(&quot;pck3.name&quot;,xIfNullx(&quot;pck2.name&quot;, _&#xA;	xIfNullx(&quot;pck1.name&quot;,&quot;pck0.name&quot;))))+&quot;, tv.value, o.name&quot;&#xA;	&#xA;dim COMM_SQL_ELTSBYSTEREO : COMM_SQL_ELTSBYSTEREO = _&#xA; &quot; select &quot;+xIfNullx(&quot;pck4.name&quot;,xIfNullx(&quot;pck3.name&quot;,xIfNullx(&quot;pck2.name&quot;, _&#xA;	xIfNullx(&quot;pck1.name&quot;,&quot;pck0.name&quot;)))) +&quot; &quot;+&quot;as&quot;+&quot; model &quot; _&#xA;+ &quot; , o.name &quot; _&#xA;+ &quot; , o.ea_guid &quot; _&#xA;+ &quot; from ((((((t_object o  ) &quot; _&#xA;+ &quot; inner join t_package pck0 on o.package_id = pck0.package_id) &quot; _&#xA;+ &quot; left join t_package pck1 on pck1.package_id = pck0.parent_id) &quot; _&#xA;+ &quot; left join t_package pck2 on pck2.package_id = pck1.parent_id) &quot; _&#xA;+ &quot; left join t_package pck3 on pck3.package_id = pck2.parent_id) &quot; _&#xA;+ &quot; left join t_package pck4 on pck4.package_id = pck3.parent_id) &quot; _&#xA;+ &quot; where &quot;+xUCASEx+&quot;('{0}') like '&quot;+xWCx+&quot;'+&quot;+xUCASEx+&quot;(o.Stereotype)+'&quot;+xWCx+&quot;' and o.Stereotype is not null and o.object_id &lt;&gt; {1}&quot; _&#xA;+ &quot; order by &quot;+xIfNullx(&quot;pck4.name&quot;,xIfNullx(&quot;pck3.name&quot;,xIfNullx(&quot;pck2.name&quot;, _&#xA;	xIfNullx(&quot;pck1.name&quot;,&quot;pck0.name&quot;))))+&quot;, o.name&quot;&#xA;dim COMM_SQL_GETMODELS : COMM_SQL_GETMODELS = &quot;select name from t_package where parent_id = 0 and name &lt;&gt; 'TFCS' order by name&quot;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="422"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{51419FB0-CB16-481a-8494-B685DBFAB7A3}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_TEXTS&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Module containing all texts used throughout TFCS -that are visible to the enduser- &#xA;' Texts are grouped on the referencing module and prefixed with a module identifier to prevent name clashes.&#xA;'&#xA;' NOTE: some texts are/can be referenced by several modules (like eg workspace name), &#xA;' this is indicated by a the prefix GEN with double underscore&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;' =============================================================================&#xA;' TFCS_ModelValidation&#xA;' =============================================================================&#xA;const VAL_NO_RELATIONS_ALLOWED = &quot;Dit element mag geen enkele relatie met andere elementen hebben. Leg de relatie op een andere manier.&quot;&#xA;const VAL_ACT_ON_DGM = &quot;Mag op geen enkel diagram voorkomen. Verwijder deze (als deze onderdeel vormt van een workflow: plaats deze vervolgens als stap (scherm/complex of subflow).&quot;&#xA;const VAL_ISSUE_NOT_REALISED = &quot;Issue is nergens aan gerelateerd. Koppel deze aan het(de) modelelement(en) waarop deze betrekking heeft.&quot;&#xA;const VAL_REQ_NOT_REALISED = &quot;Requirement is niet gerealiseerd. Koppel de model element(en) die in deze requirement voorzien.&quot; &#xA;const VAL_UNKNOWN_STEREOTYPE = &quot;Dit stereotype wordt nog niet gevalideerd: {0}. Neem contact op met de beheerder van TFCS.&quot;&#xA;const VAL_ACTOR_UNUSED = &quot;Actor is bij geen enkele workflow betrokken. Koppel de actor aan ten minste EEN workflow.&quot;&#xA;const VAL_ELT_NOT_USED = &quot;Domein instance wordt niet gebruikt. Neem deze op in een workflow of workflow definitie en koppel deze.&quot;&#xA;const VAL_ELT_NOT_ON_DIAGRAM = &quot;Het element is niet opgenomen in een diagram van type {0}.&quot;&#xA;const VAL_WF_NOT_ON_UCDEFDGM = &quot;Workflow is in geen enkele workflow specificatie opgenomen ({0}).&quot;&#xA;const VAL_WF_NOT_ON_UCDGM = &quot;Workflow is in geen enkel workflow overzicht opgenomen ({0}).&quot;&#xA;const VAL_ACTOR_NOT_ON_UCDEFDGM = &quot;Actor is in geen enkele workflow specificatie opgenomen ({0}).&quot;&#xA;const VAL_ACTOR_NOT_ON_UCDGM = &quot;Actor is in geen enkel workflow overzicht opgenomen ({0}).&quot;&#xA;const VAL_MULTIPLE_STEREOTYPES = &quot;Dit element heeft meerdere stereotypen ({0}), dit is niet toegestaan. Zorg ervoor dat het element een enkel stereotype heeft.&quot;&#xA;const VAL_ELT_NOT_PART_OF_FLOW = &quot;Element maakt geen deel uit van een workflow. Neem het element in een workflow op.&quot;&#xA;const VAL_COMP_IN_COMP = &quot;Opgenomen in een diagram van een ander scherm of component. Een component of scherm mag zelf geen verdere verdiepingen bevatten.&quot;&#xA;const VAL_WF_ISON_DIAGRAM = &quot;Dit element mag niet in een diagram worden opgenomen. Vervang deze door een bijbehorende stap (workflow).&quot;&#xA;const VAL_MISSING_WFDEFN_DIAGRAM = &quot;Dit element moet precies 1 diagram bevatten en dit moet een workflowdefinitie diagram zijn.&quot;&#xA;const VAL_MISSING_WF_DIAGRAM = &quot;Dit element moet precies 1 diagram bevatten en dit moet een workflowrealisatie diagram zijn.&quot;&#xA;const VAL_DGM_NOT_ALLOWED_BELOW_ELT = &quot;Dit diagram mag niet opgenomen zijn onder element '{0}'&quot;&#xA;const VAL_DOMRULE_NOT_REALISED = &quot;Domeinregel is aan geen enkel domeinobject gerelateerd.&quot;&#xA;const VAL_ELT_ON_INVALID_DGM = &quot;Element mag niet in dit diagram worden opgenomen&quot;&#xA;const VAL_INVALID_SUBFLOW = &quot;Een workflow mag alleen subflows van eenzelfde of lager niveau bevatten, dus bv een werkinstructie mag geen bedrijfsproces als stap bevatten.&quot;&#xA;const VAL_WF_IS_NOT_USED = &quot;Deze workflow wordt niet gebruikt in een andere workflow. Als deze workflow het hoogste niveau is dan zal dit kloppen, neem anders de workflow als subflow op binnen een andere workflow.&quot;&#xA;const VAL_COMP_IS_NOT_USED = &quot;Deze component wordt niet gebruikt. Neem  de component op als stap in een of meer workflows.&quot;&#xA;const VAL_AI_IS_NOT_USED = &quot;Dit autorisatieitem is nog niet gebruikt. Koppel deze aan de te autoriseren handelingen/gegevens.&quot;&#xA;const VAL_WFTYPETAG_MISSING = &quot;Tag 'WorkflowType' ontbreekt of heeft een ongeldige waarde (waarde moet zijn een van {0})&quot;&#xA;const VAL_WFTYPETAG_DIFFERS = &quot;Niveau van de stap wijkt af van dat van de subflow (WorkflowType is {0} ipv {1}). Verwijder de stap en plaats deze opnieuw.&quot;&#xA;const VAL_WF_MISSING_UCELT = &quot;De naam van dit element moet gelijk zijn aan de naam van de use case ({0})&quot;&#xA;const VAL_INVALID_WF_EXTENSION = &quot;De workflow mag alleen extenden van een workflow van hetzelfde niveau ({0})&quot;&#xA;const VAL_REVERSED_CONNECTOR = &quot;Een relatie van type 'Destination -&gt; Source' is niet toegestaan. Verwijder de relatie en leg deze opnieuw.&quot;&#xA;const VAL_PROGRAM_FAILURE = &quot;Er is een fout opgetreden in de validatie. Neem contact op met de beheerder van TFCS (fout in {0}).&quot;&#xA;const VAL_RELATION_NOT_VALID = &quot;Deze relatie is hier niet toegestaan ({0} van {1}({2}) -&gt; {3}({4})).&quot;&#xA;const VAL_RELATIONSTEREO_NOT_VALID = &quot;Stereotype van deze relatie is niet toegestaan {5}({0}) van {1}({2}) -&gt; {3}({4})). Verwijder de relatie en leg deze opnieuw.&quot;&#xA;const VAL_WF_ACT_NAMES_NOT_SAME = &quot;De naam van de workflow volgt niet de standaard. Controleer de naamgeving van de elementen in de projectbrowser bij deze workflow.&quot;&#xA;const VAL_UC_MISSING_FOR_WF = &quot;Het UC element ontbreekt of heeft niet dezelfde naam als de activity.&quot;&#xA;const VAL_SUBLOWS_NOT_ALLOWED = &quot;Een stap van type subflow is hier niet toegestaan.&quot;&#xA;const VAL_WFSTEP_INVALID_IN_WORKFLOW = &quot;Een stap van type '{0}' mag niet zijn opgenomen in een workflow van type '{1}'.&quot;&#xA;const VAL_WFSTEP_INVALID_IN_COMPONENT = &quot;Een subflow mag niet in een scherm of component flow worden opgenomen.&quot;&#xA;const VAL_NO_CLASSIFIERINST_ON_FLOWDEFDGM = &quot;Het domeinobject ontbreekt nog in de definitie van de workflow. Voeg deze daar nog toe.&quot;&#xA;const VAL_NO_CLASSIFIER_ON_FLOWDEFDGM = &quot;Het bijbehorende autorisatieitem ontbreekt nog in de definitie van de workflow. Voeg deze daar nog toe.&quot;&#xA;const VAL_INFO_ADDED_AI_TO_WFDEFN = &quot;Autorisatie '{0}' is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_INFO_ADDED_REQ_TO_WFDEFN = &quot;Requirement '{0}' is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_INFO_ADDED_ELT_TO_WFDEFN = &quot;Impliciet gerelateerd element '{0}' is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_INFO_ADDED_DO_TO_WFDEFN = &quot;Domeinobject '{0}' is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_DGM_INVALID_PARENT = &quot;Plaats het diagram onder een element van een type '{0}'.&quot;&#xA;const VAL_INFO_ADDED_RELATED_TO_WFDEFN = &quot;Aan de workflow gerelateerd element '{0}' toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_INFO_ADDED_WF_TO_WFDEFN = &quot;Subflow '{0}' is ook toegevoegd aan het workflow definitie diagram.&quot;&#xA;const VAL_ACTION_MISSING_CLASSIFIER = &quot;De workflow waarop deze stap is gebaseerd is verwijderd uit het model. Verwijder ook deze stap.&quot;&#xA;const VAL_COMP_MISSING_CLASSIFIER = &quot;De component of het scherm waarop deze stap is gebaseerd is verwijderd uit het model. Verwijder ook deze stap.&quot;&#xA;const VAL_AUT_MISSING_CLASSIFIER = &quot;De autorisatie wat dit effect heeft is verwijderd uit het model. Verwijder ook dit effect.&quot;&#xA;const VAL_DOMAIN_MISSING_CLASSIFIER = &quot;Het domeinobject is verwijderd uit het model. Verwijder deze ook hier.&quot;&#xA;const VAL_NON_TFCS_ELEMENT = &quot;Dit element mag niet gebruikt worden binnen TFCS. Als het niet gebruikt wordt verwijder het dan, anders vervang dit door een modelelement uit TFCS.&quot;&#xA;const VAL_NO_RELATIONS_ALLOWED_OFTYPE = &quot;Relatie van type '{0}' tussen deze elementen niet toegestaan.&quot;&#xA;const VAL_ELT_ON_OTHER_DIAGRAM = &quot;Element hergebruikt buiten het eigen diagram. Zorg ervoor dat een element alleen is opgenomen in het diagram waaronder deze in de project browser is vastgelegd.&quot;&#xA;const VAL_MISSING_INCLUDES_EXTENDS =&quot;Leg een include of extend relatie van '{1}' naar '{0}' of verwijder '{0}' van het diagram.&quot;&#xA;const VAL_COMP_ON_COMPDGM = &quot;Een scherm of complexe stap mag alleen binnen een diagram van een workflow worden opgenomen. Verwijder de stap of neem het diagram over bij een workflow.&quot;&#xA;const VAL_ELT_UNRELATED_TO_WF = &quot;Element is niet gerelateerd aan de workflow en komt ook niet terug in het workflow realisatie diagram '{0}'.&quot;&#xA;const VAL_AUT_UNRELATED_TO_WF= &quot;Autorisatie komt niet terug in het workflow realisatie diagram '{0}'.&quot;&#xA;const VAL_ACT_UNRELATED_TO_WF = &quot;Actor is niet gerelateerd aan de workflow&quot;&#xA;const VAL_WF_UNRELATED_TO_WF = &quot;Workflow komt niet terug in het workflow realisatie diagram '{0}'. Neem de workflow als subflow op in het workflow realisatie diagram.&quot;&#xA;const VAL_INFO_ADDED_MISSING_ELEMENT_TO_WFREAL = &quot;Gerelateerd element toegevoegd aan de workflow.&quot;&#xA;const VAL_WF_HAS_NO_UCDEFDGM = &quot;De workflow is niet meer opgenomen in zijn workflow definitie diagram. Zorg ervoor dat de workflow een definitie diagram heeft waarin deze is opgenomen.&quot;&#xA;&#xA;' =============================================================================&#xA;' Menu items&#xA;' =============================================================================&#xA;const DOCGEN_OUTPUT_LOCATION = &quot;Selecteer de map voor de output bestanden.&quot;&#xA;&#xA;const MNU_GENERATE_WFSPEC = &quot;Genereer workflow specificatie&quot;&#xA;const MNU_GENERATECONTEXTRTF = &quot;Genereer context document&quot;&#xA;&#xA;' =============================================================================&#xA;' TFCS_Commons&#xA;' =============================================================================&#xA;const COMM_NEW_WORKFLOW = &quot;Nieuwe workflow&quot;&#xA;dim COMM_WORKSPACE_MISSING: COMM_WORKSPACE_MISSING = _&#xA;	&quot;Kon de workspace van de gebruiker niet vinden:&quot;+vbCRLF+vbCRLF+&quot;     {0}&quot;+vbCRLF+vbCRLF+&quot;Maak deze eerst aan&quot;+vbCRLF&#xA;&#xA;' =============================================================================&#xA;' TFCS_CreateFromToolbox/TFCS_CreateFromProjectBrowser&#xA;' =============================================================================&#xA;' TFCS elementtype not allowed on TFCS diagram&#xA;const DDH_TITLE_NOTALL = &quot;Niet toegestaan&quot;&#xA;dim DDH_PROMPT_USE_TOOLBOX : DDH_PROMPT_USE_TOOLBOX = &quot;Dit soort elementen kunnen alleen via de&quot;+ _&#xA;	vbCRLF+&quot;toolbox op dit diagram worden opgenomen&quot;&#xA;dim DDH_PROMT_NOTALL : DDH_PROMT_NOTALL = &quot;Dit element is niet toegestaan&quot;+vbCRLF+&quot;op {0} diagram&quot;&#xA;dim DDH_PROMPT_PBCR_NOTALLOWED : DDH_PROMPT_PBCR_NOTALLOWED = _&#xA;	&quot;Modelelementen mogen alleen via de toolbox&quot;+vbCRLF+&quot;bij een diagram worden aangemaakt.&quot;&#xA;dim DDH_PROMPT_WF_NOT_ALLOWED_ON_COMP: DDH_PROMPT_WF_NOT_ALLOWED_ON_COMP = _&#xA;	&quot;Een complexe stap of scherm mag&quot;+vbCRLF+&quot;geen subflow bevatten.&quot;&#xA;dim DDH_PROMPT_COMP_NOT_ALLOWED_ON_COMP: DDH_PROMPT_COMP_NOT_ALLOWED_ON_COMP = _&#xA;	&quot;Een complexe stap of scherm mag&quot;+vbCRLF+&quot;zelf geen complexe stap of scherm bevatten.&quot;&#xA;&#xA;const DDH_NOTALL_FLOWDEFDGM = &quot;een workflow definitie&quot;&#xA;const DDH_NOTALL_GENERICTYPE = &quot;dit type&quot;&#xA;const DDH_NOTALL_FLOWSDGM = &quot;een workflow overzicht&quot;&#xA;const DDH_NOTALL_FLOWDGM = &quot;een workflow realisatie&quot;&#xA;const DDH_NOTALL_DOMAINDGM = &quot;een domein&quot;&#xA;const DDH_NOTALL_REQDGM = &quot;een requirements&quot;&#xA;const DDH_NOTALL_MNTDGM = &quot;een beheer&quot;&#xA;&#xA;' TFCS element already present in diagram&#xA;dim DDH_PROMPT_ELTONDGM : DDH_PROMPT_ELTONDGM = &quot;Dit element is al opgenomen op dit diagram&quot;+vbCRLF+&quot;U kunt dit element maar 1x opnemen&quot;&#xA;const DDH_TITLE_ELTONDGM = &quot;TFCS Model validatie&quot;&#xA;&#xA;&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="423"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{B9FB233B-36B5-4b45-8415-640E20B5D031}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_Constants&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="' Working directory for TFCS&#xA;const TFCSBASEDIR = &quot;d:/TFCS/Test&quot;&#xA;const MNU_TFCSMAIN = &quot;-EAST&quot;&#xA;&#xA;' Types of workflows in the TFCS meta-model&#xA;const FLOWTYPE_WF = &quot;BedrijfsProces&quot;&#xA;const FLOWTYPE_WI = &quot;WerkInstructie&quot;&#xA;const FLOWTYPE_UC = &quot;UseCase&quot;&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' DBMS specific settings (used in TFCS_SQL and TFCS_VALSQL)&#xA;' Change according to the DBMS that is used&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;dim xWCx 		' wildcard&#xA;dim xUCASEx 	' convert text to uppercase&#xA;dim xMIDx		' get substring&#xA;dim xMEMOx		' handling memo/clob fields&#xA;&#xA;' .EAP (MSAccess)&#xA;&#xA;xWCx = &quot;*&quot;	&#xA;xUCASEx = &quot;ucase&quot;	&#xA;xMIDx = &quot;mid&quot;&#xA;xMEMOx = &quot;&quot;&#xA;function xIfNullx(a,b)&#xA;	xIfNullx = &quot;IIF(ISNULL(&quot;+a+&quot;),&quot;+b+&quot;,&quot;+a+&quot;)&quot;&#xA;end function&#xA;function xInStrx(start,s1,s2)&#xA;	xInStrx = &quot;InStr(&quot;+start+&quot;,&quot;+s1+&quot;,&quot;+s2+&quot;)&quot;&#xA;end function&#xA;&#xA;' Oracle&#xA;&#xA;'xWCx = &quot;%&quot;			&#xA;'xUCASEx = &quot;Upper&quot;&#xA;'xMIDx = &quot;Substr&quot;&#xA;'xMEMOx = &quot;dbms_lob.&quot;&#xA;'&#xA;'function IfNull(a,b)&#xA;'	IfNull = &quot;nvl(&quot;+a+&quot;,&quot;+b+&quot;)&quot;&#xA;'end function&#xA;'&#xA;'function InStr(start,s1,s2)&#xA;'	InStr = &quot;InStr(&quot;+s1+&quot;,&quot;+s2+&quot;,&quot;+start+&quot;)&quot;&#xA;'end function&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="424"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{B7BA7B61-51D3-4163-88DE-8412BC4489CE}"/>
			<Column name="ScriptAuthor" value="{396E2266-67C6-42bb-8925-73771B603AB6}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_Traceability&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' SQL statements and supporting methods for reporting&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;&#xA;dim sqlISSs: sqlISSs = &quot;select left(o.name,100) as label, o.object_id as ID from t_object o &quot; + _&#xA;	&quot; where o.stereotype in ('TFCS_Issue','TFCS_ReviewComment','TFCS_Ambiguity') order by o.stereotype,o.name&quot;&#xA;dim sqlTBDs: sqlTBDs = &quot;select left(o.name,100) as label, o.object_id as ID from t_object o where o.stereotype = 'TFCS_TBD' order by o.name&quot;&#xA;dim sqlDRs: sqlDRs = &quot;select left(o.name,100) as label, o.object_id as ID from t_object o where o.stereotype = 'TFCS_DomainRule' order by o.name&quot;&#xA;dim sqlDOs: sqlDOs = &quot;select o.name as label, o.object_id as ID from t_object o where o.stereotype = 'TFCS_DomainObject' order by o.name&quot;&#xA;dim sqlACTs: sqlACTs = &quot;select o.name as label, o.object_id as ID from t_object o where o.stereotype = 'TFCS_Actor' order by o.name&quot;&#xA;dim sqlWFs: sqlWFs = &quot;select o.name as label, o.object_id as ID from t_object o where o.stereotype = 'TFCS_Workflow' order by o.name&quot;&#xA;dim sqlAUTs: sqlAUTs = &quot;select left(o.name,100) as label, o.object_id as ID rom t_object o where o.stereotype = 'TFCS_Authorisation' order by o.name&quot;&#xA;dim sqlREQs: sqlREQs = &quot;select left(o.name,100) as label, o.object_id as ID &quot;+ _&#xA;	&quot; from t_object o where o.stereotype in ('TFCS_NFR','TFCS_Requirement') order by o.stereotype, o.name&quot;&#xA;dim sqlLAWs: sqlLAWs = &quot;select left(o.name,100) as label, o.object_id as ID &quot;+ _&#xA;	&quot; from t_object o where o.stereotype = 'TFCS_Legislation' order by o.stereotype, o.name&quot;&#xA;dim sqlRFCs: sqlRFCs = &quot;select left(o.name,100) as label, o.object_id as ID &quot;+ _&#xA;	&quot; from t_object o where o.stereotype = 'TFCS_Request' order by o.stereotype, o.name&quot;&#xA;	&#xA;' All elements of type workflow, domainobject, domainrule&#xA;dim sqlCOREs: sqlCOREs = &quot;select left(o.name,100) as label, o.object_id as ID &quot;+ _&#xA;	&quot; from t_object o where &quot;+ _&#xA;	&quot; o.stereotype in ('TFCS_Workflow','TFCS_DomainObject','TFCS_DomainRule') order by o.stereotype, o.name&quot;&#xA;&#xA;' Workflows referenced by WF&#xA;dim sqlWFReferencedByWF: sqlWFReferencedByWF = &quot;select distinct uc.object_id as ROWID, r.object_id as COLID, left(conn.stereotype,1) as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot;		,t_connector conn  &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and uc.object_id = conn.start_object_id and r.object_id = conn.end_object_id&quot;+ _&#xA;&quot; 		and conn.stereotype in ('extend','include')&quot;+ _&#xA;&quot; 		and uc.object_id &lt;&gt; r.object_id&quot;&#xA;&#xA;' Workflows referencing WF&#xA;dim sqlWFReferencingWF: sqlWFReferencingWF = &quot;select distinct uc.object_id as ROWID, r.object_id as COLID, left(conn.stereotype,1) as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot;		,t_connector conn  &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and r.object_id = conn.start_object_id and uc.object_id = conn.end_object_id&quot;+ _&#xA;&quot; 		and conn.stereotype in ('extend','include')&quot;+ _&#xA;&quot; 		and uc.object_id &lt;&gt; r.object_id&quot;&#xA;&#xA;' Workflows implementing requirement and vice versa&#xA;dim sqlWFImplementingREQ: sqlWFImplementingREQ = &quot;select distinct r.object_id as ROWID, uc.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype in ('TFCS_NFR','TFCS_Requirement')&quot;&#xA;dim sqlREQImplementedByWF: sqlREQImplementedByWF = &quot;select distinct uc.object_id as ROWID, r.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype in ('TFCS_NFR','TFCS_Requirement')&quot;&#xA;&#xA;' Workflows implementing legislation and vice versa&#xA;dim sqlWFImplementingLAW: sqlWFImplementingLAW = &quot;select distinct r.object_id as ROWID, uc.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_Legislation'&quot;&#xA;dim sqlLAWImplementedByWF: sqlLAWImplementedByWF = &quot;select distinct uc.object_id as ROWID, r.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_Legislation'&quot;&#xA;&#xA;' Workflows involving actor&#xA;dim sqlACTInvolvedInWF: sqlACTInvolvedInWF = &quot;select distinct uc.object_id as ROWID, a.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_object uc &quot;+ _&#xA;&quot; 		,t_object a &quot;+ _&#xA;&quot;		,t_connector conn  &quot;+ _&#xA;&quot; 	where uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and a.stereotype = 'TFCS_Actor' &quot;+ _&#xA;&quot; 		and a.object_id = conn.start_object_id and uc.object_id = conn.end_object_id&quot;+ _&#xA;&quot; 		and conn.connector_type = 'UseCase'&quot;&#xA;&#xA;' Core model objects involved in RFC&#xA;dim sqlCOREAffectedByRFC: sqlCOREAffectedByRFC = &quot;select distinct r.object_id as ROWID, o.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_object o &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot;		,t_connector conn  &quot;+ _&#xA;&quot; 	where o.stereotype in ('TFCS_Workflow','TFCS_DomainObject','TFCS_DomainRule')  &quot;+ _&#xA;&quot; 		and r.object_id = conn.start_object_id and o.object_id = conn.end_object_id&quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_Request'&quot;&#xA;&#xA;' Requirements part of requirement&#xA;dim sqlREQPartOfREQ: sqlREQPartOfREQ = &quot;select distinct r.object_id as ROWID, o.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_object o &quot;+ _&#xA;&quot; 		,t_object r &quot; + _&#xA;&quot; 	where o.stereotype in ('TFCS_NFR','TFCS_Requirement')  &quot;+ _&#xA;&quot; 		and o.parentid = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype in ('TFCS_NFR','TFCS_Requirement')&quot;&#xA;&#xA;' Law part of law&#xA;dim sqlLAWPartOfLAW: sqlLAWPartOfLAW = &quot;select distinct r.object_id as ROWID, o.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_object o &quot;+ _&#xA;&quot; 		,t_object r &quot; + _&#xA;&quot; 	where o.stereotype = 'TFCS_Legislation'  &quot;+ _&#xA;&quot; 		and o.parentid = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_Legislation'&quot;&#xA;&#xA;' All domainobjects that have a create,read,update,delete or input dependency with a WF&#xA;dim sqlDOInvolvedInWF: sqlDOInvolvedInWF = _&#xA;&quot;	select distinct uc.object_id as ROWID, do.object_id as COLID, 'X'  as XREF&quot;+ _&#xA;&quot;		from t_object uc &quot;+ _&#xA;&quot;			,t_connector conn  &quot;+ _&#xA;&quot;			,t_object doi &quot;+ _&#xA;&quot;			,t_object do &quot;+ _&#xA;&quot;		where uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot;			and (uc.object_id = conn.start_object_id and doi.object_id = conn.end_object_id and conn.stereotype in ('update','create','delete'))&quot;+ _&#xA;&quot;			and doi.classifier = do.object_id&quot;+ _&#xA;&quot;			and do.stereotype = 'TFCS_DomainObject' &quot;+ _&#xA;&quot;	union&quot;+ _&#xA;&quot;	select distinct uc.object_id as ROWID, do.object_id as COLID, 'X'  as XREF&quot;+ _&#xA;&quot;		from t_object uc &quot;+ _&#xA;&quot;			,t_connector conn  &quot;+ _&#xA;&quot;			,t_object doi &quot;+ _&#xA;&quot;			,t_object do &quot;+ _&#xA;&quot;		where uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot;			and (doi.object_id = conn.start_object_id and uc.object_id = conn.end_object_id)&quot;+ _&#xA;&quot;			and doi.classifier = do.object_id&quot;+ _&#xA;&quot;			and do.stereotype = 'TFCS_DomainObject' &quot;&#xA;&#xA;' All domainrules relating to domainobjects that have a create,read,update,delete or input dependency with a WF&#xA;dim sqlDRInvolvedInWF: sqlDRInvolvedInWF = _&#xA;&quot;	select distinct uc.object_id as ROWID, dr.object_id as COLID, 'X'  as XREF&quot;+ _&#xA;&quot;		from t_object uc &quot;+ _&#xA;&quot;			,t_connector conn  &quot;+ _&#xA;&quot;			,t_object doi &quot;+ _&#xA;&quot;			,t_object do &quot;+ _&#xA;&quot;			,t_connector dor&quot;+ _&#xA;&quot;			,t_object dr&quot;+ _&#xA;&quot;		where uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot;			and (uc.object_id = conn.start_object_id and doi.object_id = conn.end_object_id and conn.stereotype in ('update','create','delete'))&quot;+ _&#xA;&quot;			and doi.classifier = do.object_id&quot;+ _&#xA;&quot;			and do.stereotype = 'TFCS_DomainObject' &quot;+ _&#xA;&quot;			and (dr.object_id = dor.start_object_id and do.object_id = dor.end_object_id )&quot; + _&#xA;&quot;			and dr.stereotype = 'TFCS_DomainRule' &quot; + _&#xA;&quot;	union&quot;+ _&#xA;&quot;	select distinct uc.object_id as ROWID, dr.object_id as COLID, 'X'  as XREF&quot;+ _&#xA;&quot;		from t_object uc &quot;+ _&#xA;&quot;			,t_connector conn  &quot;+ _&#xA;&quot;			,t_object doi &quot;+ _&#xA;&quot;			,t_object do &quot;+ _&#xA;&quot;			,t_connector dor&quot;+ _&#xA;&quot;			,t_object dr&quot;+ _&#xA;&quot;		where uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot;			and (doi.object_id = conn.start_object_id and uc.object_id = conn.end_object_id)&quot;+ _&#xA;&quot;			and doi.classifier = do.object_id&quot;+ _&#xA;&quot;			and do.stereotype = 'TFCS_DomainObject' &quot; + _&#xA;&quot;			and (dr.object_id = dor.start_object_id and do.object_id = dor.end_object_id )&quot; + _&#xA;&quot;			and dr.stereotype = 'TFCS_DomainRule' &quot;&#xA;&#xA;' Domain objects involved in a domainrule&#xA;dim sqlDOReferencedByDR: sqlDOReferencedByDR = _&#xA;&quot;select distinct dr.object_id as ROWID, do.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_object do &quot;+ _&#xA;&quot; 		,t_object dr &quot;+ _&#xA;&quot;		,t_connector dor  &quot;+ _&#xA;&quot; 	where do.stereotype = 'TFCS_DomainObject'  &quot;+ _&#xA;&quot;		and (dr.object_id = dor.start_object_id and do.object_id = dor.end_object_id )&quot; + _&#xA;&quot;		and dr.stereotype = 'TFCS_DomainRule' &quot;&#xA;&#xA;' Autorisations used within a workflow&#xA;dim sqlAUTReferencedByWF: sqlAUTReferencedByWF = _&#xA;&quot;select distinct uc.object_id as ROWID, r.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_Authorisation'&quot;&#xA;&#xA;' Autorisations used by actor&#xA;dim sqlAUTUsedByACT: sqlAUTUsedByACT = _&#xA;&quot;select distinct a.object_id as ROWID, r.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot; 		,t_object a &quot;+ _&#xA;&quot; 		,t_connector auc &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_Authorisation'&quot; + _&#xA;&quot; 		and a.stereotype = 'TFCS_Actor' &quot;+ _&#xA;&quot; 		and a.object_id = auc.start_object_id and uc.object_id = auc.end_object_id&quot;&#xA;&#xA;' Workflows affected by an issue (bug, review comment, ambiguity)&#xA;dim sqlWFAffectedByIssue: sqlWFAffectedByIssue = _&#xA;&quot;select distinct r.object_id as ROWID, uc.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype in ('TFCS_Issue','TFCS_ReviewComment','TFCS_Ambiguity')&quot;&#xA;&#xA;' Workflows affected by a TBD&#xA;dim sqlWFAffectedByTBD: sqlWFAffectedByTBD = _&#xA;&quot;select distinct r.object_id as ROWID, uc.object_id as COLID, 'X' as XREF&quot;+ _&#xA;&quot; 	from t_diagram dd &quot;+ _&#xA;&quot; 		,t_object uc &quot;+ _&#xA;&quot; 		,t_diagramobjects ddo &quot;+ _&#xA;&quot; 		,t_object r &quot;+ _&#xA;&quot; 	where uc.parentid = dd.parentid &quot;+ _&#xA;&quot; 		and uc.stereotype = 'TFCS_Workflow' &quot;+ _&#xA;&quot; 		and ddo.diagram_id = dd.diagram_id &quot;+ _&#xA;&quot;  		and ddo.object_id = r.object_id &quot;+ _&#xA;&quot; 		and r.stereotype = 'TFCS_TBD'&quot;&#xA;&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;' Creates a dependency matrix report and opens it in XLS&#xA;'&#xA;' Parameters:&#xA;' sqlAllRows 	- SQL returning LABEL and ID for each row in the matrix&#xA;' sqlAllCols 	- SQL returning LABEL and ID for each column in the matrix&#xA;' sqlRowsxCols	- SQL returning the relations between rows and columns, as ROWID,COLID and XREF (type of relation, currently ignored)&#xA;' sqlRowsxRows	- optional SQL for reduction of transitive relations on row items&#xA;' sqlColsxCols	- optional SQL for reduction of transitive relations on column items&#xA;' fileName		- name of the XLS report (path is fixed and set to TFCS basedir/reports)&#xA;'&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;dim tempDir: tempDir = TFCSBASEDIR+&quot;/reports&quot;&#xA;sub CreateAndShowReport(sqlAllRows,sqlAllCols,sqlRowsxCols,sqlRowsxRows,sqlColsxCols,file)&#xA;&#xA;	' Create dependency matrix and dump to a CSV file&#xA;	dim rowlabels: set rowlabels = EAST.ExecuteSQL(sqlAllRows, &quot;&quot;)&#xA;	dim collabels: set  collabels = EAST.ExecuteSQL(sqlAllCols, &quot;&quot;)&#xA;	dim xref: set xref = EAST.GetXReferences(sqlAllRows,sqlAllCols,sqlRowsxCols,sqlRowsxRows,sqlColsxCols)&#xA;	Dim path : path = tempDir + &quot;/&quot; + file + &quot;.txt&quot;&#xA;	Dim pathXLS : pathXLS = tempDir + &quot;/&quot; + file + &quot;.xls&quot;&#xA;	Dim a : a = XRefDict2Array(xref)&#xA;	if not Dump2CSV(a,rowlabels,collabels,path) then&#xA;		exit sub&#xA;	end if&#xA;&#xA;	' Load the CSV in Excel and format this.&#xA;	Dim fso : set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xA;	If fso.FileExists(pathXLS) Then&#xA;		On Error Resume Next&#xA;		fso.DeleteFile pathXLS, True&#xA;		If Err.Number &lt;&gt; 0 Then&#xA;			EAST.MsgBox &quot;De bewerking is afgebroken vanwege een fout bij het verwijderen &quot;+vbCRLF+ _&#xA;			&quot;van het bestand '&quot;+pathXLS+&quot;'.&quot; _&#xA;			+vbCRLF+vbCRLF+&quot;Foutmelding: &quot;+Err.Description _&#xA;			,16,&quot;Samenstellen rapport&quot;&#xA;			on error goto 0&#xA;			exit sub&#xA;		End If		&#xA;	End If&#xA;&#xA;	Dim xls : set xls = CreateObject(&quot;Excel.Application&quot;)&#xA;	xls.Visible = False&#xA;&#xA;	xls.Workbooks.OpenText path, , , 1, 1, , , , , , True, &quot;|&quot;&#xA;	Dim wb : set wb = xls.ActiveWorkbook&#xA;	xls.Rows(&quot;1:1&quot;).Select()&#xA;	xls.Selection.Orientation = 90&#xA;	xls.Selection.ColumnWidth = 3&#xA;	xls.Columns(&quot;A:A&quot;).EntireColumn.AutoFit()&#xA;	wb.SaveAs pathXLS, -4143&#xA;	xls.Visible = true&#xA;&#xA;	' Remove the CSV file&#xA;	If fso.FileExists(path) Then&#xA;		fso.DeleteFile path, True&#xA;	End If&#xA;	&#xA;	' Release handles to allow future garbage collection &#xA;	' (Can't quit Excel here since XLS must remain open)&#xA;	set wb = nothing&#xA;	set xls = nothing&#xA;	set fso = nothing&#xA;		&#xA;End Sub&#xA;&#xA;' Dumps a 2D array to a CSV using pipeline symbol as separator&#xA;function Dump2CSV(a, rowlabels, collabels, path)&#xA;	Dump2CSV = false&#xA;	Dim fso : set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xA;	On Error Resume Next&#xA;	Dim csv : set csv = fso.CreateTextFile(path, True)&#xA;	If Err.Number &lt;&gt; 0 Then&#xA;		EAST.MsgBox &quot;De bewerking is afgebroken vanwege een fout bij het aanmaken &quot;+vbCRLF+ _&#xA;			&quot;van het bestand '&quot;+path+&quot;'&quot;+ _&#xA;			vbCRLF+vbCRLF+&quot;Foutmelding: &quot;+Err.Description _&#xA;			,16,&quot;Samenstellen rapport&quot;&#xA;		on error goto 0&#xA;		exit function&#xA;	End If		&#xA;&#xA;	Dim label&#xA;	Dim line : line = &quot;&quot;&#xA;	For Each label In collabels.items&#xA;		line = line + &quot;|&quot; + label.item(&quot;LABEL&quot;)&#xA;	Next&#xA;	csv.write(line+ vbCrLf)&#xA;&#xA;	Dim i, j&#xA;	For i = 0 To UBound(a, 1)&#xA;		line = rowlabels.item(i).item(&quot;LABEL&quot;)&#xA;		For j = 0 To UBound(a, 2)&#xA;			if a(i,j) = 0 then&#xA;				line = line + &quot;|&quot; &#xA;			else&#xA;				line = line + &quot;|&quot; + a(i, j)&#xA;			end if&#xA;		Next&#xA;		line = line + vbCrLf&#xA;		csv.write(line)&#xA;	Next&#xA;	csv.close()&#xA;	Dump2CSV = true&#xA;End function&#xA;' Converts a Xref dictionary (output from GetXReferencesFor) to a 2D array&#xA;Function XRefDict2Array(ByVal dict)&#xA;	Dim a&#xA;&#xA;	Dim row, column&#xA;	Dim i : i = 0&#xA;	For Each row In dict.Items&#xA;		if i = 0 then&#xA;			ReDim a(dict.count - 1, row.count-1)&#xA;		end if&#xA;		Dim j : j = 0&#xA;		For Each column In row.keys&#xA;			If column &lt;&gt; &quot;HEADER&quot; Then&#xA;				a(i, j) = row.item(column)&#xA;				j = j + 1&#xA;			End If&#xA;		Next&#xA;		i = i + 1&#xA;	Next&#xA;	XRefDict2Array = a&#xA;End Function&#xA;&#xA;&#xA;&#xA;' Dumps a 2D array to the output&#xA;Sub Dump2DArray(ByVal a)&#xA;	Dim i, j&#xA;	For i = 0 To UBound(a, 1)&#xA;		Dim msg : msg = &quot;['&quot; + a(i, 0)&#xA;		For j = 1 To UBound(a, 2)&#xA;			msg = msg + &quot;','&quot; + a(i, j)&#xA;		Next&#xA;		msg = msg + &quot;']&quot;&#xA;		EAST.LogInfo(msg)&#xA;	Next&#xA;End Sub&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="425"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{7B7BF626-68C1-43ce-97A1-250CC4A7906C}"/>
			<Column name="ScriptAuthor" value="{95A020FB-AB55-46ed-8BAD-0903B6E77BD8}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;TFCS_Reports&quot; Type=&quot;Internal&quot; Language=&quot;VBScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="'----------------------------------------------------------------------------------------------------------------------&#xA;' Reports on relationships (main menu item 'Rapportages')&#xA;'----------------------------------------------------------------------------------------------------------------------&#xA;option explicit&#xA;&#xA;!INC TFCS_Support.TFCS_Constants&#xA;!INC TFCS_Support.TFCS_Traceability&#xA;&#xA;const MNU_REPORTS = &quot;-Rapportages&quot;&#xA;&#xA;const MNU_REP_REQ= &quot;-Requirements&quot;&#xA;const MNU_REQxWF = &quot;Workflows die een (niet)functionele eis implementeren&quot;&#xA;const MNU_LAWxWF = &quot;Workflows die een wetgeving implementeren&quot;&#xA;const MNU_RFCxALL = &quot;Onderdelen geraakt door een RFC&quot;&#xA;&#xA;const MNU_REP_WF = &quot;-Workflows&quot;&#xA;const MNU_WFxREQ = &quot;Requirements geraakt door workflow&quot;&#xA;const MNU_WFxLAW = &quot;Wetgeving geraakt door workflow&quot;&#xA;const MNU_WFxACT = &quot;Actoren betrokken bij workflow&quot;&#xA;const MNU_WFxDO = &quot;Domeinobjecten betrokken bij workflow&quot;&#xA;const MNU_WFxDR = &quot;Domeinregels geraakt door workflow&quot;&#xA;const MNU_WFxWF = &quot;Workflows gebruikt binnen workflow&quot;&#xA;&#xA;const MNU_REP_DIV = &quot;-Diversen&quot;&#xA;const MNU_DRxDO = &quot;Domeinobjecten betrokken bij domeinregel&quot;&#xA;const MNU_WFxAUT = &quot;Authorisaties gebruikt binnen workflow&quot;&#xA;const MNU_ACTxAUT = &quot;Authorisaties gebruikt door actor&quot;&#xA;const MNU_ISSxWF = &quot;Workflows geraakt door issue&quot;&#xA;const MNU_TBDxWF = &quot;Workflows geraakt door open punt&quot;&#xA;&#xA;&#xA;' Add a menuitem to the main menu&#xA;Function EA_GetMenuItems(MenuLocation, MenuName) &#xA;	dim items&#xA;	if MenuLocation = &quot;MainMenu&quot; then&#xA;		if(MenuName = &quot;-EA Scripting Toolkit&quot;) then&#xA;			redim menus(1)&#xA;			menus(0) = &quot;-&quot;&#xA;			menus(1) = MNU_REPORTS&#xA;			EA_GetMenuItems = menus&#xA;		elseif MenuName = MNU_REPORTS then&#xA;			redim items(2)&#xA;			items(0) = MNU_REP_REQ&#xA;			items(1) = MNU_REP_WF&#xA;			items(2) = MNU_REP_DIV&#xA;			EA_GetMenuItems = items&#xA;		elseif MenuName = MNU_REP_REQ then&#xA;			redim items(2)&#xA;			items(0) = MNU_REQxWF&#xA;			items(1) = MNU_LAWxWF&#xA;			items(2) = MNU_RFCxALL&#xA;			EA_GetMenuItems = items&#xA;		elseif MenuName = MNU_REP_WF then&#xA;			redim items(5)&#xA;			items(0) = MNU_WFxREQ&#xA;			items(1) = MNU_WFxLAW&#xA;			items(2) = MNU_WFxACT&#xA;			items(3) = MNU_WFxDO&#xA;			items(4) = MNU_WFxDR&#xA;			items(5) = MNU_WFxWF&#xA;			EA_GetMenuItems = items&#xA;		elseif MenuName = MNU_REP_DIV then&#xA;			redim items(4)&#xA;			items(0) = MNU_DRxDO&#xA;			items(1) = MNU_WFxAUT&#xA;			items(2) = MNU_ACTxAUT&#xA;			items(3) = MNU_ISSxWF&#xA;			items(4) = MNU_TBDxWF&#xA;			EA_GetMenuItems = items&#xA;		end if &#xA;	end if&#xA;end Function&#xA;&#xA;Sub EA_MenuClick( MenuName , ItemName )&#xA;	select case itemName &#xA;' Requirements&#xA;		case MNU_REQxWF&#xA;			CreateAndShowReport sqlREQs,sqlWFs,sqlWFImplementingREQ,nothing,sqlWFReferencingWF,MNU_REQxWF&#xA;		case MNU_LAWxWF&#xA;			CreateAndShowReport sqlLAWs,sqlWFs,sqlWFImplementingLAW,nothing,sqlWFReferencingWF,MNU_LAWxWF&#xA;		case MNU_RFCxALL&#xA;			CreateAndShowReport sqlRFCs,sqlCOREs,sqlCOREAffectedByRFC,nothing,nothing,MNU_RFCxALL&#xA;' Workflows		&#xA;		case MNU_WFxREQ&#xA;			CreateAndShowReport sqlWFs,sqlREQs,sqlREQImplementedByWF,nothing,sqlREQPartOfREQ,MNU_REQxWF&#xA;		case MNU_WFxLAW&#xA;			CreateAndShowReport sqlWFs,sqlLAWs,sqlLAWImplementedByWF,nothing,sqlLAWPartOfLAW,MNU_WFxLAW&#xA;		case MNU_WFxACT&#xA;			CreateAndShowReport sqlWFs,sqlACTs,sqlACTInvolvedInWF,sqlWFReferencedByWF,nothing,MNU_WFxACT&#xA;		case MNU_WFxDO&#xA;			CreateAndShowReport sqlWFs,sqlDOs,sqlDOInvolvedInWF,sqlWFReferencedByWF,nothing,MNU_WFxDO&#xA;		case MNU_WFxDR&#xA;			CreateAndShowReport sqlWFs,sqlDRs,sqlDRInvolvedInWF,sqlWFReferencedByWF,nothing,MNU_WFxDR&#xA;		case MNU_WFxWF&#xA;			CreateAndShowReport sqlWFs,sqlWFs,sqlWFReferencedByWF,nothing,sqlWFReferencedByWF,MNU_WFxWF&#xA;' Diversen&#xA;		case MNU_DRxDO&#xA;			CreateAndShowReport sqlDRs,sqlDOs,sqlDOReferencedByDR,nothing,nothing,MNU_DRxDO&#xA;		case MNU_WFxAUT&#xA;			CreateAndShowReport sqlWFs,sqlAUTs,sqlAUTReferencedByWF,nothing,nothing,MNU_WFxAUT  &#xA;		case MNU_ACTxAUT&#xA;			CreateAndShowReport sqlACTs,sqlAUTs,sqlAUTUsedByACT,nothing,nothing,MNU_ACTxAUT  &#xA;		case MNU_ISSxWF&#xA;			CreateAndShowReport sqlISSs,sqlWFs,sqlWFAffectedByIssue,nothing,sqlWFReferencingWF,MNU_ISSxWF&#xA;		case MNU_TBDxWF&#xA;			CreateAndShowReport sqlTBDs,sqlWFs,sqlWFAffectedByTBD,nothing,sqlWFReferencingWF,MNU_TBDxWF&#xA;	end select&#xA;end sub&#xA;"/>
		</DataRow>
	</DataSet>
</RefData>
