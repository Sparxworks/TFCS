option explicit

' Working directory for TFCS
const TFCSBASEDIR = "d:/EASt"
const MNU_TFCSMAIN = "-EAST"

' Types of workflows in the TFCS meta-model
const FLOWTYPE_WF = "BedrijfsProces"
const FLOWTYPE_WI = "WerkInstructie"
const FLOWTYPE_UC = "UseCase"

'----------------------------------------------------------------------------------------------------------------------
' DBMS specific settings (used in TFCS_SQL and TFCS_VALSQL)
' Change according to the DBMS that is used
'----------------------------------------------------------------------------------------------------------------------

dim xWCx 		' wildcard
dim xUCASEx 	' convert text to uppercase
dim xMIDx		' get substring
dim xMEMOx		' handling memo/clob fields

' .EAP (MSAccess)

xWCx = "*"	
xUCASEx = "ucase"	
xMIDx = "mid"
xMEMOx = ""
function xIfNullx(a,b)
	xIfNullx = "IIF(ISNULL("+a+"),"+b+","+a+")"
end function
function xInStrx(start,s1,s2)
	xInStrx = "InStr("+start+","+s1+","+s2+")"
end function

' Oracle

'xWCx = "%"			
'xUCASEx = "Upper"
'xMIDx = "Substr"
'xMEMOx = "dbms_lob."
'
'function IfNull(a,b)
'	IfNull = "nvl("+a+","+b+")"
'end function
'
'function InStr(start,s1,s2)
'	InStr = "InStr("+s1+","+s2+","+start+")"
'end function

'----------------------------------------------------------------------------------------------------------------------
' EAST initialisation routines for loading and initializing TFCS
'----------------------------------------------------------------------------------------------------------------------
'option explicit

'!INC TFCS_Support.TFCS_Constants

' Register the scripts that contain handler methods for EA events
sub EAST_RegisterEventHandlers

	' NOTE: eventhandlers are executed in the order of registration
	EAST.AddEventhandler("TFCS_MainMenu")					' Creates a menu item TFCS to the EA context menu's.
	EAST.AddEventhandler("TFCS_Reports")					' Reports on relationships (main menu item 'Rapportages')
	EAST.AddEventhandler("TFCS_ExecuteScript")				' Executes a script when double-clicking on an element
	EAST.AddEventhandler("TFCS_CreateFromToolbox")			' Creation of new model elements using the diagram toolboxes
	EAST.AddEventhandler("TFCS_GUIConstraints")				' Deviations from/constaints on the standard GUI of EA
	EAST.AddEventhandler("TFCS_DeleteHandler")				' Fires when deleting an object on a diagram
	EAST.AddEventhandler("TFCS_ModelValidation")			' Checks if the model is internally conistent with the TFCS metamodel
	EAST.AddEventhandler("TFCS_GenerateDocWFSpec")			' Generate a complete specification for a workflow suitable for approval
	EAST.AddEventhandler("TFCS_GenerateDocContext")			' Generate a document containing all diagrams that include an element (context)
end sub

' Provide EAST with the location of screen definitions and temp dir (dev dir)
sub EAST_Init()
	EAST.SetDevDir(TFCSBASEDIR+"/dev")
	EAST.SetDialogDir(TFCSBASEDIR+"/dialogs/")
end sub
